

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Gromos Trajectory evaluation with Pygromos and Pandas &mdash; PyGromosTools  documentation</title>








  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>


      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <script type="text/javascript" src="../../_static/js/theme.js"></script>




  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
</head>

<body class="wy-body-for-nav">


  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



            <a href="../../index.html" class="icon icon-home"> PyGromosTools



          </a>







<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">






              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Welcome to PyGromosTools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html#define-file-paths">define file paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html#build-gromos-system">Build gromos System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html#run-emin">Run Emin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_source/modules.html">Documentation</a></li>
</ul>



        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


      <nav class="wy-nav-top" aria-label="top navigation">

          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyGromosTools</a>

      </nav>


      <div class="wy-nav-content">

        <div class="rst-content">

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">

      <li><a href="../../index.html">Docs</a> &raquo;</li>

      <li>Gromos Trajectory evaluation with Pygromos and Pandas</li>


      <li class="wy-breadcrumbs-aside">


            <a href="../../_sources/Examples/developer_examples/dev_example_gromos_trajectories.ipynb.txt" rel="nofollow"> View page source</a>


      </li>

  </ul>


  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">


<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Gromos-Trajectory-evaluation-with-Pygromos-and-Pandas">
<h1>Gromos Trajectory evaluation with Pygromos and Pandas<a class="headerlink" href="#Gromos-Trajectory-evaluation-with-Pygromos-and-Pandas" title="Permalink to this headline">¶</a></h1>
<section id="Example-file-for-the-evaluation-of-GROMOS-trajectory-files-in-pygromos">
<h2>Example file for the evaluation of GROMOS trajectory files in pygromos<a class="headerlink" href="#Example-file-for-the-evaluation-of-GROMOS-trajectory-files-in-pygromos" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Analysis of a GROMOS trc file (position trajectory)</p>
<ol class="arabic simple">
<li><p>Import</p></li>
<li><p>Common Functions</p></li>
</ol>
</li>
<li><p>Analysis of a GROMOS tre file (energy trajectory)</p>
<ol class="arabic simple">
<li><p>Import</p></li>
<li><p>Common Functions</p></li>
</ol>
</li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># general imports for manual data manipulations. Not needed if only provided functions are used</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="c1">#specific imports from pygromos for trc and tre file support</span>
<span class="kn">import</span> <span class="nn">pygromos.files.trajectory.trc</span> <span class="k">as</span> <span class="nn">traj_trc</span>
<span class="kn">import</span> <span class="nn">pygromos.files.trajectory.tre</span> <span class="k">as</span> <span class="nn">traj_tre</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "35d32457bdbe4e7587204b000bf0853b"}</script></div>
</div>
</section>
<section id="1)-TRC">
<h2>1) TRC<a class="headerlink" href="#1)-TRC" title="Permalink to this headline">¶</a></h2>
<section id="1.1)-TRC-import">
<h3>1.1) TRC import<a class="headerlink" href="#1.1)-TRC-import" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import the trajectory file into a Trc class</span>
<span class="n">trc</span> <span class="o">=</span> <span class="n">traj_trc</span><span class="o">.</span><span class="n">Trc</span><span class="p">(</span><span class="n">traj_path</span><span class="o">=</span><span class="s1">&#39;../example_files/Traj_files/b_emin_vacuum_1.trc&#39;</span><span class="p">,</span>
          <span class="n">in_cnf</span><span class="o">=</span><span class="s1">&#39;../example_files/Traj_files/b_emin_vacuum.cnf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/3911726891.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># import the trajectory file into a Trc class</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> trc = traj_trc.Trc(traj_path=&#39;../example_files/Traj_files/b_emin_vacuum_1.trc&#39;,
</span><span class="ansi-green-intense-fg ansi-bold">      3</span>           in_cnf=&#39;../example_files/Traj_files/b_emin_vacuum.cnf&#39;)

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/trc.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, xyz, topology, time, unitcell_lengths, unitcell_angles, traj_path, in_cnf, timestep_duration, _future_file)</span>
<span class="ansi-green-intense-fg ansi-bold">     70</span>
<span class="ansi-green-intense-fg ansi-bold">     71</span>             <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>traj_path<span class="ansi-blue-fg">,</span> str<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 72</span><span class="ansi-red-fg">                 </span>xyz<span class="ansi-blue-fg">,</span> step<span class="ansi-blue-fg">,</span> time<span class="ansi-blue-fg">,</span> unitcell_lengths<span class="ansi-blue-fg">,</span> unitcell_angles <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>parse_trc_efficiently<span class="ansi-blue-fg">(</span>traj_path<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     73</span>
<span class="ansi-green-intense-fg ansi-bold">     74</span>             <span class="ansi-green-fg">if</span> compress<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/trc.py</span> in <span class="ansi-cyan-fg">parse_trc_efficiently</span><span class="ansi-blue-fg">(self, traj_path)</span>
<span class="ansi-green-intense-fg ansi-bold">    175</span>
<span class="ansi-green-intense-fg ansi-bold">    176</span>     <span class="ansi-green-fg">def</span> parse_trc_efficiently<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> traj_path<span class="ansi-blue-fg">:</span> str<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> Tuple<span class="ansi-blue-fg">[</span>np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">,</span> np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">,</span> np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 177</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_block_map <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_generate_blockMap<span class="ansi-blue-fg">(</span>in_trc_path<span class="ansi-blue-fg">=</span>traj_path<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    178</span>         <span class="ansi-red-fg"># build block mapping</span>
<span class="ansi-green-intense-fg ansi-bold">    179</span>         rep_time <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">1</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/trc.py</span> in <span class="ansi-cyan-fg">_generate_blockMap</span><span class="ansi-blue-fg">(self, in_trc_path)</span>
<span class="ansi-green-intense-fg ansi-bold">    269</span>     <span class="ansi-green-fg">def</span> _generate_blockMap<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> in_trc_path<span class="ansi-blue-fg">:</span> str<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> Dict<span class="ansi-blue-fg">[</span>str<span class="ansi-blue-fg">,</span> int<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    270</span>         block_map <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">}</span>
<span class="ansi-green-fg">--&gt; 271</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">with</span> open<span class="ansi-blue-fg">(</span>in_trc_path<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;r&#34;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> file_handle<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    272</span>             inBlock <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span>
<span class="ansi-green-intense-fg ansi-bold">    273</span>             inTitleBlock <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span>

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;../example_files/Traj_files/b_emin_vacuum_1.trc&#39;
</pre></div></div>
</div>
<p>The TRC class bridges the GROMOS TRC file based strucutres and mdtraj.Trajectories.</p>
<p>One can read in TRCs and use them just like mdtraj.Trajectories. One can than write them out both as .h5 as well as GROMOS .trc/trc.gz files.</p>
<p>If you have a function that’s generally useful, please contact the developers to possibly add it to the pygromos code to help other people :)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">trc</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/170507380.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-blue-fg">[</span>x <span class="ansi-green-fg">for</span> x <span class="ansi-green-fg">in</span> dir<span class="ansi-blue-fg">(</span>trc<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> x<span class="ansi-blue-fg">.</span>startswith<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;_&#34;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">NameError</span>: name &#39;trc&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="1.2)-TRC-file-handling">
<h3>1.2) TRC file handling<a class="headerlink" href="#1.2)-TRC-file-handling" title="Permalink to this headline">¶</a></h3>
<section id="Save-as-.h5">
<h4>Save as .h5<a class="headerlink" href="#Save-as-.h5" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;./traj.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/3092482440.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>trc<span class="ansi-blue-fg">.</span>save<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;./traj.h5&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;trc&#39; is not defined
</pre></div></div>
</div>
<section id="Save-as-trc">
<h5>Save as trc<a class="headerlink" href="#Save-as-trc" title="Permalink to this headline">¶</a></h5>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;./traj.trc.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/954007757.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>trc<span class="ansi-blue-fg">.</span>save<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;./traj.trc.gz&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;trc&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="export-last-frame-as-cnf">
<h5>export last frame as cnf<a class="headerlink" href="#export-last-frame-as-cnf" title="Permalink to this headline">¶</a></h5>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_cnf</span><span class="p">(</span><span class="n">base_cnf</span><span class="o">=</span><span class="s1">&#39;../example_files/Traj_files/b_emin_vacuum.cnf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/3039229125.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>trc<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>to_cnf<span class="ansi-blue-fg">(</span>base_cnf<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;../example_files/Traj_files/b_emin_vacuum.cnf&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;trc&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="Get-selection-of-trajectories">
<h5>Get selection of trajectories<a class="headerlink" href="#Get-selection-of-trajectories" title="Permalink to this headline">¶</a></h5>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trc</span><span class="p">[::</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">n_frames</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/1602408691.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>trc<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">:</span><span class="ansi-cyan-fg">10</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>n_frames

<span class="ansi-red-fg">NameError</span>: name &#39;trc&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="Save-out-selection">
<h5>Save out selection<a class="headerlink" href="#Save-out-selection" title="Permalink to this headline">¶</a></h5>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trc</span><span class="p">[::</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;9_frames.trc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/2580638721.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>trc<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">:</span><span class="ansi-cyan-fg">10</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>save<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;9_frames.trc&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;trc&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="RMSD">
<h5>RMSD<a class="headerlink" href="#RMSD" title="Permalink to this headline">¶</a></h5>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the rmsd to the initial frame (0th frame).</span>
<span class="c1"># Alternatively a different trajectory can be provide as argument to the rmsd function.</span>
<span class="c1"># The accepted arguments are integer or single trajectory frame.</span>
<span class="n">rmsd</span> <span class="o">=</span> <span class="n">trc</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/955174325.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-red-fg"># Alternatively a different trajectory can be provide as argument to the rmsd function.</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-red-fg"># The accepted arguments are integer or single trajectory frame.</span>
<span class="ansi-green-fg">----&gt; 4</span><span class="ansi-red-fg"> </span>rmsd <span class="ansi-blue-fg">=</span> trc<span class="ansi-blue-fg">.</span>rmsd<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;trc&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Which returns the rmsd for every time frame to the initial frame.</span>
<span class="c1"># It can be seen how the rmsd slowly gets larger as the simulations get farther away from the initial setup.</span>
<span class="n">rmsd</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/3177464374.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># Which returns the rmsd for every time frame to the initial frame.</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-red-fg"># It can be seen how the rmsd slowly gets larger as the simulations get farther away from the initial setup.</span>
<span class="ansi-green-fg">----&gt; 3</span><span class="ansi-red-fg"> </span>rmsd

<span class="ansi-red-fg">NameError</span>: name &#39;rmsd&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The mean over all frames can be easily taken with the pandas function mean()</span>
<span class="n">rmsd</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/1111955432.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># The mean over all frames can be easily taken with the pandas function mean()</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>rmsd<span class="ansi-blue-fg">.</span>mean<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;rmsd&#39; is not defined
</pre></div></div>
</div>
</section>
</section>
</section>
</section>
<section id="2)-TRE">
<h2>2) TRE<a class="headerlink" href="#2)-TRE" title="Permalink to this headline">¶</a></h2>
<section id="2.1)-Tre-import-and-structure">
<h3>2.1) Tre import and structure<a class="headerlink" href="#2.1)-Tre-import-and-structure" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import the trajectory file into a Tre class</span>
<span class="kn">from</span> <span class="nn">pygromos.files.trajectory.tre_field_libs.ene_fields</span> <span class="kn">import</span> <span class="n">gromos_2015_tre_block_names_table</span>

<span class="n">tre</span> <span class="o">=</span> <span class="n">traj_tre</span><span class="o">.</span><span class="n">Tre</span><span class="p">(</span><span class="n">input_value</span><span class="o">=</span><span class="s2">&quot;../example_files/Traj_files/test_CHE_H2O_bilayer.tre&quot;</span><span class="p">,</span> <span class="n">_ene_ana_names</span><span class="o">=</span><span class="n">gromos_2015_tre_block_names_table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">OSError</span>                                   Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/3081921643.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-green-fg">from</span> pygromos<span class="ansi-blue-fg">.</span>files<span class="ansi-blue-fg">.</span>trajectory<span class="ansi-blue-fg">.</span>tre_field_libs<span class="ansi-blue-fg">.</span>ene_fields <span class="ansi-green-fg">import</span> gromos_2015_tre_block_names_table
<span class="ansi-green-intense-fg ansi-bold">      3</span>
<span class="ansi-green-fg">----&gt; 4</span><span class="ansi-red-fg"> </span>tre <span class="ansi-blue-fg">=</span> traj_tre<span class="ansi-blue-fg">.</span>Tre<span class="ansi-blue-fg">(</span>input_value<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#34;../example_files/Traj_files/test_CHE_H2O_bilayer.tre&#34;</span><span class="ansi-blue-fg">,</span> _ene_ana_names<span class="ansi-blue-fg">=</span>gromos_2015_tre_block_names_table<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/tre.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, input_value, auto_save, stride, skip, _ene_ana_names)</span>
<span class="ansi-green-intense-fg ansi-bold">     84</span>             get the field names after the provided standard<span class="ansi-blue-fg">.</span><span class="ansi-blue-fg">,</span> by default gromos_2020_tre_block_names_table
<span class="ansi-green-intense-fg ansi-bold">     85</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">---&gt; 86</span><span class="ansi-red-fg">         </span>super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">(</span>input_value<span class="ansi-blue-fg">,</span> auto_save<span class="ansi-blue-fg">=</span>auto_save<span class="ansi-blue-fg">,</span> stride<span class="ansi-blue-fg">=</span>stride<span class="ansi-blue-fg">,</span> skip<span class="ansi-blue-fg">=</span>skip<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     87</span>         self<span class="ansi-blue-fg">.</span>tre_block_name_table <span class="ansi-blue-fg">=</span> _ene_ana_names
<span class="ansi-green-intense-fg ansi-bold">     88</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/_general_trajectory.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, input_value, auto_save, stride, skip)</span>
<span class="ansi-green-intense-fg ansi-bold">     52</span>                 bash<span class="ansi-blue-fg">.</span>compress_gzip<span class="ansi-blue-fg">(</span>tmp_input<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     53</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 54</span><span class="ansi-red-fg">                 </span>self<span class="ansi-blue-fg">.</span>_read_from_file<span class="ansi-blue-fg">(</span>input_path<span class="ansi-blue-fg">=</span>input_value<span class="ansi-blue-fg">,</span> auto_save<span class="ansi-blue-fg">=</span>auto_save<span class="ansi-blue-fg">,</span> stride<span class="ansi-blue-fg">=</span>stride<span class="ansi-blue-fg">,</span> skip<span class="ansi-blue-fg">=</span>skip<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     55</span>             self<span class="ansi-blue-fg">.</span>path <span class="ansi-blue-fg">=</span> input_value
<span class="ansi-green-intense-fg ansi-bold">     56</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/_general_trajectory.py</span> in <span class="ansi-cyan-fg">_read_from_file</span><span class="ansi-blue-fg">(self, input_path, auto_save, stride, skip)</span>
<span class="ansi-green-intense-fg ansi-bold">    186</span>             self<span class="ansi-blue-fg">.</span>_read_db_from_hf5<span class="ansi-blue-fg">(</span>input_path<span class="ansi-blue-fg">=</span>input_path<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    187</span>         <span class="ansi-green-fg">elif</span> re<span class="ansi-blue-fg">.</span>search<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;\.tr.$&#34;</span><span class="ansi-blue-fg">,</span> input_path<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>  <span class="ansi-red-fg"># noqa: W605</span>
<span class="ansi-green-fg">--&gt; 188</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>_read_trajectory<span class="ansi-blue-fg">(</span>input_path<span class="ansi-blue-fg">=</span>input_path<span class="ansi-blue-fg">,</span> auto_save<span class="ansi-blue-fg">=</span>auto_save<span class="ansi-blue-fg">,</span> stride<span class="ansi-blue-fg">=</span>stride<span class="ansi-blue-fg">,</span> skip<span class="ansi-blue-fg">=</span>skip<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    189</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    190</span>             <span class="ansi-green-fg">raise</span> IOError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Did not understand the file ending of given file path: &#34;</span><span class="ansi-blue-fg">,</span> input_path<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/_general_trajectory.py</span> in <span class="ansi-cyan-fg">_read_trajectory</span><span class="ansi-blue-fg">(self, input_path, stride, skip, auto_save)</span>
<span class="ansi-green-intense-fg ansi-bold">    265</span>
<span class="ansi-green-intense-fg ansi-bold">    266</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> os<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>exists<span class="ansi-blue-fg">(</span>input_path<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 267</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> IOError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Could not find File: &#34;</span><span class="ansi-blue-fg">,</span> input_path<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    268</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    269</span>             table <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">OSError</span>: [Errno Could not find File: ] ../example_files/Traj_files/test_CHE_H2O_bilayer.tre
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tre</span><span class="o">.</span><span class="n">database</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/3853516037.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>tre<span class="ansi-blue-fg">.</span>database

<span class="ansi-red-fg">NameError</span>: name &#39;tre&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">tre</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/3979207824.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-blue-fg">[</span>x <span class="ansi-green-fg">for</span> x <span class="ansi-green-fg">in</span> dir<span class="ansi-blue-fg">(</span>tre<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> x<span class="ansi-blue-fg">.</span>startswith<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;_&#34;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">NameError</span>: name &#39;tre&#39; is not defined
</pre></div></div>
</div>
<p>Tre files contain all energy related data (like split up energy terms, temperature, pressure, …..). In PyGromos they generally share the same block structure as other files, but all the data inside the specific timesteps is stored efficiently inside a pandas DataFrame, here called tre.database . This database offers manipulation with all pandas functions. Alternatively many common functions are provided inside the Tre class.</p>
<p>This class should in principle replace further usage of the gromos++ ene_ana function, since all these operation can be done efficiently on the pandas DataFrame.</p>
<p>We are currently working on adding more common functions to the Tre class. If you find a useful function please contact the developers so the function can be added for general usage :)</p>
</section>
<section id="2.2)-Common-Tre-functions">
<h3>2.2) Common Tre functions<a class="headerlink" href="#2.2)-Common-Tre-functions" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate the average density over all timesteps</span>
<span class="n">tre</span><span class="o">.</span><span class="n">get_density</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/1485427432.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># calculate the average density over all timesteps</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>tre<span class="ansi-blue-fg">.</span>get_density<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>mean<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;tre&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate the mean temperature over all frames for all baths in the system. In this example two baths with slightly different temperatures.</span>
<span class="n">tre</span><span class="o">.</span><span class="n">get_temperature</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/710423665.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># calculate the mean temperature over all frames for all baths in the system. In this example two baths with slightly different temperatures.</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>tre<span class="ansi-blue-fg">.</span>get_temperature<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>mean<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;tre&#39; is not defined
</pre></div></div>
</div>
<p>Tables and lists inside the database are stored in numpy arrays. For example the two temperatures from the previous example are stored in a numpy array of size 2 since it has two temperature baths</p>
<p>Specific values inside a tre file can also be directly accessed with numpy and pandas syntax</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tre</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/229725349.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>tre<span class="ansi-blue-fg">.</span>database<span class="ansi-blue-fg">.</span>iloc<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">NameError</span>: name &#39;tre&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># select the first nonbonded energy value for the first force group over all time frames</span>
<span class="n">tre</span><span class="o">.</span><span class="n">database</span><span class="p">[</span><span class="s2">&quot;nonbonded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/1707942403.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># select the first nonbonded energy value for the first force group over all time frames</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>tre<span class="ansi-blue-fg">.</span>database<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;nonbonded&#34;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>apply<span class="ansi-blue-fg">(</span><span class="ansi-green-fg">lambda</span> x<span class="ansi-blue-fg">:</span> x<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;tre&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tre</span><span class="o">.</span><span class="n">get_totals</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/223143269.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>tre<span class="ansi-blue-fg">.</span>get_totals<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;tre&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="\lambda-Sampling-&amp;-TREs">
<h3><span class="math notranslate nohighlight">\(\lambda\)</span>-Sampling &amp; TREs<a class="headerlink" href="#\lambda-Sampling-&-TREs" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import the trajectory file into a Tre class</span>
<span class="n">tre</span> <span class="o">=</span> <span class="n">traj_tre</span><span class="o">.</span><span class="n">Tre</span><span class="p">(</span><span class="n">input_value</span><span class="o">=</span><span class="s2">&quot;../example_files/Traj_files/RAFE_TI_l0_5.tre&quot;</span><span class="p">)</span>
<span class="n">tre</span><span class="o">.</span><span class="n">get_precalclam</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">OSError</span>                                   Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/2223585680.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># import the trajectory file into a Tre class</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>tre <span class="ansi-blue-fg">=</span> traj_tre<span class="ansi-blue-fg">.</span>Tre<span class="ansi-blue-fg">(</span>input_value<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#34;../example_files/Traj_files/RAFE_TI_l0_5.tre&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> tre<span class="ansi-blue-fg">.</span>get_precalclam<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/tre.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, input_value, auto_save, stride, skip, _ene_ana_names)</span>
<span class="ansi-green-intense-fg ansi-bold">     84</span>             get the field names after the provided standard<span class="ansi-blue-fg">.</span><span class="ansi-blue-fg">,</span> by default gromos_2020_tre_block_names_table
<span class="ansi-green-intense-fg ansi-bold">     85</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">---&gt; 86</span><span class="ansi-red-fg">         </span>super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">(</span>input_value<span class="ansi-blue-fg">,</span> auto_save<span class="ansi-blue-fg">=</span>auto_save<span class="ansi-blue-fg">,</span> stride<span class="ansi-blue-fg">=</span>stride<span class="ansi-blue-fg">,</span> skip<span class="ansi-blue-fg">=</span>skip<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     87</span>         self<span class="ansi-blue-fg">.</span>tre_block_name_table <span class="ansi-blue-fg">=</span> _ene_ana_names
<span class="ansi-green-intense-fg ansi-bold">     88</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/_general_trajectory.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, input_value, auto_save, stride, skip)</span>
<span class="ansi-green-intense-fg ansi-bold">     52</span>                 bash<span class="ansi-blue-fg">.</span>compress_gzip<span class="ansi-blue-fg">(</span>tmp_input<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     53</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 54</span><span class="ansi-red-fg">                 </span>self<span class="ansi-blue-fg">.</span>_read_from_file<span class="ansi-blue-fg">(</span>input_path<span class="ansi-blue-fg">=</span>input_value<span class="ansi-blue-fg">,</span> auto_save<span class="ansi-blue-fg">=</span>auto_save<span class="ansi-blue-fg">,</span> stride<span class="ansi-blue-fg">=</span>stride<span class="ansi-blue-fg">,</span> skip<span class="ansi-blue-fg">=</span>skip<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     55</span>             self<span class="ansi-blue-fg">.</span>path <span class="ansi-blue-fg">=</span> input_value
<span class="ansi-green-intense-fg ansi-bold">     56</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/_general_trajectory.py</span> in <span class="ansi-cyan-fg">_read_from_file</span><span class="ansi-blue-fg">(self, input_path, auto_save, stride, skip)</span>
<span class="ansi-green-intense-fg ansi-bold">    186</span>             self<span class="ansi-blue-fg">.</span>_read_db_from_hf5<span class="ansi-blue-fg">(</span>input_path<span class="ansi-blue-fg">=</span>input_path<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    187</span>         <span class="ansi-green-fg">elif</span> re<span class="ansi-blue-fg">.</span>search<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;\.tr.$&#34;</span><span class="ansi-blue-fg">,</span> input_path<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>  <span class="ansi-red-fg"># noqa: W605</span>
<span class="ansi-green-fg">--&gt; 188</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>_read_trajectory<span class="ansi-blue-fg">(</span>input_path<span class="ansi-blue-fg">=</span>input_path<span class="ansi-blue-fg">,</span> auto_save<span class="ansi-blue-fg">=</span>auto_save<span class="ansi-blue-fg">,</span> stride<span class="ansi-blue-fg">=</span>stride<span class="ansi-blue-fg">,</span> skip<span class="ansi-blue-fg">=</span>skip<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    189</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    190</span>             <span class="ansi-green-fg">raise</span> IOError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Did not understand the file ending of given file path: &#34;</span><span class="ansi-blue-fg">,</span> input_path<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/_general_trajectory.py</span> in <span class="ansi-cyan-fg">_read_trajectory</span><span class="ansi-blue-fg">(self, input_path, stride, skip, auto_save)</span>
<span class="ansi-green-intense-fg ansi-bold">    265</span>
<span class="ansi-green-intense-fg ansi-bold">    266</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> os<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>exists<span class="ansi-blue-fg">(</span>input_path<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 267</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> IOError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Could not find File: &#34;</span><span class="ansi-blue-fg">,</span> input_path<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    268</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    269</span>             table <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">OSError</span>: [Errno Could not find File: ] ../example_files/Traj_files/RAFE_TI_l0_5.tre
</pre></div></div>
</div>
</section>
<section id="EDS-in-TREs">
<h3>EDS in TREs<a class="headerlink" href="#EDS-in-TREs" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import the trajectory file into a Tre class</span>
<span class="n">tre</span> <span class="o">=</span> <span class="n">traj_tre</span><span class="o">.</span><span class="n">Tre</span><span class="p">(</span><span class="n">input_value</span><span class="o">=</span><span class="s2">&quot;../example_files/Traj_files/RAFE_eds.tre&quot;</span><span class="p">)</span>
<span class="n">tre</span><span class="o">.</span><span class="n">get_eds</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">OSError</span>                                   Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/660937202.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># import the trajectory file into a Tre class</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>tre <span class="ansi-blue-fg">=</span> traj_tre<span class="ansi-blue-fg">.</span>Tre<span class="ansi-blue-fg">(</span>input_value<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#34;../example_files/Traj_files/RAFE_eds.tre&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> tre<span class="ansi-blue-fg">.</span>get_eds<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/tre.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, input_value, auto_save, stride, skip, _ene_ana_names)</span>
<span class="ansi-green-intense-fg ansi-bold">     84</span>             get the field names after the provided standard<span class="ansi-blue-fg">.</span><span class="ansi-blue-fg">,</span> by default gromos_2020_tre_block_names_table
<span class="ansi-green-intense-fg ansi-bold">     85</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">---&gt; 86</span><span class="ansi-red-fg">         </span>super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">(</span>input_value<span class="ansi-blue-fg">,</span> auto_save<span class="ansi-blue-fg">=</span>auto_save<span class="ansi-blue-fg">,</span> stride<span class="ansi-blue-fg">=</span>stride<span class="ansi-blue-fg">,</span> skip<span class="ansi-blue-fg">=</span>skip<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     87</span>         self<span class="ansi-blue-fg">.</span>tre_block_name_table <span class="ansi-blue-fg">=</span> _ene_ana_names
<span class="ansi-green-intense-fg ansi-bold">     88</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/_general_trajectory.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, input_value, auto_save, stride, skip)</span>
<span class="ansi-green-intense-fg ansi-bold">     52</span>                 bash<span class="ansi-blue-fg">.</span>compress_gzip<span class="ansi-blue-fg">(</span>tmp_input<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     53</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 54</span><span class="ansi-red-fg">                 </span>self<span class="ansi-blue-fg">.</span>_read_from_file<span class="ansi-blue-fg">(</span>input_path<span class="ansi-blue-fg">=</span>input_value<span class="ansi-blue-fg">,</span> auto_save<span class="ansi-blue-fg">=</span>auto_save<span class="ansi-blue-fg">,</span> stride<span class="ansi-blue-fg">=</span>stride<span class="ansi-blue-fg">,</span> skip<span class="ansi-blue-fg">=</span>skip<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     55</span>             self<span class="ansi-blue-fg">.</span>path <span class="ansi-blue-fg">=</span> input_value
<span class="ansi-green-intense-fg ansi-bold">     56</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/_general_trajectory.py</span> in <span class="ansi-cyan-fg">_read_from_file</span><span class="ansi-blue-fg">(self, input_path, auto_save, stride, skip)</span>
<span class="ansi-green-intense-fg ansi-bold">    186</span>             self<span class="ansi-blue-fg">.</span>_read_db_from_hf5<span class="ansi-blue-fg">(</span>input_path<span class="ansi-blue-fg">=</span>input_path<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    187</span>         <span class="ansi-green-fg">elif</span> re<span class="ansi-blue-fg">.</span>search<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;\.tr.$&#34;</span><span class="ansi-blue-fg">,</span> input_path<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>  <span class="ansi-red-fg"># noqa: W605</span>
<span class="ansi-green-fg">--&gt; 188</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>_read_trajectory<span class="ansi-blue-fg">(</span>input_path<span class="ansi-blue-fg">=</span>input_path<span class="ansi-blue-fg">,</span> auto_save<span class="ansi-blue-fg">=</span>auto_save<span class="ansi-blue-fg">,</span> stride<span class="ansi-blue-fg">=</span>stride<span class="ansi-blue-fg">,</span> skip<span class="ansi-blue-fg">=</span>skip<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    189</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    190</span>             <span class="ansi-green-fg">raise</span> IOError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Did not understand the file ending of given file path: &#34;</span><span class="ansi-blue-fg">,</span> input_path<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/PyGromosTools/pygromos/files/trajectory/_general_trajectory.py</span> in <span class="ansi-cyan-fg">_read_trajectory</span><span class="ansi-blue-fg">(self, input_path, stride, skip, auto_save)</span>
<span class="ansi-green-intense-fg ansi-bold">    265</span>
<span class="ansi-green-intense-fg ansi-bold">    266</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> os<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>exists<span class="ansi-blue-fg">(</span>input_path<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 267</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> IOError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Could not find File: &#34;</span><span class="ansi-blue-fg">,</span> input_path<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    268</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    269</span>             table <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">OSError</span>: [Errno Could not find File: ] ../example_files/Traj_files/RAFE_eds.tre
</pre></div></div>
</div>
</section>
</section>
<section id="Concatenate-and-Copy-multiple-Trajectories">
<h2>Concatenate and Copy multiple Trajectories<a class="headerlink" href="#Concatenate-and-Copy-multiple-Trajectories" title="Permalink to this headline">¶</a></h2>
<p>Trajectories offer a wide range of additional file manipulations. Trajectory classes can be copied (deep) and added to each other to concatenate multiple small simulation pieces into one large trajectory.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tre_copy</span> <span class="o">=</span> <span class="n">traj_tre</span><span class="o">.</span><span class="n">Tre</span><span class="p">(</span><span class="n">input_value</span><span class="o">=</span><span class="n">tre</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/3771072379.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>tre_copy <span class="ansi-blue-fg">=</span> traj_tre<span class="ansi-blue-fg">.</span>Tre<span class="ansi-blue-fg">(</span>input_value<span class="ansi-blue-fg">=</span>tre<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;tre&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tre_copy</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/1473343014.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>tre_copy<span class="ansi-blue-fg">.</span>database<span class="ansi-blue-fg">.</span>shape

<span class="ansi-red-fg">NameError</span>: name &#39;tre_copy&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tre_combined</span> <span class="o">=</span> <span class="n">tre</span> <span class="o">+</span> <span class="n">tre_copy</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/2994187161.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>tre_combined <span class="ansi-blue-fg">=</span> tre <span class="ansi-blue-fg">+</span> tre_copy

<span class="ansi-red-fg">NameError</span>: name &#39;tre&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tre_combined</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/1945059270.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>tre_combined<span class="ansi-blue-fg">.</span>database<span class="ansi-blue-fg">.</span>shape

<span class="ansi-red-fg">NameError</span>: name &#39;tre_combined&#39; is not defined
</pre></div></div>
</div>
<p>In the new combined trajectory we have one long trajectory made from the two smaller ones. The length is one element shorter, since normally the last element of the first trajectory and the first element of the second trajectory is the same element. This can be controlled via the option “skip_new_0=True” in the add_traj() function which is the core of the “+” operator for trajectories. In the following line the default behavior can be seen as a smooth numbering in the TIMESTEPs.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tre_combined</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/2490463977.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>tre_combined<span class="ansi-blue-fg">.</span>database<span class="ansi-blue-fg">.</span>time

<span class="ansi-red-fg">NameError</span>: name &#39;tre_combined&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tre_combined</span><span class="o">.</span><span class="n">database</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">tre</span><span class="o">.</span><span class="n">database</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_25598/4287632522.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>print<span class="ansi-blue-fg">(</span>len<span class="ansi-blue-fg">(</span>tre_combined<span class="ansi-blue-fg">.</span>database<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> len<span class="ansi-blue-fg">(</span>tre<span class="ansi-blue-fg">.</span>database<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;tre_combined&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"270c514f202c4689b21e75906c2ddf02": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "35d32457bdbe4e7587204b000bf0853b": {"model_name": "ColormakerRegistryModel", "model_module": "nglview-js-widgets", "model_module_version": "3.0.1", "state": {"_dom_classes": [], "_model_module": "nglview-js-widgets", "_model_module_version": "3.0.1", "_model_name": "ColormakerRegistryModel", "_msg_ar": [], "_msg_q": [], "_ready": false, "_view_count": null, "_view_module": "nglview-js-widgets", "_view_module_version": "3.0.1", "_view_name": "ColormakerRegistryView", "layout": "IPY_MODEL_270c514f202c4689b21e75906c2ddf02"}}}, "version_major": 2, "version_minor": 0}
</script></section>
</section>


           </div>

          </div>
          <footer>


  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Benjamin Ries, Marc Lehner, Salome Rieder. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.3

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>






</body>
</html>
