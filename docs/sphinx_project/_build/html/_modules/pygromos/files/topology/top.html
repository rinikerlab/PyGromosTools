

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pygromos.files.topology.top &mdash; PyGromosTools  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> PyGromosTools
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Welcome to PyGromosTools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../install.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../_source/modules.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../styleguide.html">Style Guide for PyGromosTools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../code_of_conduct.html">Contributor Covenant Code of Conduct</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">PyGromosTools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>pygromos.files.topology.top</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pygromos.files.topology.top</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    File:            gromos++ topo file functions</span>
<span class="sd">    Warnings: this CLASS IS NOT IMPLEMENTED!</span>
<span class="sd">    TODO:REWORK</span>
<span class="sd">    Description:</span>
<span class="sd">        in this lib, gromos topo file mainpulating functions are gathered</span>
<span class="sd">    Author: Marc Lehner, Benjamin Ries</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># imports</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>

<span class="kn">from</span> <span class="nn">pygromos.utils</span> <span class="kn">import</span> <span class="n">bash</span> <span class="k">as</span> <span class="n">bash</span>
<span class="kn">from</span> <span class="nn">pygromos.files._basics</span> <span class="kn">import</span> <span class="n">_general_gromos_file</span><span class="p">,</span> <span class="n">parser</span>
<span class="kn">from</span> <span class="nn">pygromos.files.blocks</span> <span class="kn">import</span> <span class="n">topology_blocks</span> <span class="k">as</span> <span class="n">blocks</span>
<span class="kn">from</span> <span class="nn">pygromos.utils.typing</span> <span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Top_Type</span>


<span class="c1"># functions</span>
<div class="viewcode-block" id="make_topolog"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.make_topolog">[docs]</a><span class="k">def</span> <span class="nf">make_topolog</span><span class="p">(</span><span class="n">input_arg</span><span class="p">,</span> <span class="n">build</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">solve</span><span class="o">=</span><span class="s2">&quot;H2O&quot;</span><span class="p">):</span>
    <span class="c1"># define python command</span>
    <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;make_top &quot;</span> <span class="o">+</span> <span class="n">input_arg</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">param</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">seq</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">solve</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="c1"># execute command</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">bash</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">bash</span><span class="o">.</span><span class="n">increment_error_level</span><span class="p">(</span><span class="n">err_prefix</span><span class="o">=</span><span class="s2">&quot;Could not make_topology due to: &quot;</span><span class="p">,</span> <span class="n">old_err</span><span class="o">=</span><span class="n">err</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">command</span></div>


<div class="viewcode-block" id="combine_topologies"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.combine_topologies">[docs]</a><span class="k">def</span> <span class="nf">combine_topologies</span><span class="p">():</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;not implemented yet!&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="check_top"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.check_top">[docs]</a><span class="k">def</span> <span class="nf">check_top</span><span class="p">():</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;not implemented yet!&quot;</span><span class="p">)</span></div>


<span class="c1"># file Classes</span>
<div class="viewcode-block" id="Top"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top">[docs]</a><span class="k">class</span> <span class="nc">Top</span><span class="p">(</span><span class="n">_general_gromos_file</span><span class="o">.</span><span class="n">_general_gromos_file</span><span class="p">):</span>
    <span class="n">_gromos_file_ending</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;top&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">Top_Type</span><span class="p">],</span> <span class="n">_future_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">in_value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">in_value</span><span class="o">=</span><span class="n">in_value</span><span class="p">,</span> <span class="n">_future_file</span><span class="o">=</span><span class="n">_future_file</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">in_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">block_names</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">in_value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">in_value</span><span class="p">)</span> <span class="ow">is</span> <span class="vm">__class__</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;not implemented yet!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;not implemented yet!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">:</span> <span class="n">Top_Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Top_Type</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_top</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">)</span>

<div class="viewcode-block" id="Top._add_top"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top._add_top">[docs]</a>    <span class="k">def</span> <span class="nf">_add_top</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Top_Type</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">solvFrom1</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Top_Type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        combines two topologies. Parameters are taken from the initial topology.</span>
<span class="sd">        But missing parameters from the second topology will be added.</span>
<span class="sd">        Can be used like com_top from Gromos++</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        top : TopType</span>
<span class="sd">            second topology to add to the first topology</span>
<span class="sd">        solvFrom1 : bool, optional</span>
<span class="sd">            should the solvent be taken from the first topology? (else second), by default True</span>
<span class="sd">        verbose : bool, optional</span>
<span class="sd">            extra print statements, by default True</span>
<span class="sd">        sanityCheck : bool, optional</span>
<span class="sd">            feature and compatibility check, by default True</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TopType</span>
<span class="sd">            returns a topology made by combing two topologies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create the return top</span>
        <span class="n">retTop</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">retTop</span>
        <span class="c1"># add solv</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">solvFrom1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;taking solvent from second topology&quot;</span><span class="p">)</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">SOLVENTATOM</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">SOLVENTATOM</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">SOLVENTCONSTR</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">SOLVENTCONSTR</span>

        <span class="c1"># calculate the shift of atom types of the second topology and add new atomtypes</span>
        <span class="n">atomTypeShift</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">retTop</span><span class="p">,</span> <span class="s2">&quot;ATOMTYPENAME&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">retTop</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">retTop</span><span class="p">,</span> <span class="s2">&quot;ATOMTYPENAME&quot;</span><span class="p">,</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="p">))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">retTop</span><span class="p">,</span> <span class="s2">&quot;LJPARAMETERS&quot;</span><span class="p">,</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">atomT</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>  <span class="c1"># new atomtypes to find names for</span>
            <span class="n">foundAtomType</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">mainIdx</span><span class="p">,</span> <span class="n">mainAtomT</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">retTop</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>  <span class="c1"># AtomTypes in self to match against</span>
                <span class="k">if</span> <span class="n">atomT</span> <span class="o">==</span> <span class="n">mainAtomT</span><span class="p">:</span>
                    <span class="n">foundAtomType</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">atomTypeShift</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="n">mainIdx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">})</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">foundAtomType</span><span class="p">:</span>
                <span class="n">retTop</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">retTop</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">retTop</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atomT</span><span class="p">)</span>
                <span class="n">atomTypeShift</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="n">retTop</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]})</span>
                <span class="n">ljType</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">get_LJparameter_from_IAC</span><span class="p">(</span><span class="n">IAC</span><span class="o">=</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_LJparameter</span><span class="p">(</span><span class="n">C6</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">ljType</span><span class="o">.</span><span class="n">C6</span><span class="p">),</span> <span class="n">C12</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">ljType</span><span class="o">.</span><span class="n">C12</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;atomTypeShift: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">atomTypeShift</span><span class="p">))</span>

        <span class="c1"># add RESNAME</span>
        <span class="k">for</span> <span class="n">resname</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_resname</span><span class="p">(</span><span class="n">resname</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># add SOLUTEATOM</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">retTop</span><span class="p">,</span> <span class="s2">&quot;SOLUTEATOM&quot;</span><span class="p">):</span>
            <span class="n">atnmShift</span> <span class="o">=</span> <span class="n">retTop</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="p">[</span>
                <span class="o">-</span><span class="mi">1</span>
            <span class="p">]</span><span class="o">.</span><span class="n">ATNM</span>  <span class="c1"># Number of atoms found in main top. Shift secondary top atoms accordingly</span>
            <span class="n">mresShift</span> <span class="o">=</span> <span class="n">retTop</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">MRES</span>  <span class="c1"># Number of molecules found in main top.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">atnmShift</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">mresShift</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;atom number shift: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">atnmShift</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;molecule number shift: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mresShift</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_soluteatom</span><span class="p">(</span>
                <span class="n">ATNM</span><span class="o">=</span><span class="n">atnmShift</span> <span class="o">+</span> <span class="n">atom</span><span class="o">.</span><span class="n">ATNM</span><span class="p">,</span>
                <span class="n">MRES</span><span class="o">=</span><span class="n">mresShift</span> <span class="o">+</span> <span class="n">atom</span><span class="o">.</span><span class="n">MRES</span><span class="p">,</span>
                <span class="n">PANM</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">PANM</span><span class="p">,</span>
                <span class="n">IAC</span><span class="o">=</span><span class="n">atomTypeShift</span><span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">IAC</span><span class="p">],</span>
                <span class="n">MASS</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">MASS</span><span class="p">,</span>
                <span class="n">CG</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">CG</span><span class="p">,</span>
                <span class="n">CGC</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">CGC</span><span class="p">,</span>
                <span class="n">INE</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">atnmShift</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">INEvalues</span><span class="p">],</span>
                <span class="n">INE14</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">atnmShift</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">INE14values</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="c1"># add bonds and bonds with H</span>
        <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">BOND</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">bondType</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">BONDSTRETCHTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="n">bond</span><span class="o">.</span><span class="n">ICB</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_bond</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">bondType</span><span class="o">.</span><span class="n">CHB</span><span class="p">,</span> <span class="n">b0</span><span class="o">=</span><span class="n">bondType</span><span class="o">.</span><span class="n">B0</span><span class="p">,</span> <span class="n">atomI</span><span class="o">=</span><span class="n">bond</span><span class="o">.</span><span class="n">IB</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span> <span class="n">atomJ</span><span class="o">=</span><span class="n">bond</span><span class="o">.</span><span class="n">JB</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">BONDH</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">bondType</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">BONDSTRETCHTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="n">bond</span><span class="o">.</span><span class="n">ICB</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_bond</span><span class="p">(</span>
                <span class="n">k</span><span class="o">=</span><span class="n">bondType</span><span class="o">.</span><span class="n">CHB</span><span class="p">,</span> <span class="n">b0</span><span class="o">=</span><span class="n">bondType</span><span class="o">.</span><span class="n">B0</span><span class="p">,</span> <span class="n">atomI</span><span class="o">=</span><span class="n">bond</span><span class="o">.</span><span class="n">IB</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span> <span class="n">atomJ</span><span class="o">=</span><span class="n">bond</span><span class="o">.</span><span class="n">JB</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span> <span class="n">includesH</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>

        <span class="c1"># add angles and angles with H</span>
        <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">BONDANGLE</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">angleType</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">BONDANGLEBENDTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="n">angle</span><span class="o">.</span><span class="n">ICT</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_angle</span><span class="p">(</span>
                <span class="n">k</span><span class="o">=</span><span class="n">angleType</span><span class="o">.</span><span class="n">CT</span><span class="p">,</span>
                <span class="n">kh</span><span class="o">=</span><span class="n">angleType</span><span class="o">.</span><span class="n">CHT</span><span class="p">,</span>
                <span class="n">b0</span><span class="o">=</span><span class="n">angleType</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span>
                <span class="n">atomI</span><span class="o">=</span><span class="n">angle</span><span class="o">.</span><span class="n">IT</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomJ</span><span class="o">=</span><span class="n">angle</span><span class="o">.</span><span class="n">JT</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomK</span><span class="o">=</span><span class="n">angle</span><span class="o">.</span><span class="n">KT</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">BONDANGLEH</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">angleType</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">BONDANGLEBENDTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="n">angle</span><span class="o">.</span><span class="n">ICT</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_angle</span><span class="p">(</span>
                <span class="n">k</span><span class="o">=</span><span class="n">angleType</span><span class="o">.</span><span class="n">CT</span><span class="p">,</span>
                <span class="n">kh</span><span class="o">=</span><span class="n">angleType</span><span class="o">.</span><span class="n">CHT</span><span class="p">,</span>
                <span class="n">b0</span><span class="o">=</span><span class="n">angleType</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span>
                <span class="n">atomI</span><span class="o">=</span><span class="n">angle</span><span class="o">.</span><span class="n">IT</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomJ</span><span class="o">=</span><span class="n">angle</span><span class="o">.</span><span class="n">JT</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomK</span><span class="o">=</span><span class="n">angle</span><span class="o">.</span><span class="n">KT</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">includesH</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># add diheadrals and diheadrals with H</span>
        <span class="k">for</span> <span class="n">dihdrl</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">DIHEDRAL</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">dihdrlType</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">TORSDIHEDRALTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">ICP</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_torsiondihedral</span><span class="p">(</span>
                <span class="n">CP</span><span class="o">=</span><span class="n">dihdrlType</span><span class="o">.</span><span class="n">CP</span><span class="p">,</span>
                <span class="n">PD</span><span class="o">=</span><span class="n">dihdrlType</span><span class="o">.</span><span class="n">PD</span><span class="p">,</span>
                <span class="n">NP</span><span class="o">=</span><span class="n">dihdrlType</span><span class="o">.</span><span class="n">NP</span><span class="p">,</span>
                <span class="n">atomI</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">IP</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomJ</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">JP</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomK</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">KP</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomL</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">LP</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">dihdrl</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">DIHEDRALH</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">dihdrlType</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">TORSDIHEDRALTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">ICPH</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_torsiondihedral</span><span class="p">(</span>
                <span class="n">CP</span><span class="o">=</span><span class="n">dihdrlType</span><span class="o">.</span><span class="n">CP</span><span class="p">,</span>
                <span class="n">PD</span><span class="o">=</span><span class="n">dihdrlType</span><span class="o">.</span><span class="n">PD</span><span class="p">,</span>
                <span class="n">NP</span><span class="o">=</span><span class="n">dihdrlType</span><span class="o">.</span><span class="n">NP</span><span class="p">,</span>
                <span class="n">atomI</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">IPH</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomJ</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">JPH</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomK</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">KPH</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomL</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">LPH</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">includesH</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># add impdihedrals with and without H</span>
        <span class="k">for</span> <span class="n">dihdrl</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">IMPDIHEDRAL</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">dihdrlType</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">IMPDIHEDRALTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">ICQ</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_impdihedral</span><span class="p">(</span>
                <span class="n">CQ</span><span class="o">=</span><span class="n">dihdrlType</span><span class="o">.</span><span class="n">CQ</span><span class="p">,</span>
                <span class="n">Q0</span><span class="o">=</span><span class="n">dihdrlType</span><span class="o">.</span><span class="n">Q0</span><span class="p">,</span>
                <span class="n">atomI</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">IQ</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomJ</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">JQ</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomK</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">KQ</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomL</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">LQ</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">dihdrl</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">IMPDIHEDRALH</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">dihdrlType</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">IMPDIHEDRALTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">ICQH</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_impdihedral</span><span class="p">(</span>
                <span class="n">CQ</span><span class="o">=</span><span class="n">dihdrlType</span><span class="o">.</span><span class="n">CQ</span><span class="p">,</span>
                <span class="n">Q0</span><span class="o">=</span><span class="n">dihdrlType</span><span class="o">.</span><span class="n">Q0</span><span class="p">,</span>
                <span class="n">atomI</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">IQH</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomJ</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">JQH</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomK</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">KQH</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">atomL</span><span class="o">=</span><span class="n">dihdrl</span><span class="o">.</span><span class="n">LQH</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">,</span>
                <span class="n">includesH</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># add SOLUTEMOLECULES</span>
        <span class="k">for</span> <span class="n">solmol</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSP</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_SOLUTEMOLECULES</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="n">solmol</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">)</span>

        <span class="c1"># add TEMPERATUREGROUPS</span>
        <span class="k">for</span> <span class="n">solmol</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">TEMPERATUREGROUPS</span><span class="o">.</span><span class="n">NSP</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_TEMPERATUREGROUPS</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="n">solmol</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">)</span>

        <span class="c1"># add PRESSUREGROUPS</span>
        <span class="k">for</span> <span class="n">solmol</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">PRESSUREGROUPS</span><span class="o">.</span><span class="n">NSP</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">add_new_PRESSUREGROUPS</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="n">solmol</span> <span class="o">+</span> <span class="n">atnmShift</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">retTop</span></div>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_multiplication</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiply_top</span><span class="p">(</span><span class="n">n_multiplication</span><span class="p">)</span>

<div class="viewcode-block" id="Top.multiply_top"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.multiply_top">[docs]</a>    <span class="k">def</span> <span class="nf">multiply_top</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_muliplication</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">unifyGroups</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Top_Type</span><span class="p">:</span>

        <span class="c1"># catch simple cases and create return top</span>
        <span class="k">if</span> <span class="n">n_muliplication</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">in_value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">retTop</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_muliplication</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">retTop</span>

        <span class="n">top</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># for safe storage and reagsinment so that we can modifie</span>

        <span class="n">n_loops</span> <span class="o">=</span> <span class="n">n_muliplication</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># -1 since first one is a deepcopy</span>
        <span class="n">atnmShift</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># init for number of atoms. Will be determined in SOLUTEATOM</span>
        <span class="n">mresShift</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># init for number of molecules. Will be determined in SOLUTEMOLECULES</span>

        <span class="c1"># start with additonal copies of all Blocks</span>

        <span class="c1"># multiply RESNAME</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;RESNAME&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">n_muliplication</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_loops</span><span class="p">):</span>
                <span class="n">retTop</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

        <span class="c1"># multiply SOLUTEATOM</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;SOLUTEATOM&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">atnmShift</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ATNM</span>  <span class="c1"># Number of atoms found in  top</span>
            <span class="n">mresShift</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">MRES</span>  <span class="c1"># Number of molecules found in top.</span>

            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;atnmShift:&quot;</span><span class="p">,</span> <span class="n">atnmShift</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mresShift:&quot;</span><span class="p">,</span> <span class="n">mresShift</span><span class="p">)</span>

            <span class="n">retTop</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">NRP</span> <span class="o">*=</span> <span class="n">n_muliplication</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_loops</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">ATNM</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">MRES</span> <span class="o">+=</span> <span class="n">mresShift</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">INEvalues</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">atnmShift</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">INEvalues</span><span class="p">]</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">INE14values</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">atnmShift</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">INE14values</span><span class="p">]</span>
                    <span class="n">retTop</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">atom</span><span class="p">))</span>

        <span class="c1"># multiply Bonds(H)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;BOND&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">BOND</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">BOND</span><span class="o">.</span><span class="n">NBON</span> <span class="o">*=</span> <span class="n">n_muliplication</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_loops</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">BOND</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
                    <span class="n">bond</span><span class="o">.</span><span class="n">IB</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">bond</span><span class="o">.</span><span class="n">JB</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">retTop</span><span class="o">.</span><span class="n">BOND</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">bond</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;BONDH&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">BOND</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">BONDH</span><span class="o">.</span><span class="n">NBONH</span> <span class="o">*=</span> <span class="n">n_muliplication</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_loops</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">BONDH</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
                    <span class="n">bond</span><span class="o">.</span><span class="n">IB</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">bond</span><span class="o">.</span><span class="n">JB</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">retTop</span><span class="o">.</span><span class="n">BONDH</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">bond</span><span class="p">))</span>

        <span class="c1"># multiply Angles(H)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;BONDANGLE&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">BONDANGLE</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">BONDANGLE</span><span class="o">.</span><span class="n">NTHE</span> <span class="o">*=</span> <span class="n">n_muliplication</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_loops</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">BONDANGLE</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">IT</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">JT</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">KT</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">retTop</span><span class="o">.</span><span class="n">BONDANGLE</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;BONDANGLEH&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">BONDANGLEH</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">BONDANGLEH</span><span class="o">.</span><span class="n">NTHEH</span> <span class="o">*=</span> <span class="n">n_muliplication</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_loops</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">BONDANGLEH</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">IT</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">JT</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">KT</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">retTop</span><span class="o">.</span><span class="n">BONDANGLEH</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>

        <span class="c1"># multiply Impdihedrals(H)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;IMPDIHEDRAL&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">IMPDIHEDRAL</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">IMPDIHEDRAL</span><span class="o">.</span><span class="n">NQHI</span> <span class="o">*=</span> <span class="n">n_muliplication</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_loops</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">IMPDIHEDRAL</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">IQ</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">JQ</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">KQ</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">LQ</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">retTop</span><span class="o">.</span><span class="n">IMPDIHEDRAL</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;IMPDIHEDRALH&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">IMPDIHEDRALH</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">IMPDIHEDRALH</span><span class="o">.</span><span class="n">NQHIH</span> <span class="o">*=</span> <span class="n">n_muliplication</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_loops</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">IMPDIHEDRALH</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">IQH</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">JQH</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">KQH</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">LQH</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">retTop</span><span class="o">.</span><span class="n">IMPDIHEDRALH</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>

        <span class="c1"># multiply Torsions(H)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;DIHEDRAL&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">DIHEDRAL</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">DIHEDRAL</span><span class="o">.</span><span class="n">NPHI</span> <span class="o">*=</span> <span class="n">n_muliplication</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_loops</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">DIHEDRAL</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">IP</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">JP</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">KP</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">LP</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">retTop</span><span class="o">.</span><span class="n">DIHEDRAL</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;DIHEDRALH&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">DIHEDRALH</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">DIHEDRALH</span><span class="o">.</span><span class="n">NPHIH</span> <span class="o">*=</span> <span class="n">n_muliplication</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_loops</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">DIHEDRALH</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">IPH</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">JPH</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">KPH</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">angle</span><span class="o">.</span><span class="n">LPH</span> <span class="o">+=</span> <span class="n">atnmShift</span>
                    <span class="n">retTop</span><span class="o">.</span><span class="n">DIHEDRALH</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;SOLUTEMOLECULES&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">unifyGroups</span> <span class="ow">and</span> <span class="n">top</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">retTop</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSM</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">retTop</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSP</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSP</span><span class="p">)</span> <span class="o">*</span> <span class="n">n_muliplication</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">retTop</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSM</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSM</span> <span class="o">*</span> <span class="n">n_muliplication</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_loops</span><span class="p">):</span>
                    <span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">atnmShift</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSP</span><span class="p">]</span>
                    <span class="n">retTop</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSP</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>

        <span class="c1"># So far there was no reason to destinguish between SOLUTEMOLECULES and the following blocks</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;TEMPERATUREGROUPS&quot;</span><span class="p">):</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">TEMPERATUREGROUPS</span><span class="o">.</span><span class="n">NSM</span> <span class="o">=</span> <span class="n">retTop</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSM</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">TEMPERATUREGROUPS</span><span class="o">.</span><span class="n">NSP</span> <span class="o">=</span> <span class="n">retTop</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSP</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;PRESSUREGROUPS&quot;</span><span class="p">):</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">PRESSUREGROUPS</span><span class="o">.</span><span class="n">NSM</span> <span class="o">=</span> <span class="n">retTop</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSM</span>
            <span class="n">retTop</span><span class="o">.</span><span class="n">PRESSUREGROUPS</span><span class="o">.</span><span class="n">NSP</span> <span class="o">=</span> <span class="n">retTop</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSP</span>

        <span class="c1"># return everything</span>
        <span class="k">return</span> <span class="n">retTop</span></div>

<div class="viewcode-block" id="Top.read_file"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.read_file">[docs]</a>    <span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Read blocks to string</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">read_general_gromos_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orig_file_path</span><span class="p">)</span>

        <span class="c1"># translate the string subblocks</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">block_title</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="c1"># print(block_title)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="n">block_title</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">block_title</span><span class="p">])</span>
            <span class="n">blocks</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">block_title</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">block_title</span><span class="p">)})</span>
        <span class="k">return</span> <span class="n">blocks</span></div>

<div class="viewcode-block" id="Top.make_ordered"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.make_ordered">[docs]</a>    <span class="k">def</span> <span class="nf">make_ordered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orderList</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">orderList</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_block_order</span> <span class="o">=</span> <span class="n">orderList</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_block_order</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;TITLE&quot;</span><span class="p">,</span>
                <span class="s2">&quot;PHYSICALCONSTANTS&quot;</span><span class="p">,</span>
                <span class="s2">&quot;TOPVERSION&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ATOMTYPENAME&quot;</span><span class="p">,</span>
                <span class="s2">&quot;RESNAME&quot;</span><span class="p">,</span>
                <span class="s2">&quot;SOLUTEATOM&quot;</span><span class="p">,</span>
                <span class="s2">&quot;BONDSTRETCHTYPE&quot;</span><span class="p">,</span>
                <span class="s2">&quot;BONDH&quot;</span><span class="p">,</span>
                <span class="s2">&quot;BOND&quot;</span><span class="p">,</span>
                <span class="s2">&quot;BONDANGLEBENDTYPE&quot;</span><span class="p">,</span>
                <span class="s2">&quot;BONDANGLEH&quot;</span><span class="p">,</span>
                <span class="s2">&quot;BONDANGLE&quot;</span><span class="p">,</span>
                <span class="s2">&quot;IMPDIHEDRALTYPE&quot;</span><span class="p">,</span>
                <span class="s2">&quot;IMPDIHEDRALH&quot;</span><span class="p">,</span>
                <span class="s2">&quot;IMPDIHEDRAL&quot;</span><span class="p">,</span>
                <span class="s2">&quot;TORSDIHEDRALTYPE&quot;</span><span class="p">,</span>
                <span class="s2">&quot;DIHEDRALH&quot;</span><span class="p">,</span>
                <span class="s2">&quot;DIHEDRAL&quot;</span><span class="p">,</span>
                <span class="s2">&quot;CROSSDIHEDRALH&quot;</span><span class="p">,</span>
                <span class="s2">&quot;CROSSDIHEDRAL&quot;</span><span class="p">,</span>
                <span class="s2">&quot;LJPARAMETERS&quot;</span><span class="p">,</span>
                <span class="s2">&quot;SOLUTEMOLECULES&quot;</span><span class="p">,</span>
                <span class="s2">&quot;TEMPERATUREGROUPS&quot;</span><span class="p">,</span>
                <span class="s2">&quot;PRESSUREGROUPS&quot;</span><span class="p">,</span>
                <span class="s2">&quot;LJEXCEPTIONS&quot;</span><span class="p">,</span>
                <span class="s2">&quot;SOLVENTATOM&quot;</span><span class="p">,</span>
                <span class="s2">&quot;SOLVENTCONSTR&quot;</span><span class="p">,</span>
            <span class="p">]</span></div>

<div class="viewcode-block" id="Top.get_num_atomtypes"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.get_num_atomtypes">[docs]</a>    <span class="k">def</span> <span class="nf">get_num_atomtypes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATOMTYPENAME&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="Top.add_new_atomtype"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_atomtype">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_atomtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add a atomtype to ATOMTYPENAME block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            new atomtype name</span>
<span class="sd">        verbose : bool, optional</span>
<span class="sd">            by default False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATOMTYPENAME&quot;</span><span class="p">):</span>
            <span class="n">defaultContent</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Dummy&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;ATOMTYPENAME&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">defaultContent</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">name</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">remove</span><span class="p">([</span><span class="s2">&quot;Dummy&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;0&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">name</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Top.add_new_resname"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_resname">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_resname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add a resname to the RESNAME block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            resname name</span>
<span class="sd">        verbose : bool, optional</span>
<span class="sd">            by default False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;RESNAME&quot;</span><span class="p">):</span>
            <span class="n">defaultContent</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Dummy&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;RESNAME&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">defaultContent</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">name</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">remove</span><span class="p">([</span><span class="s2">&quot;Dummy&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;0&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">name</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RESNAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Top.add_new_soluteatom"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_soluteatom">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_soluteatom</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ATNM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">MRES</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">PANM</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">IAC</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">MASS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">CG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">CGC</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">INE</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">INE14</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add a soluteatom to the SOLUTEATOM block&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;SOLUTEATOM&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;SOLUTEATOM&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">NRP</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># some auto set methods</span>
        <span class="k">if</span> <span class="n">ATNM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ATNM</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">MRES</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">MRES</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">MRES</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">MRES</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># create new entry</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="n">soluteatom_type</span><span class="p">(</span>
            <span class="n">ATNM</span><span class="o">=</span><span class="n">ATNM</span><span class="p">,</span>
            <span class="n">MRES</span><span class="o">=</span><span class="n">MRES</span><span class="p">,</span>
            <span class="n">PANM</span><span class="o">=</span><span class="n">PANM</span><span class="p">,</span>
            <span class="n">IAC</span><span class="o">=</span><span class="n">IAC</span><span class="p">,</span>
            <span class="n">MASS</span><span class="o">=</span><span class="n">MASS</span><span class="p">,</span>
            <span class="n">CG</span><span class="o">=</span><span class="n">CG</span><span class="p">,</span>
            <span class="n">CGC</span><span class="o">=</span><span class="n">CGC</span><span class="p">,</span>
            <span class="n">INE</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">INE</span><span class="p">),</span>
            <span class="n">INEvalues</span><span class="o">=</span><span class="n">INE</span><span class="p">,</span>
            <span class="n">INE14</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">INE14</span><span class="p">),</span>
            <span class="n">INE14values</span><span class="o">=</span><span class="n">INE14</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">NRP</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Top.add_new_bond"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_bond">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_bond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">atomI</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">atomJ</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">includesH</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add a bond between atom I and J to the BOND block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        k : float</span>
<span class="sd">            force konstant</span>
<span class="sd">        b0 : float</span>
<span class="sd">            distance at which the force is 0</span>
<span class="sd">        atomI : int</span>
<span class="sd">            atom I</span>
<span class="sd">        atomJ : int</span>
<span class="sd">            atom J</span>
<span class="sd">        includesH : bool, optional</span>
<span class="sd">            wheter it should be added to BOND or BONDH, by default False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check if all classes are ready, if not create</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;BONDSTRETCHTYPE&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;BONDSTRETCHTYPE&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">includesH</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;BONDH&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;BONDH&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;BOND&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;BOND&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

        <span class="c1"># find the bondstretchtype number or create new bondstretchtype</span>
        <span class="c1"># TODO: add quartic force (CB)</span>
        <span class="n">bond_type_number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">iterator</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">quartic</span> <span class="o">=</span> <span class="n">k</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">b0</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">newBondStretchType</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="n">bondstretchtype_type</span><span class="p">(</span><span class="n">CB</span><span class="o">=</span><span class="n">quartic</span><span class="p">,</span> <span class="n">CHB</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">B0</span><span class="o">=</span><span class="n">b0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">bond_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">BONDSTRETCHTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bond_type</span><span class="o">.</span><span class="n">CHB</span> <span class="o">==</span> <span class="n">newBondStretchType</span><span class="o">.</span><span class="n">CHB</span> <span class="ow">and</span> <span class="n">bond_type</span><span class="o">.</span><span class="n">B0</span> <span class="o">==</span> <span class="n">newBondStretchType</span><span class="o">.</span><span class="n">B0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iterator</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">bond_type_number</span> <span class="o">=</span> <span class="n">iterator</span>
        <span class="k">if</span> <span class="n">iterator</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BONDSTRETCHTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># bond type was not found -&gt; add new bondtype</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDSTRETCHTYPE</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newBondStretchType</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDSTRETCHTYPE</span><span class="o">.</span><span class="n">NBTY</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># create new bond TODO: maybe check if already exists. But I will asume smart users</span>
        <span class="n">newBond</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="n">top_bond_type</span><span class="p">(</span><span class="n">IB</span><span class="o">=</span><span class="n">atomI</span><span class="p">,</span> <span class="n">JB</span><span class="o">=</span><span class="n">atomJ</span><span class="p">,</span> <span class="n">ICB</span><span class="o">=</span><span class="n">bond_type_number</span><span class="p">)</span>

        <span class="c1"># check if we are adding a bond to BOND or BONDH</span>
        <span class="k">if</span> <span class="n">includesH</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDH</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newBond</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDH</span><span class="o">.</span><span class="n">NBONH</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BOND</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newBond</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BOND</span><span class="o">.</span><span class="n">NBON</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Top.add_new_angle"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_angle">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_angle</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">k</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">kh</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">b0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">atomI</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">atomJ</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">atomK</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">includesH</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">convertToQuartic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add a angle between atom I, J and K to the ANGLE block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        k : float</span>
<span class="sd">            force konstant</span>
<span class="sd">        kh : float</span>
<span class="sd">            force konstant harmonic</span>
<span class="sd">        b0 : float</span>
<span class="sd">            angle at which the force is 0</span>
<span class="sd">        atomI : int</span>
<span class="sd">            atom I</span>
<span class="sd">        atomJ : int</span>
<span class="sd">            atom J</span>
<span class="sd">        atomK : int</span>
<span class="sd">            atom K</span>
<span class="sd">        includesH : bool, optional</span>
<span class="sd">            ANGLE or ANGLEH, by default False</span>
<span class="sd">        convertToQuartic : bool, optional</span>
<span class="sd">            auto convert, by default False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check if all classes are ready, if not create</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;BONDANGLEBENDTYPE&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;BONDANGLEBENDTYPE&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">includesH</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;BONDANGLEH&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;BONDANGLEH&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;BONDANGLE&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;BONDANGLE&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

        <span class="c1"># find the BONDANGLEBENDTYPE number or create new BONDANGLEBENDTYPE</span>
        <span class="c1"># TODO: add harmonic in the angle cosine force (CT)</span>
        <span class="n">angle_type_number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">iterator</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">convertToQuartic</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">harmonic2quarticAngleConversion</span><span class="p">(</span><span class="n">kh</span><span class="p">,</span> <span class="n">b0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">angle_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">BONDANGLEBENDTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">angle_type</span><span class="o">.</span><span class="n">CT</span> <span class="o">==</span> <span class="n">k</span> <span class="ow">and</span> <span class="n">angle_type</span><span class="o">.</span><span class="n">CHT</span> <span class="o">==</span> <span class="n">kh</span> <span class="ow">and</span> <span class="n">angle_type</span><span class="o">.</span><span class="n">T0</span> <span class="o">==</span> <span class="n">b0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iterator</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">angle_type_number</span> <span class="o">=</span> <span class="n">iterator</span>
        <span class="k">if</span> <span class="n">iterator</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BONDANGLEBENDTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># angle type was not found -&gt; add new bondtype</span>
            <span class="n">newBONDANGLEBENDTYPE</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="n">bondanglebendtype_type</span><span class="p">(</span><span class="n">CT</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">CHT</span><span class="o">=</span><span class="n">kh</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="n">b0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDANGLEBENDTYPE</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newBONDANGLEBENDTYPE</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDANGLEBENDTYPE</span><span class="o">.</span><span class="n">NBTY</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># create new angle TODO: maybe check if already exists. But I will asume smart users</span>
        <span class="n">newAngle</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="n">bondangle_type</span><span class="p">(</span><span class="n">IT</span><span class="o">=</span><span class="n">atomI</span><span class="p">,</span> <span class="n">JT</span><span class="o">=</span><span class="n">atomJ</span><span class="p">,</span> <span class="n">KT</span><span class="o">=</span><span class="n">atomK</span><span class="p">,</span> <span class="n">ICT</span><span class="o">=</span><span class="n">angle_type_number</span><span class="p">)</span>
        <span class="c1"># check if we are adding a bond to BONDANGLE or BONDANGLEH</span>
        <span class="k">if</span> <span class="n">includesH</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDANGLEH</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newAngle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDANGLEH</span><span class="o">.</span><span class="n">NTHEH</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDANGLE</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newAngle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDANGLE</span><span class="o">.</span><span class="n">NTHE</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Top.harmonic2quarticAngleConversion"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.harmonic2quarticAngleConversion">[docs]</a>    <span class="k">def</span> <span class="nf">harmonic2quarticAngleConversion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kh</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b0</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;conversion of a harmonic bondanglebending force constant to a cubic in cosine/quartic one</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kh : float</span>
<span class="sd">            harmonic bondanglebending force constant (CHT)</span>
<span class="sd">        b0 : float</span>
<span class="sd">            bondangle 0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            cubic in cosine force constant (CT)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This conversion is taken from GROMOS manual II 18.1. Conversion of force constants</span>

        <span class="n">b0rad</span> <span class="o">=</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>  <span class="c1"># b0 in radians</span>
        <span class="n">kbT</span> <span class="o">=</span> <span class="mf">2.494323</span>  <span class="c1"># k boltzman * Temperature in kJ/mol</span>

        <span class="c1"># cosine is radian, but harmonic force constant is in degree -&gt; first cos inside has to be calculated in degree</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">b0</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">kbT</span> <span class="o">/</span> <span class="n">kh</span><span class="p">)))</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b0rad</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">b0</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">kbT</span> <span class="o">/</span> <span class="n">kh</span><span class="p">)))</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b0rad</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">kbT</span> <span class="o">/</span> <span class="p">(</span><span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span><span class="p">)</span></div>

<div class="viewcode-block" id="Top.add_new_torsiondihedral"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_torsiondihedral">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_torsiondihedral</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">CP</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">PD</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">NP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">atomI</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">atomJ</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">atomK</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">atomL</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">includesH</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add a torsiondihedral between atom I, J, K and L to the TORSIONDIHEDRAL block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        CP : float</span>
<span class="sd">            force constant</span>
<span class="sd">        PD : float</span>
<span class="sd">            phase</span>
<span class="sd">        NP : int</span>
<span class="sd">            multiplicity</span>
<span class="sd">        atomI : int</span>
<span class="sd">            atom I</span>
<span class="sd">        atomJ : int</span>
<span class="sd">            atom J</span>
<span class="sd">        atomK : int</span>
<span class="sd">            atom K</span>
<span class="sd">        atomL : int</span>
<span class="sd">            atom L</span>
<span class="sd">        includesH : bool, optional</span>
<span class="sd">            DIHEDRAL or DIHEDRALH, by default False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check if all classes are ready, if not create</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;TORSDIHEDRALTYPE&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;TORSDIHEDRALTYPE&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">includesH</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;DIHEDRALH&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;DIHEDRALH&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;DIHEDRAL&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;DIHEDRAL&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

        <span class="c1"># find the TORSDIHEDRALTYPE number or create new TORSDIHEDRALTYPE</span>
        <span class="n">torsion_type_number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">iterator</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">torsion_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TORSDIHEDRALTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">torsion_type</span><span class="o">.</span><span class="n">CP</span> <span class="o">==</span> <span class="n">CP</span> <span class="ow">and</span> <span class="n">torsion_type</span><span class="o">.</span><span class="n">PD</span> <span class="o">==</span> <span class="n">PD</span> <span class="ow">and</span> <span class="n">torsion_type</span><span class="o">.</span><span class="n">NP</span> <span class="o">==</span> <span class="n">NP</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iterator</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">torsion_type_number</span> <span class="o">=</span> <span class="n">iterator</span>  <span class="c1"># found the torsion</span>
        <span class="k">if</span> <span class="n">iterator</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TORSDIHEDRALTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># torsion type was not found -&gt; add new bondtype</span>
            <span class="n">newTORSDIHEDRALTYPE</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="n">torsdihedraltype_type</span><span class="p">(</span><span class="n">CP</span><span class="o">=</span><span class="n">CP</span><span class="p">,</span> <span class="n">PD</span><span class="o">=</span><span class="n">PD</span><span class="p">,</span> <span class="n">NP</span><span class="o">=</span><span class="n">NP</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TORSDIHEDRALTYPE</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newTORSDIHEDRALTYPE</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TORSDIHEDRALTYPE</span><span class="o">.</span><span class="n">NPTY</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># check if we are adding a bond to DIHEDRAL or DIHEDRALH</span>
        <span class="k">if</span> <span class="n">includesH</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DIHEDRALH</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">blocks</span><span class="o">.</span><span class="n">dihedralh_type</span><span class="p">(</span><span class="n">IPH</span><span class="o">=</span><span class="n">atomI</span><span class="p">,</span> <span class="n">JPH</span><span class="o">=</span><span class="n">atomJ</span><span class="p">,</span> <span class="n">KPH</span><span class="o">=</span><span class="n">atomK</span><span class="p">,</span> <span class="n">LPH</span><span class="o">=</span><span class="n">atomL</span><span class="p">,</span> <span class="n">ICPH</span><span class="o">=</span><span class="n">torsion_type_number</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DIHEDRALH</span><span class="o">.</span><span class="n">NPHIH</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DIHEDRAL</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">blocks</span><span class="o">.</span><span class="n">top_dihedral_type</span><span class="p">(</span><span class="n">IP</span><span class="o">=</span><span class="n">atomI</span><span class="p">,</span> <span class="n">JP</span><span class="o">=</span><span class="n">atomJ</span><span class="p">,</span> <span class="n">KP</span><span class="o">=</span><span class="n">atomK</span><span class="p">,</span> <span class="n">LP</span><span class="o">=</span><span class="n">atomL</span><span class="p">,</span> <span class="n">ICP</span><span class="o">=</span><span class="n">torsion_type_number</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DIHEDRAL</span><span class="o">.</span><span class="n">NPHI</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Top.add_new_impdihedral_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_impdihedral_type">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_impdihedral_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CQ</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Q0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add a new impodihedraltype</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        CQ : float</span>
<span class="sd">            force constant</span>
<span class="sd">        Q0 : float</span>
<span class="sd">            Q0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check if all classes are ready, if not create</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;IMPDIHEDRALTYPE&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;IMPDIHEDRALTYPE&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="n">newIMPDIHEDRALTYPE</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="n">impdihedraltype_type</span><span class="p">(</span><span class="n">CQ</span><span class="o">=</span><span class="n">CQ</span><span class="p">,</span> <span class="n">Q0</span><span class="o">=</span><span class="n">Q0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IMPDIHEDRALTYPE</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newIMPDIHEDRALTYPE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IMPDIHEDRALTYPE</span><span class="o">.</span><span class="n">NQTY</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Top.add_new_impdihedral"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_impdihedral">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_impdihedral</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">CQ</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">Q0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">atomI</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">atomJ</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">atomK</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">atomL</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">includesH</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add a new impdihedral</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        CQ : float</span>
<span class="sd">            force constant</span>
<span class="sd">        Q0 : float</span>
<span class="sd">            Q0</span>
<span class="sd">        atomI : int</span>
<span class="sd">            atom I</span>
<span class="sd">        atomJ : int</span>
<span class="sd">            atom J</span>
<span class="sd">        atomK : int</span>
<span class="sd">            atom K</span>
<span class="sd">        atomL : int</span>
<span class="sd">            atom L</span>
<span class="sd">        includesH : bool, optional</span>
<span class="sd">            IMPDIHEDRALH or IMPDIHEDRAL, by default False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check if all classes are ready, if not create</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;IMPDIHEDRALTYPE&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;IMPDIHEDRALTYPE&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">includesH</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;IMPDIHEDRALH&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;IMPDIHEDRALH&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;IMPDIHEDRAL&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;IMPDIHEDRAL&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

        <span class="c1"># find the IMPDIHEDRALTYPE number or create new IMPDIHEDRALTYPE</span>
        <span class="n">impdihedral_type_number</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">iterator</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">imp_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">IMPDIHEDRALTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">imp_type</span><span class="o">.</span><span class="n">CQ</span> <span class="o">==</span> <span class="n">CQ</span> <span class="ow">and</span> <span class="n">imp_type</span><span class="o">.</span><span class="n">Q0</span> <span class="o">==</span> <span class="n">Q0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iterator</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">impdihedral_type_number</span> <span class="o">=</span> <span class="n">iterator</span>  <span class="c1"># found the torsion</span>
        <span class="k">if</span> <span class="n">iterator</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IMPDIHEDRALTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># torsion type was not found -&gt; add new bondtype</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_new_impdihedral_type</span><span class="p">(</span><span class="n">CQ</span><span class="o">=</span><span class="n">CQ</span><span class="p">,</span> <span class="n">Q0</span><span class="o">=</span><span class="n">Q0</span><span class="p">)</span>

        <span class="c1"># check if we are adding a bond to IMPDIHEDRALH or IMPDIHEDRALH</span>
        <span class="k">if</span> <span class="n">includesH</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IMPDIHEDRALH</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">blocks</span><span class="o">.</span><span class="n">impdihedralh_type</span><span class="p">(</span><span class="n">IQH</span><span class="o">=</span><span class="n">atomI</span><span class="p">,</span> <span class="n">JQH</span><span class="o">=</span><span class="n">atomJ</span><span class="p">,</span> <span class="n">KQH</span><span class="o">=</span><span class="n">atomK</span><span class="p">,</span> <span class="n">LQH</span><span class="o">=</span><span class="n">atomL</span><span class="p">,</span> <span class="n">ICQH</span><span class="o">=</span><span class="n">impdihedral_type_number</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IMPDIHEDRALH</span><span class="o">.</span><span class="n">NQHIH</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IMPDIHEDRAL</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">blocks</span><span class="o">.</span><span class="n">impdihedral_type</span><span class="p">(</span><span class="n">IQ</span><span class="o">=</span><span class="n">atomI</span><span class="p">,</span> <span class="n">JQ</span><span class="o">=</span><span class="n">atomJ</span><span class="p">,</span> <span class="n">KQ</span><span class="o">=</span><span class="n">atomK</span><span class="p">,</span> <span class="n">LQ</span><span class="o">=</span><span class="n">atomL</span><span class="p">,</span> <span class="n">ICQ</span><span class="o">=</span><span class="n">impdihedral_type_number</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IMPDIHEDRAL</span><span class="o">.</span><span class="n">NQHI</span> <span class="o">+=</span> <span class="mi">1</span></div>

    <span class="c1"># TODO: add implementation</span>
<div class="viewcode-block" id="Top.add_new_crossdihedral"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_crossdihedral">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_crossdihedral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Who needs this???? Could you plox implement it. UwU&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Top.add_new_LJparameter"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_LJparameter">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_LJparameter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">C6</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">C12</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">CS6</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">CS12</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">combination_rule</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;geometric&quot;</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">AddATOMTYPENAME</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">lowerBound</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-100</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add a LJ entry to the LJ parameter block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        C6 : float</span>
<span class="sd">        C12 : float</span>
<span class="sd">        CS6 : float, optional</span>
<span class="sd">        CS12 : float, optional</span>
<span class="sd">        combination_rule : str, optional</span>
<span class="sd">            no other options supported rigth now, by default &quot;geometric&quot;</span>
<span class="sd">        AddATOMTYPENAME : str, optional</span>
<span class="sd">            if not None a new atomtype is made, by default None</span>
<span class="sd">        lowerBound : float, optional</span>
<span class="sd">            saftey, by default 1e-100</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;LJPARAMETERS&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;LJPARAMETERS&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">NRATT2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># safety</span>
        <span class="k">if</span> <span class="n">C6</span> <span class="o">&lt;</span> <span class="n">lowerBound</span><span class="p">:</span>
            <span class="n">C6</span> <span class="o">=</span> <span class="n">lowerBound</span>
        <span class="k">if</span> <span class="n">C12</span> <span class="o">&lt;</span> <span class="n">lowerBound</span><span class="p">:</span>
            <span class="n">C12</span> <span class="o">=</span> <span class="n">lowerBound</span>
        <span class="k">if</span> <span class="n">CS6</span> <span class="o">&lt;</span> <span class="n">lowerBound</span><span class="p">:</span>
            <span class="n">CS6</span> <span class="o">=</span> <span class="n">lowerBound</span>
        <span class="k">if</span> <span class="n">CS12</span> <span class="o">&lt;</span> <span class="n">lowerBound</span><span class="p">:</span>
            <span class="n">CS12</span> <span class="o">=</span> <span class="n">lowerBound</span>
        <span class="c1"># add LJ parameter for all existing combinations</span>
        <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nratt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">NRATT2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nratt</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">combination_rule</span> <span class="o">==</span> <span class="s2">&quot;geometric&quot;</span><span class="p">:</span>
                <span class="n">c6</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">C6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="n">num</span><span class="p">]</span><span class="o">.</span><span class="n">C6</span><span class="p">))</span>
                <span class="n">c12</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">C12</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="n">num</span><span class="p">]</span><span class="o">.</span><span class="n">C12</span><span class="p">))</span>
                <span class="n">cs6</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">CS6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="n">num</span><span class="p">]</span><span class="o">.</span><span class="n">CS6</span><span class="p">))</span>
                <span class="n">cs12</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">CS12</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="n">num</span><span class="p">]</span><span class="o">.</span><span class="n">CS12</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Error in add_new_LJparameter: desired combination rule not implemented&quot;</span><span class="p">)</span>
            <span class="n">add</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="n">ljparameters_type</span><span class="p">(</span><span class="n">IAC</span><span class="o">=</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">JAC</span><span class="o">=</span><span class="n">nratt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">C6</span><span class="o">=</span><span class="n">c6</span><span class="p">,</span> <span class="n">C12</span><span class="o">=</span><span class="n">c12</span><span class="p">,</span> <span class="n">CS12</span><span class="o">=</span><span class="n">cs12</span><span class="p">,</span> <span class="n">CS6</span><span class="o">=</span><span class="n">cs6</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
            <span class="n">num</span> <span class="o">+=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="c1"># add new LJ paramter to self</span>
        <span class="n">add</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="n">ljparameters_type</span><span class="p">(</span><span class="n">IAC</span><span class="o">=</span><span class="n">nratt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">JAC</span><span class="o">=</span><span class="n">nratt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">C6</span><span class="o">=</span><span class="n">C6</span><span class="p">,</span> <span class="n">C12</span><span class="o">=</span><span class="n">C12</span><span class="p">,</span> <span class="n">CS12</span><span class="o">=</span><span class="n">CS12</span><span class="p">,</span> <span class="n">CS6</span><span class="o">=</span><span class="n">CS6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">NRATT2</span> <span class="o">+=</span> <span class="n">nratt</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">AddATOMTYPENAME</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATOMTYPENAME&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;ATOMTYPENAME&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">NRATT</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_new_atomtype</span><span class="p">(</span><span class="n">AddATOMTYPENAME</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ATOMTYPENAME</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">IAC</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Missmatch between number of ATOMTYPNAMEs and LJPARAMETERS&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Top.find_LJparameterNumber"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.find_LJparameterNumber">[docs]</a>    <span class="k">def</span> <span class="nf">find_LJparameterNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">C12</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">C6</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;find the LJ parameter number&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;LJPARAMETERS&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">NRATT2</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">lj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">C12</span> <span class="o">==</span> <span class="n">lj</span><span class="o">.</span><span class="n">C12</span> <span class="ow">and</span> <span class="n">C6</span> <span class="o">==</span> <span class="n">lj</span><span class="o">.</span><span class="n">C6</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">lj</span><span class="o">.</span><span class="n">IAC</span>
            <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># LJ parameter not found</span></div>

<div class="viewcode-block" id="Top.get_LJparameter_from_IAC"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.get_LJparameter_from_IAC">[docs]</a>    <span class="k">def</span> <span class="nf">get_LJparameter_from_IAC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IAC</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the LJ parameter from the IAC number</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        IAC : int</span>
<span class="sd">            [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;LJPARAMETERS&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;no LJPARAMETERS block to search in&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">IAC</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">NRATT2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;IAC key is too larger than IACs in LJ block&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">content</span><span class="p">[(</span><span class="n">IAC</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span></div>

<div class="viewcode-block" id="Top.add_new_atom"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_atom">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_atom</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ATNM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">MRES</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">PANM</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span>
        <span class="n">IAC</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">MASS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">CG</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">CGC</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">INE</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">INE14</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">C6</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">C12</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">CS6</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">CS12</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">IACname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;add a atom to a system (with creating a new atomtype if needed and adding LJ parameters if needed)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ATNM : int, optional</span>
<span class="sd">            number of the atom in the system, by default 0</span>
<span class="sd">        MRES : int, optional</span>
<span class="sd">            residue number, by default 0</span>
<span class="sd">        PANM : str, optional</span>
<span class="sd">            name of the atom, by default &#39;_&#39;</span>
<span class="sd">        IAC : int, optional</span>
<span class="sd">            atomtype number of the atom, by default 1</span>
<span class="sd">        MASS : float, optional</span>
<span class="sd">            mass of the atom, by default 1.0</span>
<span class="sd">        CG : int, optional</span>
<span class="sd">            charge of the atom, by default 0</span>
<span class="sd">        CGC : int, optional</span>
<span class="sd">            charge group bool, by default 1</span>
<span class="sd">        INE : list, optional</span>
<span class="sd">            INE list, by default []</span>
<span class="sd">        INE14 : list, optional</span>
<span class="sd">            INE14 list, by default []</span>
<span class="sd">        C6 : float, optional</span>
<span class="sd">            C6 value, by default None</span>
<span class="sd">        C12 : float, optional</span>
<span class="sd">            C12 value, by default None</span>
<span class="sd">        CS6 : float, optional</span>
<span class="sd">            CS6 value, by default 0</span>
<span class="sd">        CS12 : float, optional</span>
<span class="sd">            CS12 value, by default 0</span>
<span class="sd">        IACname : str, optional</span>
<span class="sd">            new IACname if NONE PANM is used, by default None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">IACname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">IACname</span> <span class="o">=</span> <span class="n">PANM</span>

        <span class="c1"># Find IAC and (if needed) add a new LJ Parameter</span>
        <span class="k">if</span> <span class="n">C6</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">C12</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># need to find PANM and IAC</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;LJPARAMETERS&quot;</span><span class="p">):</span>
                <span class="n">IAC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_LJparameterNumber</span><span class="p">(</span><span class="n">C6</span><span class="o">=</span><span class="n">C6</span><span class="p">,</span> <span class="n">C12</span><span class="o">=</span><span class="n">C12</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">IAC</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># IAC not found -&gt; add new LJ parameter</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_new_LJparameter</span><span class="p">(</span>
                        <span class="n">C6</span><span class="o">=</span><span class="n">C6</span><span class="p">,</span> <span class="n">C12</span><span class="o">=</span><span class="n">C12</span><span class="p">,</span> <span class="n">CS6</span><span class="o">=</span><span class="n">CS6</span><span class="p">,</span> <span class="n">CS12</span><span class="o">=</span><span class="n">CS12</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">AddATOMTYPENAME</span><span class="o">=</span><span class="n">IACname</span>
                    <span class="p">)</span>
                    <span class="n">IAC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LJPARAMETERS</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">IAC</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New Atomtype with LJ parameters added. IAC found as: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">IAC</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_new_LJparameter</span><span class="p">(</span><span class="n">C6</span><span class="o">=</span><span class="n">C6</span><span class="p">,</span> <span class="n">C12</span><span class="o">=</span><span class="n">C12</span><span class="p">,</span> <span class="n">CS6</span><span class="o">=</span><span class="n">CS6</span><span class="p">,</span> <span class="n">CS12</span><span class="o">=</span><span class="n">CS12</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">AddATOMTYPENAME</span><span class="o">=</span><span class="n">IACname</span><span class="p">)</span>
                <span class="n">IAC</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_new_soluteatom</span><span class="p">(</span>
            <span class="n">ATNM</span><span class="o">=</span><span class="n">ATNM</span><span class="p">,</span> <span class="n">MRES</span><span class="o">=</span><span class="n">MRES</span><span class="p">,</span> <span class="n">PANM</span><span class="o">=</span><span class="n">PANM</span><span class="p">,</span> <span class="n">IAC</span><span class="o">=</span><span class="n">IAC</span><span class="p">,</span> <span class="n">MASS</span><span class="o">=</span><span class="n">MASS</span><span class="p">,</span> <span class="n">CG</span><span class="o">=</span><span class="n">CG</span><span class="p">,</span> <span class="n">CGC</span><span class="o">=</span><span class="n">CGC</span><span class="p">,</span> <span class="n">INE</span><span class="o">=</span><span class="n">INE</span><span class="p">,</span> <span class="n">INE14</span><span class="o">=</span><span class="n">INE14</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Top.add_new_CONSTRAINT"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_CONSTRAINT">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_CONSTRAINT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IC</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">JC</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ICC</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        adds a CONSTRAINT entry to the topology</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        IC : int</span>
<span class="sd">            atom index I</span>
<span class="sd">        JC : int</span>
<span class="sd">            atom index J</span>
<span class="sd">        ICC : float</span>
<span class="sd">            constraint length</span>
<span class="sd">        verbose : bool, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;CONSTRAINT&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;CONSTRAINT&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CONSTRAINT</span><span class="o">.</span><span class="n">NCON</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;BONDSTRETCHTYPE&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;BONDSTRETCHTYPE&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

        <span class="c1"># find the bondstretchtype number or create new bondstretchtype</span>
        <span class="n">bond_type_number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">iterator</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">newBondStretchType</span> <span class="o">=</span> <span class="n">blocks</span><span class="o">.</span><span class="n">bondstretchtype_type</span><span class="p">(</span><span class="n">CB</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">CHB</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B0</span><span class="o">=</span><span class="n">ICC</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">bond_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">BONDSTRETCHTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bond_type</span><span class="o">.</span><span class="n">B0</span> <span class="o">==</span> <span class="n">newBondStretchType</span><span class="o">.</span><span class="n">B0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iterator</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">bond_type_number</span> <span class="o">=</span> <span class="n">iterator</span>
        <span class="k">if</span> <span class="n">iterator</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BONDSTRETCHTYPE</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># bond type was not found -&gt; add new bondtype</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDSTRETCHTYPE</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newBondStretchType</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDSTRETCHTYPE</span><span class="o">.</span><span class="n">NBTY</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CONSTRAINT</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blocks</span><span class="o">.</span><span class="n">constraint_type</span><span class="p">(</span><span class="n">IC</span><span class="o">=</span><span class="n">IC</span><span class="p">,</span> <span class="n">JC</span><span class="o">=</span><span class="n">JC</span><span class="p">,</span> <span class="n">ICC</span><span class="o">=</span><span class="n">bond_type_number</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CONSTRAINT</span><span class="o">.</span><span class="n">NCON</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Top.add_new_TEMPERATUREGROUPS"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_TEMPERATUREGROUPS">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_TEMPERATUREGROUPS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;TEMPERATUREGROUPS&quot;</span><span class="p">):</span>
            <span class="n">defaultContent</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;TEMPERATUREGROUPS&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">defaultContent</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TEMPERATUREGROUPS</span><span class="o">.</span><span class="n">NSP</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TEMPERATUREGROUPS</span><span class="o">.</span><span class="n">NSM</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TEMPERATUREGROUPS</span><span class="o">.</span><span class="n">NSP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">number</span><span class="p">)</span></div>

<div class="viewcode-block" id="Top.add_new_SOLUTEMOLECULES"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_SOLUTEMOLECULES">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_SOLUTEMOLECULES</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;SOLUTEMOLECULES&quot;</span><span class="p">):</span>
            <span class="n">defaultContent</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;SOLUTEMOLECULES&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">defaultContent</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSP</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSM</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SOLUTEMOLECULES</span><span class="o">.</span><span class="n">NSP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">number</span><span class="p">)</span></div>

<div class="viewcode-block" id="Top.add_new_PRESSUREGROUPS"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.add_new_PRESSUREGROUPS">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_PRESSUREGROUPS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;PRESSUREGROUPS&quot;</span><span class="p">):</span>
            <span class="n">defaultContent</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">blocktitle</span><span class="o">=</span><span class="s2">&quot;PRESSUREGROUPS&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">defaultContent</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PRESSUREGROUPS</span><span class="o">.</span><span class="n">NSP</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PRESSUREGROUPS</span><span class="o">.</span><span class="n">NSM</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PRESSUREGROUPS</span><span class="o">.</span><span class="n">NSP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">number</span><span class="p">)</span></div>

<div class="viewcode-block" id="Top.get_mass"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.get_mass">[docs]</a>    <span class="k">def</span> <span class="nf">get_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the total mass of the solute molecule</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            total mass in a.u.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mass</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;SOLUTEATOM&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SOLUTEATOM</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
                <span class="n">mass</span> <span class="o">+=</span> <span class="n">i</span><span class="o">.</span><span class="n">MASS</span>
        <span class="k">return</span> <span class="n">mass</span></div>

<div class="viewcode-block" id="Top.get_diff_to_top"><a class="viewcode-back" href="../../../../_source/pygromos.files.topology.html#pygromos.files.topology.top.Top.get_diff_to_top">[docs]</a>    <span class="k">def</span> <span class="nf">get_diff_to_top</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">:</span> <span class="n">Top_Type</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">block</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span> <span class="o">!=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">():</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Block &quot;</span> <span class="o">+</span> <span class="n">block</span> <span class="o">+</span> <span class="s2">&quot; is different&quot;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block</span><span class="p">)))</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;top: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">block</span><span class="p">)))</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Benjamin Ries, Marc Lehner, Salome Rieder. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.3

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>