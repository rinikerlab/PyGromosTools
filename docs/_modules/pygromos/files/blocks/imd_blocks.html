<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pygromos.files.blocks.imd_blocks &mdash; PyGromosTools  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> PyGromosTools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Welcome to PyGromosTools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../_source/modules.html">Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">PyGromosTools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
          <li><a href="../blocks.html">pygromos.files.blocks</a> &raquo;</li>
      <li>pygromos.files.blocks.imd_blocks</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pygromos.files.blocks.imd_blocks</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">pygromos.files.blocks._general_blocks</span> <span class="kn">import</span> <span class="n">TITLE</span> <span class="k">as</span> <span class="n">generic_TITLE</span>
<span class="kn">from</span> <span class="nn">pygromos.files.blocks._general_blocks</span> <span class="kn">import</span> <span class="n">_generic_gromos_block</span>
<span class="kn">from</span> <span class="nn">pygromos.utils.typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Number</span>

<span class="c1"># forward declarations</span>
<span class="n">TITLE</span><span class="p">:</span> <span class="n">generic_TITLE</span> <span class="o">=</span> <span class="n">generic_TITLE</span>


<span class="k">class</span> <span class="nc">_generic_imd_block</span><span class="p">(</span><span class="n">_generic_gromos_block</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;genericBlock&quot;</span>
    <span class="n">_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>  <span class="c1"># contains the ordering of all fields in a block</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">used</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">used</span><span class="o">=</span><span class="n">used</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">field_names</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">field_names</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">:</span>
                    <span class="n">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="n">attribute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)):</span>  <span class="c1"># One element field</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
                                <span class="n">attribute</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>  <span class="c1"># supress scientific notation for floats!</span>
                                <span class="n">attribute</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">)</span>
                            <span class="n">result</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">List</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
                            <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Number</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">attribute</span><span class="p">]</span>
                        <span class="p">):</span>  <span class="c1"># list content</span>
                            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">attribute</span><span class="p">]):</span>
                                <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
                            <span class="k">elif</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">attribute</span><span class="p">]):</span>
                                <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">attribute</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                    <span class="s2">&quot;could not Interpret list:  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">EOF</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="p">)</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">List</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">List</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">attribute</span><span class="p">]):</span>  <span class="c1"># matrices</span>
                            <span class="n">pre_parsed_rows</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">attribute</span><span class="p">)</span>
                            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                                <span class="n">pre_parsed_rows</span>
                            <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                                <span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span>
                            <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">&quot;Could not convert attribute &quot;</span>
                            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
                            <span class="o">+</span> <span class="s2">&quot; to string!</span><span class="se">\n</span><span class="s2"> value of attribute was: </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
                            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">EOF</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="p">)</span>

                <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="n">keyLineNumb</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">contentlines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;# &quot;</span><span class="p">):</span>
                <span class="c1"># a new key line was found add values to class</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contentlines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_parse_key_content</span><span class="p">(</span><span class="n">keyLineNumb</span><span class="o">=</span><span class="n">keyLineNumb</span><span class="p">,</span> <span class="n">contentlines</span><span class="o">=</span><span class="n">contentlines</span><span class="p">)</span>
                    <span class="n">keyLineNumb</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># go next key line</span>
                    <span class="n">contentlines</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># reset content storage</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># no key found -&gt; add data to list to be later added to key</span>
                <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="p">)</span>
                <span class="k">while</span> <span class="s2">&quot;&quot;</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
                    <span class="n">fields</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="n">contentlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
        <span class="c1"># add fianl key after loop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_key_content</span><span class="p">(</span><span class="n">keyLineNumb</span><span class="o">=</span><span class="n">keyLineNumb</span><span class="p">,</span> <span class="n">contentlines</span><span class="o">=</span><span class="n">contentlines</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_key_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keyLineNumb</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">contentlines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]):</span>
        <span class="c1"># print(&quot;----------------&quot;)</span>
        <span class="c1"># print(contentlines)</span>
        <span class="c1"># print(self._order[0])</span>
        <span class="c1"># print(keyLineNumb)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contentlines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># it&#39;s a one liner</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contentlines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">keyLineNumb</span><span class="p">]):</span>
                <span class="c1"># found key-value match</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">keyLineNumb</span><span class="p">],</span> <span class="n">contentlines</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="c1"># first bring key to attribute form</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clean_key_from_order</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
                    <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_to_convert_field</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="n">field</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># parse multi line</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">keyLineNumb</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># one key but multiple fields</span>
                <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clean_key_from_order</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">keyLineNumb</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_to_convert_field</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="n">contentlines</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># set attribute with a list over multiple lines for keys in paralles (example temp baths)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">keyLineNumb</span><span class="p">]):</span>
                    <span class="n">field</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">contentlines</span><span class="p">]</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clean_key_from_order</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
                    <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_to_convert_field</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="n">field</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_clean_key_from_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># key = key.replace(&quot;(&quot;,&quot; &quot;).replace(&quot;.&quot;,&quot; &quot;)</span>
        <span class="c1"># key.split(&quot; &quot;)</span>
        <span class="c1"># return key[0]</span>
        <span class="k">if</span> <span class="s2">&quot;(&quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">key</span>

    <span class="k">def</span> <span class="nf">_try_to_convert_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">any</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>  <span class="c1"># solves the type problem for simple types</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">[</span><span class="n">key</span><span class="p">](</span><span class="n">field</span><span class="p">)</span>  <span class="c1"># solves the type problem for simple types</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">field</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">field</span><span class="p">]):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">field</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">field</span>
            <span class="k">elif</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">field</span><span class="p">])</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">field</span><span class="p">]):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">[[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">field</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">field</span>


<div class="viewcode-block" id="SYSTEM"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.SYSTEM">[docs]</a><span class="k">class</span> <span class="nc">SYSTEM</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;System Block</span>

<span class="sd">        The system block defines the number of solute molecules and solvent molecules</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NPM:    int</span>
<span class="sd">        Number of Solute Molecules</span>
<span class="sd">    NSM:    int</span>
<span class="sd">        Number of Solvent Molecules</span>



<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;SYSTEM&quot;</span>

    <span class="c1"># fields</span>
    <span class="n">NPM</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># number of Solute Molecules</span>
    <span class="n">NSM</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># number of Solvent Molecules</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NPM&quot;</span><span class="p">,</span> <span class="s2">&quot;NSM&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NPM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NSM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NPM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NPM</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NSM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NSM</span><span class="p">)</span></div>


<div class="viewcode-block" id="STEP"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.STEP">[docs]</a><span class="k">class</span> <span class="nc">STEP</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Step Block</span>

<span class="sd">        This Block gives the number of simulation steps,</span>

<span class="sd">    Attributes</span>
<span class="sd">    -----------</span>
<span class="sd">    NSTLIM: int</span>
<span class="sd">        number of simulations Step till terminating.</span>
<span class="sd">    T:  float</span>
<span class="sd">        Starting Time</span>
<span class="sd">    DT: float</span>
<span class="sd">        time step [fs]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;STEP&quot;</span>

    <span class="c1"># fields</span>
    <span class="n">NSTLIM</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">T</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">DT</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NSTLIM&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;DT&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NSTLIM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">DT</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NSTLIM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NSTLIM</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DT</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">DT</span><span class="p">)</span></div>


<div class="viewcode-block" id="REPLICA"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.REPLICA">[docs]</a><span class="k">class</span> <span class="nc">REPLICA</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;REPLICA Block</span>

<span class="sd">        This block is controlling the REPLICA settings in gromos. It works both for T-REMD and H-REMD</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    RETL:   bool</span>
<span class="sd">        Do you want to rund an RE simulation or not?</span>
<span class="sd">        RETL=0 : turn off RE</span>
<span class="sd">        RETL=1 : turn on RE</span>
<span class="sd">    NRET:   int</span>
<span class="sd">        Number of temperatures</span>
<span class="sd">    RET:    List[float]</span>
<span class="sd">        List of temperature at each replica</span>
<span class="sd">    LRESCALE:   bool</span>
<span class="sd">        controls temperature scaling</span>
<span class="sd">        0 don&#39;t scale temperatures after exchange trial</span>
<span class="sd">        1 scale temperatures after exchange trial</span>
<span class="sd">    NRELAM: int</span>
<span class="sd">        number of lambda values</span>
<span class="sd">    RELAM:  List[float]</span>
<span class="sd">        lambda value for each lambda-replica</span>
<span class="sd">    RETS:   List[float]</span>
<span class="sd">        timestep of each LAMBDA replica</span>
<span class="sd">    NRETRIAL:   int</span>
<span class="sd">        How many replica exchanges trials should be executed? (NRETRIAL*STEP.NSTLIM == total simulation time)</span>
<span class="sd">    NREQUIL:    int</span>
<span class="sd">        How many equilibration runs shall be exectured? (NREQUIL*STEP.NSTLIM == total simulation time)</span>
<span class="sd">    CONT:   bool</span>
<span class="sd">        Is this a continuation run?</span>
<span class="sd">        0 start from one configuration file</span>
<span class="sd">        1 start from multiple configuration files</span>


<span class="sd">    Example Block</span>
<span class="sd">    -------------</span>
<span class="sd">    # RETL</span>
<span class="sd">    1</span>
<span class="sd">    # NRET</span>
<span class="sd">    10</span>
<span class="sd">    # RET(1..NRET)</span>
<span class="sd">    300.0  320.0  340.0 360.0 380.0</span>
<span class="sd">    400.0  420.0  440.0 460.0 480.0</span>
<span class="sd">    # LRESCALE</span>
<span class="sd">    1</span>
<span class="sd">    # NRELAM</span>
<span class="sd">    10</span>
<span class="sd">    # RELAM(1..NRELAM</span>
<span class="sd">    0.0    0.1    0.2   0.3   0.4</span>
<span class="sd">    0.5    0.6    0.7   0.8   0.9</span>
<span class="sd">    # RETS(1..NRELAM)</span>
<span class="sd">    0.002  0.001  0.001 0.001 0.002</span>
<span class="sd">    0.003  0.002  0.001 0.001 0.002</span>
<span class="sd">    # NRETRIAL</span>
<span class="sd">    100</span>
<span class="sd">    # NREQUIL</span>
<span class="sd">    10</span>
<span class="sd">    # CONT</span>
<span class="sd">    0</span>
<span class="sd">    END</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;REPLICA&quot;</span>

    <span class="n">RETL</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="n">NRET</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">RET</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>

    <span class="n">LRESCALE</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="n">NRELAM</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">RELAM</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">RETS</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>

    <span class="n">NRETRIAL</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NREQUIL</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">CONT</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;RETL&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NRET&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;RET(1 ... NRET)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;LRESCALE&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NRELAM&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;RELAM(1 ... NRELAM)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;RETS(1 ... NRELAM)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NRETRIAL&quot;</span><span class="p">,</span> <span class="s2">&quot;NREQUIL&quot;</span><span class="p">,</span> <span class="s2">&quot;CONT&quot;</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">RETL</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">NRET</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">RET</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">LRESCALE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NRELAM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">RELAM</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">RETS</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">NRETRIAL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NREQUIL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">CONT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RETL</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">RETL</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">NRET</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NRET</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RET</span> <span class="o">=</span> <span class="n">RET</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">LRESCALE</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">LRESCALE</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">NRELAM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NRELAM</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RELAM</span> <span class="o">=</span> <span class="n">RELAM</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RETS</span> <span class="o">=</span> <span class="n">RETS</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">NRETRIAL</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NRETRIAL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NREQUIL</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NREQUIL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CONT</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">CONT</span><span class="p">)</span>

<div class="viewcode-block" id="REPLICA.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.REPLICA.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;RETL&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;NRET&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">T_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">T_values</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">NRET</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;RET&quot;</span><span class="p">,</span> <span class="n">T_values</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;REPLICA: NRET was not equal to the number of Temperatures (RET) in IMD!&quot;</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;LRESCALE&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;NRELAM&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">lambda_val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lambda_val</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">NRELAM</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;RELAM&quot;</span><span class="p">,</span> <span class="n">lambda_val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;REPLICA: NRELAM was not equal to the number of lambda values (RELAM) in IMD!&quot;</span><span class="p">)</span>
            <span class="n">lambda_timestep</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lambda_timestep</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">NRELAM</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;RETS&quot;</span><span class="p">,</span> <span class="n">lambda_timestep</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;REPLICA: NRELAM was not equal to the number of lambda timestep values (RETS) in IMD!&quot;</span><span class="p">)</span>
            <span class="p">[</span><span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">content</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">())]</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Could not parse block from str - &quot;</span> <span class="o">+</span> <span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">args</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="NEW_REPLICA_EDS"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.NEW_REPLICA_EDS">[docs]</a><span class="k">class</span> <span class="nc">NEW_REPLICA_EDS</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;REPLICA_EDS Block</span>

<span class="sd">        This block is controlling the REPLICA_EDS settings in  gromos and is basically a mixture of EDS and RE block. (Don&#39;t use them when using this block!)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    REEDS:  bool</span>
<span class="sd">        Shall REEDS be activated?</span>
<span class="sd">    NRES:   int</span>
<span class="sd">        Number of s-Values</span>
<span class="sd">    NEOFF:  int</span>
<span class="sd">        number of replica exchange eds energy Offset vectors (only used for 2D REEDS - still needs to be present ;))</span>
<span class="sd">    NUMSTATES:  int</span>
<span class="sd">        Number of EDS-states</span>

<span class="sd">    RES:    List[float]</span>
<span class="sd">        s_values for all replicas</span>
<span class="sd">    EIR:    List[List[float]]</span>
<span class="sd">        energy offsets for all replicas and all states  List[List[float]] = REPLICA[EDS_STATE[EIR]]</span>
<span class="sd">    NERTRIAL: int</span>
<span class="sd">        How many replica exchanges trials should be executed? (NRETRIAL*STEP.NSTLIM == total simulation time)</span>
<span class="sd">    NREQUIL: int</span>
<span class="sd">        How many equilibration runs shall be exectured? (NREQUIL*STEP.NSTLIM == total simulation time)</span>
<span class="sd">    EDS_STAT_OUT: int</span>
<span class="sd">        Shall the replica exchange information be outputted? (__future__ frequency of output.)</span>
<span class="sd">    CONT: bool</span>
<span class="sd">        Is this a continuation run?</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;REPLICA_EDS&quot;</span>

    <span class="n">REEDS</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="n">NRES</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NEOFF</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NUMSTATES</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">RES</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">EIR</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>

    <span class="n">NRETRIAL</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NREQUIL</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">EDS_STAT_OUT</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">CONT</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">PERIODIC</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;REEDS&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NRES&quot;</span><span class="p">,</span> <span class="s2">&quot;NUMSTATES&quot;</span><span class="p">,</span> <span class="s2">&quot;NEOFF&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;RES(1 ... NRES)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;EIR(NUMSTATES x NRES)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NRETRIAL&quot;</span><span class="p">,</span> <span class="s2">&quot;NREQUIL&quot;</span><span class="p">,</span> <span class="s2">&quot;CONT&quot;</span><span class="p">,</span> <span class="s2">&quot;EDS_STAT_OUT&quot;</span><span class="p">,</span> <span class="s2">&quot;PERIODIC&quot;</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">REEDS</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">NRES</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NUMSTATES</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NEOFF</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">RES</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">EIR</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[[]],</span>
        <span class="n">NRETRIAL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NREQUIL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">EDS_STAT_OUT</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">CONT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">PERIODIC</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">REEDS</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">REEDS</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">NRES</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NRES</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NEOFF</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NEOFF</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NUMSTATES</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NUMSTATES</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">RES</span> <span class="o">=</span> <span class="n">RES</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EIR</span> <span class="o">=</span> <span class="n">EIR</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">NRETRIAL</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NRETRIAL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NREQUIL</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NREQUIL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CONT</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">CONT</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EDS_STAT_OUT</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">EDS_STAT_OUT</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PERIODIC</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">PERIODIC</span><span class="p">)</span>

<div class="viewcode-block" id="NEW_REPLICA_EDS.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.NEW_REPLICA_EDS.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;REEDS&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;NRES&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;NEOFF&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;NUMSTATES&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">s_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_values</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">NRES</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;RES&quot;</span><span class="p">,</span> <span class="n">s_values</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;REPLICA_EDS: NRES was not equal to the number of s-values in IMD!&quot;</span><span class="p">)</span>
            <span class="n">EIR</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">NUMSTATES</span><span class="p">):</span>
                <span class="n">EIR_line</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">EIR_line</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NRES</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;REPLICA_EDS: NRES was not equal to the number of EIRs given in IMD!&quot;</span><span class="p">)</span>
                <span class="n">EIR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EIR_line</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;EIR&quot;</span><span class="p">,</span> <span class="n">EIR</span><span class="p">)</span>
            <span class="p">[</span><span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">content</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">())]</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Could not parse block from str - &quot;</span> <span class="o">+</span> <span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">args</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="REPLICA_EDS"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.REPLICA_EDS">[docs]</a><span class="k">class</span> <span class="nc">REPLICA_EDS</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;REPLICA_EDS&quot;</span>

    <span class="n">REEDS</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="n">NRES</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NUMSTATES</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">RES</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">EIR</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>

    <span class="n">NRETRIAL</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NREQUIL</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">EDS_STAT_OUT</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">CONT</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;REEDS&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NRES&quot;</span><span class="p">,</span> <span class="s2">&quot;NUMSTATES&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;RES(1 ... NRES)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;EIR(NUMSTATES x NRES)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NRETRIAL&quot;</span><span class="p">,</span> <span class="s2">&quot;NREQUIL&quot;</span><span class="p">,</span> <span class="s2">&quot;CONT&quot;</span><span class="p">,</span> <span class="s2">&quot;EDS_STAT_OUT&quot;</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>

<div class="viewcode-block" id="REPLICA_EDS.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.REPLICA_EDS.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">REEDS</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">NRES</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NUMSTATES</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">RES</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">EIR</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">NRETRIAL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NREQUIL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">EDS_STAT_OUT</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">CONT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;REPLICA_EDS Block</span>

<span class="sd">            This block is controlling the REPLICA_EDS settings in  gromos and is basically a mixture of EDS and RE block. (Don&#39;t use them when using this block!)</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        REEDS:  bool</span>
<span class="sd">            Shall REEDS be activated?</span>
<span class="sd">        NRES:   int</span>
<span class="sd">            Number of s-Values</span>
<span class="sd">        NUMSTATES:  int</span>
<span class="sd">            Number of EDS-states</span>

<span class="sd">        RES:    List[float]</span>
<span class="sd">            s_values for all replicas</span>
<span class="sd">        EIR:    List[List[float]]</span>
<span class="sd">            energy offsets for all replicas and all states  List[List[float]] = REPLICA[EDS_STATE[EIR]]</span>
<span class="sd">        NERTRIAL: int</span>
<span class="sd">            How many replica exchanges trials should be executed? (NRETRIAL*STEP.NSTLIM == total simulation time)</span>
<span class="sd">        NREQUIL: int</span>
<span class="sd">            How many equilibration runs shall be exectured? (NREQUIL*STEP.NSTLIM == total simulation time)</span>
<span class="sd">        EDS_STAT_OUT: int</span>
<span class="sd">            Shall the replica exchange information be outputted? (__future__ frequency of output.)</span>
<span class="sd">        CONT: bool</span>
<span class="sd">            Is this a continuation run?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">REEDS</span> <span class="o">=</span> <span class="n">REEDS</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">NRES</span> <span class="o">=</span> <span class="n">NRES</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NUMSTATES</span> <span class="o">=</span> <span class="n">NUMSTATES</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">RES</span> <span class="o">=</span> <span class="n">RES</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EIR</span> <span class="o">=</span> <span class="n">EIR</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">NRETRIAL</span> <span class="o">=</span> <span class="n">NRETRIAL</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NREQUIL</span> <span class="o">=</span> <span class="n">NREQUIL</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CONT</span> <span class="o">=</span> <span class="n">CONT</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EDS_STAT_OUT</span> <span class="o">=</span> <span class="n">EDS_STAT_OUT</span></div>

<div class="viewcode-block" id="REPLICA_EDS.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.REPLICA_EDS.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;REEDS&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;NRES&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;NUMSTATES&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">s_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_values</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">NRES</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;RES&quot;</span><span class="p">,</span> <span class="n">s_values</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;REPLICA_EDS: NRES was not equal to the number of s-values in IMD!&quot;</span><span class="p">)</span>
            <span class="n">EIR</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">NUMSTATES</span><span class="p">):</span>
                <span class="n">EIR_line</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">EIR_line</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NRES</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;REPLICA_EDS: NRES was not equal to the number of EIRs given in IMD!&quot;</span><span class="p">)</span>
                <span class="n">EIR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EIR_line</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;EIR&quot;</span><span class="p">,</span> <span class="n">EIR</span><span class="p">)</span>
            <span class="p">[</span><span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">content</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">())]</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Could not parse block from str - &quot;</span> <span class="o">+</span> <span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">args</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="BOUNDCOND"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.BOUNDCOND">[docs]</a><span class="k">class</span> <span class="nc">BOUNDCOND</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Boundary Condition Block</span>

<span class="sd">        This block describes the boundary condition of the coordinate system.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">        NTB : int, optional</span>
<span class="sd">            Boundary conditions, by default 0</span>
<span class="sd">            -1 : truncated octahedral</span>
<span class="sd">             0 : vacuum</span>
<span class="sd">             1 : rectangular</span>
<span class="sd">             2 : triclinic</span>
<span class="sd">        NDFMIN : int, optional</span>
<span class="sd">            number of degrees of freedom subtracted for temperature, by default 0</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;BOUNDCOND&quot;</span>

    <span class="n">NTB</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NDFMIN</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTB&quot;</span><span class="p">,</span> <span class="s2">&quot;NDFMIN&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NTB</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NDFMIN</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTB</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NDFMIN</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NDFMIN</span><span class="p">)</span></div>


<div class="viewcode-block" id="STOCHDYN"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.STOCHDYN">[docs]</a><span class="k">class</span> <span class="nc">STOCHDYN</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Stochastic Dynamics block</span>

<span class="sd">        This block is for Stochastic Dynamics</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTSD:    int</span>
<span class="sd">    NTFR:    int</span>
<span class="sd">    NSFR:    int</span>
<span class="sd">    NBREF:   int</span>
<span class="sd">    RCUTF:   float</span>
<span class="sd">    CFRIC:   float</span>
<span class="sd">    TEMPSD:  float</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;STOCHDYN&quot;</span>

    <span class="n">NTSD</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTFR</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NSFR</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NBREF</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">RCUTF</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">CFRIC</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">TEMPSD</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTSD&quot;</span><span class="p">,</span> <span class="s2">&quot;NTFR&quot;</span><span class="p">,</span> <span class="s2">&quot;NSFR&quot;</span><span class="p">,</span> <span class="s2">&quot;NBREF&quot;</span><span class="p">,</span> <span class="s2">&quot;RCUTF&quot;</span><span class="p">,</span> <span class="s2">&quot;CFRIC&quot;</span><span class="p">,</span> <span class="s2">&quot;TEMPSD&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">NTSD</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTFR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NSFR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NBREF</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">RCUTF</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">CFRIC</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">TEMPSD</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTSD</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTSD</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTFR</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTFR</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NSFR</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NSFR</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NBREF</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NBREF</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RCUTF</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">RCUTF</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CFRIC</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">CFRIC</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TEMPSD</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">TEMPSD</span><span class="p">)</span></div>


<div class="viewcode-block" id="PERTURBATION"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.PERTURBATION">[docs]</a><span class="k">class</span> <span class="nc">PERTURBATION</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pertubation Block</span>

<span class="sd">        This block is for Thermodynamic integration</span>


<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTG:    int</span>
<span class="sd">        0..1 controls use of free-energy calculation.</span>
<span class="sd">              0: no free-energy calculation (default)</span>
<span class="sd">              1: calculate dH/dRLAM</span>
<span class="sd">    NRDGL: int</span>
<span class="sd">        0,1 controls reading of initial value for RLAM.</span>
<span class="sd">             0: use initial RLAM parameter from PERTURBATION block</span>
<span class="sd">             1: read from configuration</span>
<span class="sd">    RLAM: float</span>
<span class="sd">        0.0..1.0 initial value for lambda</span>
<span class="sd">    DLAMT: float</span>
<span class="sd">        &gt;= 0.0 rate of lambda increase in time.</span>
<span class="sd">    ALPHLJ: float</span>
<span class="sd">        &gt;= 0.0 Lennard-Jones soft-core parameter</span>
<span class="sd">    ALPHC: float</span>
<span class="sd">        &gt;= 0.0 Coulomb-RF soft-core parameter</span>
<span class="sd">    NLAM: int</span>
<span class="sd">        &gt; 0 power dependence of lambda coupling</span>
<span class="sd">    NSCALE: int</span>
<span class="sd">        0..2 controls use of interaction scaling</span>
<span class="sd">            0: no interaction scaling</span>
<span class="sd">            1: interaction scaling</span>
<span class="sd">            2: perturbation for all atom pairs with scaled</span>
<span class="sd">               interactions. No perturbation for others.</span>

<span class="sd">    ExampleBlock</span>
<span class="sd">    ____________</span>
<span class="sd">    #     NTG   NRDGL    RLAM   DLAMT</span>
<span class="sd">            1   0         0.0     0.0</span>
<span class="sd">    #  ALPHLJ   ALPHC    NLAM  NSCALE</span>
<span class="sd">        0.5     0.5         2       0</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;PERTURBATION&quot;</span>

    <span class="n">NTG</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NRDGL</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">RLAM</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">DLAMT</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">ALPHLJ</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">ALPHC</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">NLAM</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NSCALE</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTG&quot;</span><span class="p">,</span> <span class="s2">&quot;NRDGL&quot;</span><span class="p">,</span> <span class="s2">&quot;RLAM&quot;</span><span class="p">,</span> <span class="s2">&quot;DLAMT&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ALPHLJ&quot;</span><span class="p">,</span> <span class="s2">&quot;ALPHC&quot;</span><span class="p">,</span> <span class="s2">&quot;NLAM&quot;</span><span class="p">,</span> <span class="s2">&quot;NSCALE&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">NTG</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NRDGL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">RLAM</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">DLAMT</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">ALPHLJ</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">ALPHC</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NLAM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NSCALE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTG</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTG</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRDGL</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NRDGL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RLAM</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">RLAM</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DLAMT</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">DLAMT</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ALPHLJ</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ALPHLJ</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ALPHC</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ALPHC</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NLAM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NLAM</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NSCALE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NSCALE</span><span class="p">)</span></div>


<div class="viewcode-block" id="PRECALCLAM"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.PRECALCLAM">[docs]</a><span class="k">class</span> <span class="nc">PRECALCLAM</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTG:    int</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;PRECALCLAM&quot;</span>
    <span class="n">NRLAM</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">MINLAM</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">MAXLAM</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NRLAM&quot;</span><span class="p">,</span> <span class="s2">&quot;MINLAM&quot;</span><span class="p">,</span> <span class="s2">&quot;MAXLAM&quot;</span><span class="p">]]]</span>

<div class="viewcode-block" id="PRECALCLAM.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.PRECALCLAM.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NRLAM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MINLAM</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MAXLAM</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Can be used to caluclate multiple extra lambda values</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        NRLAM: int</span>
<span class="sd">                0  : off</span>
<span class="sd">                &gt;1 : precalculating energies for NRLAM extra lambda values</span>
<span class="sd">        MINLAM</span>
<span class="sd">              between 0 and 1: minimum lambda value to precalculate energies</span>
<span class="sd">        MAXLAM</span>
<span class="sd">            between MINLAM and 1: maximum lambda value to precalculate energies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRLAM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NRLAM</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MINLAM</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">MINLAM</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MAXLAM</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">MAXLAM</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="MULTIBATH"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.MULTIBATH">[docs]</a><span class="k">class</span> <span class="nc">MULTIBATH</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;MULTIBATH Block</span>

<span class="sd">        This block controls the Thermostat of a simulation. Multiple temperature baths can be coupled.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    ALGORITHM:  int</span>
<span class="sd">        temperature coupling algorithm</span>
<span class="sd">        weak-coupling(0)</span>
<span class="sd">        nose-hoover(1)</span>
<span class="sd">        nose-hoover-chains(2)	num</span>
<span class="sd">        (where num is the number of chains to use)</span>
<span class="sd">    NUM: int, optional</span>
<span class="sd">        Mumber of chains in Nosé Hoover chains scheme [only specify when needed]</span>
<span class="sd">    NBATHS: int</span>
<span class="sd">        Number of temperature baths</span>
<span class="sd">    TEMP0:  List[float]</span>
<span class="sd">        temperature of each bath (list len == NBATHS)</span>
<span class="sd">    TAU:    List[float]</span>
<span class="sd">            coupling of the temperaturebath to the system  (list len == NBATHS)</span>
<span class="sd">    DOFSET: int</span>
<span class="sd">        Number of set of Degrees of freedom.</span>
<span class="sd">    LAST:   List[int]   (list len == DOFSET)</span>
<span class="sd">        Last atoms of each DOFSet</span>
<span class="sd">    COMBATH:    List[int]   (list len == DOFSET)</span>
<span class="sd">        Index of the temperature baths</span>
<span class="sd">    IRBATH: List[int]   (list len == DOFSET)</span>
<span class="sd">        IRBAHT?</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">        _generic_imd_block, _generic_gromos_block</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;MULTIBATH&quot;</span>

    <span class="n">ALGORITHM</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NUM</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NBATHS</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">TEMP0</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">TAU</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">DOFSET</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">LAST</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">COMBATH</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">IRBATH</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>

    <span class="n">_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;ALGORITHM&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NUM&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NBATHS&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;TEMP0(1 ... NBATHS)&quot;</span><span class="p">,</span> <span class="s2">&quot;TAU(1 ... NBATHS)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;DOFSET&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;LAST(1 ... DOFSET)&quot;</span><span class="p">,</span> <span class="s2">&quot;COMBATH(1 ... DOFSET)&quot;</span><span class="p">,</span> <span class="s2">&quot;IRBATH(1 ... DOFSET)&quot;</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>
    <span class="c1"># num is not part of the imd file!?</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ALGORITHM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NBATHS</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">TEMP0</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">TAU</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">DOFSET</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">LAST</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">COMBATH</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">IRBATH</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">NUM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ALGORITHM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ALGORITHM</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NUM</span> <span class="o">=</span> <span class="n">NUM</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NBATHS</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NBATHS</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TEMP0</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">TEMP0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TAU</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">TAU</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DOFSET</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">DOFSET</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LAST</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">LAST</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COMBATH</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">COMBATH</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IRBATH</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">IRBATH</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">TEMP0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">TAU</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Warning in MULTIBATH block. There must be the same number of TEMP0 and TAU parameters&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">TEMP0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">NBATHS</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Warning in MULTIBATH block. There must be the same number of BATHS and TEMP0 parameters&quot;</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">TEMP0</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">NBATHS</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">LAST</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">NBATHS</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Warning in MULTIBATH block. There must be the same number of BATHS and LAST parameters&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">LAST</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">COMBATH</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;Warning in MULTIBATH block. There must be the same number of COMBATH and LAST parameters.&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">LAST</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">IRBATH</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Warning in MULTIBATH block. There must be the same number of IRBATH and LAST parameters&quot;</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

<div class="viewcode-block" id="MULTIBATH.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.MULTIBATH.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">if</span> <span class="s2">&quot;NUM&quot;</span> <span class="ow">in</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>

            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">TEMP0</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">TAU</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Read in the temperatures of each temp bath</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">NBATHS</span><span class="p">):</span>
                <span class="n">fields</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                <span class="n">TEMP0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">TAU</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;TEMP0&quot;</span><span class="p">,</span> <span class="n">TEMP0</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;TAU&quot;</span><span class="p">,</span> <span class="n">TAU</span><span class="p">)</span>
            <span class="c1"># Read in DOFSET</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">NBATHS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>

            <span class="n">LAST</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">COMBATH</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">IRBATH</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Read in the last atoms of each temp bath</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">NBATHS</span><span class="p">,</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">NBATHS</span><span class="p">):</span>
                <span class="n">fields</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                <span class="n">LAST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">COMBATH</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">IRBATH</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">,</span> <span class="n">LAST</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;COMBATH&quot;</span><span class="p">,</span> <span class="n">COMBATH</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;IRBATH&quot;</span><span class="p">,</span> <span class="n">IRBATH</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Could not parse &quot;</span> <span class="o">+</span> <span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot; block!</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">args</span><span class="p">))</span></div>

<div class="viewcode-block" id="MULTIBATH.adapt_multibath"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.MULTIBATH.adapt_multibath">[docs]</a>    <span class="k">def</span> <span class="nf">adapt_multibath</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">last_atoms_bath</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">algorithm</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">T</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">TAU</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adapt_multibath</span>
<span class="sd">                This function is adding each atom set into a single multibath.</span>
<span class="sd">                #TODO implementation not correct with com_bath and irbath! Works for super simple cases though</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        last_atoms_bath :   Dict[int,int]</span>
<span class="sd">            lastatom:bath</span>
<span class="sd">        algorithm : int</span>
<span class="sd">            int code for algorihtm</span>
<span class="sd">        T : float,List[float], optional</span>
<span class="sd">            temperature value</span>
<span class="sd">        TAU :   float, optional</span>
<span class="sd">            coupling var</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">T</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">TEMP0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">T_test</span> <span class="k">for</span> <span class="n">T_test</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEMP0</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Temperatures are not the same, this is not implemented in adapt multibath!&quot;</span><span class="p">)</span>
            <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEMP0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TEMP0</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEMP0</span><span class="p">))]</span>

        <span class="k">if</span> <span class="n">TAU</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">TAU</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">T_test</span> <span class="k">for</span> <span class="n">T_test</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TAU</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Temperatures are not the same, this is not implemented in adapt multibath!&quot;</span><span class="p">)</span>

            <span class="n">TAU</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TAU</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TAU</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">TAU</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TAU</span><span class="p">))]</span>

        <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ALGORITHM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">num</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NUM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

        <span class="c1"># print(&quot;MBATH&quot;)</span>
        <span class="c1"># print(last_atoms_bath)</span>
        <span class="c1"># print(&quot;\n&quot;)</span>
        <span class="c1"># print(last_atoms_bath.values())</span>
        <span class="c1"># print(&quot;\n&quot;)</span>
        <span class="c1"># print(set(last_atoms_bath.values()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NBATHS</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">last_atoms_bath</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DOFSET</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">last_atoms_bath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LAST</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">last_atom</span><span class="p">)</span> <span class="k">for</span> <span class="n">last_atom</span> <span class="ow">in</span> <span class="n">last_atoms_bath</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COMBATH</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">last_atoms_bath</span><span class="p">[</span><span class="n">last_atom</span><span class="p">])</span> <span class="k">for</span> <span class="n">last_atom</span> <span class="ow">in</span> <span class="n">last_atoms_bath</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IRBATH</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">last_atoms_bath</span><span class="p">[</span><span class="n">last_atom</span><span class="p">])</span> <span class="k">for</span> <span class="n">last_atom</span> <span class="ow">in</span> <span class="n">last_atoms_bath</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NBATHS</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEMP0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TEMP0</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEMP0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NBATHS</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TAU</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TAU</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NBATHS</span><span class="p">)]</span></div>

<div class="viewcode-block" id="MULTIBATH.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.MULTIBATH.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ALGORITHM</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ALGORITHM</span> <span class="o">==</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NUM</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;You need to specify the NUM parameter for MULTIBATH if ALGORITHM is 2!&quot;</span><span class="p">)</span>

            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NUM</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NBATHS</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEMP0</span><span class="p">)):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEMP0</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TAU</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">]))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DOFSET</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAST</span><span class="p">)):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;  &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LAST</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMBATH</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IRBATH</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="PRESSURESCALE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.PRESSURESCALE">[docs]</a><span class="k">class</span> <span class="nc">PRESSURESCALE</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;PRESSURESCALE Block</span>
<span class="sd">    This block controls the barostat of the simulation</span>

<span class="sd">    Attributes</span>
<span class="sd">    -----------</span>
<span class="sd">    COUPLE: int</span>
<span class="sd">        off(0), calc(1), scale(2)</span>
<span class="sd">    SCALE:  int</span>
<span class="sd">        off(0), iso(1), aniso(2), full(3), semianiso(4)</span>
<span class="sd">    COMP:   float</span>
<span class="sd">        compessibility</span>
<span class="sd">    TAUP:   float</span>
<span class="sd">        coupling strength</span>
<span class="sd">    VIRIAL: int</span>
<span class="sd">        none(0), atomic(1), group(2)</span>
<span class="sd">    SEMIANISOTROPIC:    List[int]</span>
<span class="sd">        (semianisotropic couplings: X, Y, Z)</span>
<span class="sd">        e.g. 1 1 2: x and y jointly coupled and z separately coupled</span>
<span class="sd">        e.g. 0 0 1: constant area (xy-plane) and z coupled to a bath</span>
<span class="sd">    PRES0:  List[List[float]]</span>
<span class="sd">        reference pressure</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;PRESSURESCALE&quot;</span>

    <span class="n">COUPLE</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">SCALE</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">COMP</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">TAUP</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">VIRIAL</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">SEMIANISOTROPIC</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">PRES0</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[[</span><span class="s2">&quot;COUPLE&quot;</span><span class="p">,</span> <span class="s2">&quot;SCALE&quot;</span><span class="p">,</span> <span class="s2">&quot;COMP&quot;</span><span class="p">,</span> <span class="s2">&quot;TAUP&quot;</span><span class="p">,</span> <span class="s2">&quot;VIRIAL&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;SEMIANISOTROPIC COUPLINGS(X, Y, Z)&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;PRES0(1...3,1...3)&quot;</span><span class="p">]]</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">COUPLE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">SCALE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">COMP</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">TAUP</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">VIRIAL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">SEMIANISOTROPIC</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">PRES0</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COUPLE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">COUPLE</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SCALE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">SCALE</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COMP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">COMP</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TAUP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">TAUP</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">VIRIAL</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">VIRIAL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SEMIANISOTROPIC</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">SEMIANISOTROPIC</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PRES0</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">PRES0</span><span class="p">)</span>

<div class="viewcode-block" id="PRESSURESCALE.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.PRESSURESCALE.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="p">[</span><span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">())]</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;SEMIANISOTROPIC&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">())))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;PRES0&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">[</span><span class="mi">5</span><span class="p">:]])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Could not read string for block &quot;</span> <span class="o">+</span> <span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">args</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="FORCE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.FORCE">[docs]</a><span class="k">class</span> <span class="nc">FORCE</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FORCE Block</span>
<span class="sd">        this Block is controlling the forcefield options. It can turn on and of terms, as well as generate force sub groups for analysis.</span>

<span class="sd">    Attributes</span>
<span class="sd">    -----------</span>
<span class="sd">    BONDS:  bool</span>
<span class="sd">    ANGLES: bool</span>
<span class="sd">    IMPROPER:   bool</span>
<span class="sd">    DIHEDRAL:   bool</span>
<span class="sd">    ELECTROSTATIC:  bool</span>
<span class="sd">    VDW:    bool</span>
<span class="sd">    NEGR:   int</span>
<span class="sd">        Number of Energy subgroups</span>
<span class="sd">    NRE:    List[int]</span>
<span class="sd">        List of last atoms for Energy subgroups. (NRE len == NEGR)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;FORCE&quot;</span>

    <span class="n">BONDS</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">ANGLES</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">IMPROPER</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">DIHEDRAL</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">ELECTROSTATIC</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">VDW</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">NEGR</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NRE</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;BONDS&quot;</span><span class="p">,</span> <span class="s2">&quot;ANGLES&quot;</span><span class="p">,</span> <span class="s2">&quot;IMPROPER&quot;</span><span class="p">,</span> <span class="s2">&quot;DIHEDRAL&quot;</span><span class="p">,</span> <span class="s2">&quot;ELECTROSTATIC&quot;</span><span class="p">,</span> <span class="s2">&quot;VDW&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;NEGR&quot;</span><span class="p">,</span> <span class="s2">&quot;NRE&quot;</span><span class="p">]]]</span>

<div class="viewcode-block" id="FORCE.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.FORCE.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">BONDS</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">ANGLES</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">IMPROPER</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">DIHEDRAL</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">ELECTROSTATIC</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">VDW</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">NEGR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NRE</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            BONDS:</span>
<span class="sd">            ANGLES:</span>
<span class="sd">            IMPROPER:</span>
<span class="sd">            DIHEDRAL:</span>
<span class="sd">            ELECTROSTATIC:</span>
<span class="sd">            VDW:</span>
<span class="sd">            NEGR:</span>
<span class="sd">            NRE (list):</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BONDS</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">BONDS</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ANGLES</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ANGLES</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IMPROPER</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">IMPROPER</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DIHEDRAL</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">DIHEDRAL</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ELECTROSTATIC</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ELECTROSTATIC</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">VDW</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">VDW</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NEGR</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NEGR</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NEGR</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NEGR</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NEGR</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">NRE</span> <span class="o">=</span> <span class="n">NEGR</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">NRE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRE</span> <span class="o">=</span> <span class="n">NRE</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_parse_key_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keyLineNumb</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">contentlines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]):</span>
        <span class="k">if</span> <span class="n">keyLineNumb</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">keyLineNumb</span><span class="p">],</span> <span class="n">contentlines</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="c1"># first bring key to attribute form</span>
                <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clean_key_from_order</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
                <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_to_convert_field</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="n">field</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># NEGR</span>
            <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;NEGR&quot;</span>
            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_to_convert_field</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="n">contentlines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
            <span class="c1"># NRE</span>
            <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;NRE&quot;</span>
            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_to_convert_field</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="n">contentlines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>

<div class="viewcode-block" id="FORCE.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.FORCE.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="p">)</span>
            <span class="k">while</span> <span class="s2">&quot;&quot;</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
                <span class="n">fields</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parse_key_content</span><span class="p">(</span><span class="n">keyLineNumb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">contentlines</span><span class="o">=</span><span class="p">[</span><span class="n">fields</span><span class="p">])</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">:])))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Could not parse FORCE block!</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">args</span><span class="p">))</span></div>

<div class="viewcode-block" id="FORCE.adapt_energy_groups"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.FORCE.adapt_energy_groups">[docs]</a>    <span class="k">def</span> <span class="nf">adapt_energy_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy_groups</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Change the Force groups.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        residues : Dict[int, int]</span>
<span class="sd">            the dictionary contains the forceGroups with the ID of the respective last atom.</span>

<span class="sd">           {forceGroupID: lastAtom} = {1:12, 2:26, 3:128}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NEGR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">energy_groups</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NRE</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">energy_groups</span><span class="p">[</span><span class="n">forceGroupID</span><span class="p">])</span> <span class="k">for</span> <span class="n">forceGroupID</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">energy_groups</span><span class="p">)]</span></div>

    <span class="k">def</span> <span class="nf">__adapt_energy_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residues</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Old REEDS option</span>

<span class="sd">        adapt_energy_groups</span>
<span class="sd">            This method is very &quot;crude&quot; and will put each residue into an own energy group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        residues :  Dict[str, Dict[int, int]]</span>
<span class="sd">            you can get this dict from cnf class.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># set Energy Group ammount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NEGR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">)</span>  <span class="c1"># total ammount of Engergy groups</span>
        <span class="k">if</span> <span class="s2">&quot;SOLV&quot;</span> <span class="ow">in</span> <span class="n">residues</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="s2">&quot;SOLV&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NEGR</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="c1"># make residues sortable,</span>
        <span class="n">dict_m</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">solvent_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;WAT&quot;</span><span class="p">,</span> <span class="s2">&quot;SOLV&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">residues</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">==</span> <span class="nb">dict</span> <span class="ow">and</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_m</span> <span class="ow">and</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">solvent_names</span><span class="p">:</span>
                <span class="n">dict_m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dict_m</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;SOLV&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;SOL&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Found mutliple residues for the same residue id!&quot;</span><span class="p">)</span>

        <span class="c1"># build up NRE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NRE</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dict_m</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">dict_m</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>

        <span class="c1"># add solvents to NRE, but only if there are solvents</span>
        <span class="n">present_solvents</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">residues</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">solvent_names</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">present_solvents</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">residues</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">present_solvents</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NRE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="s2">&quot;SOLV&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="n">count</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">residues</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">present_solvents</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NRE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="s2">&quot;SOLV&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">count</span><span class="p">)</span></div>


<div class="viewcode-block" id="CONSTRAINT"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.CONSTRAINT">[docs]</a><span class="k">class</span> <span class="nc">CONSTRAINT</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CONSTRAINT block</span>
<span class="sd">        This block is controlling constraining the atoms during a simulation.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTC:    int</span>
<span class="sd">    NTCP:   int</span>
<span class="sd">    NTCP0:  int</span>
<span class="sd">    NTCS:   int</span>
<span class="sd">    NTCS0:  int</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;CONSTRAINT&quot;</span>

    <span class="n">NTC</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTCP</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTCP0</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">NTCS</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTCS0</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTC&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;NTCP&quot;</span><span class="p">,</span> <span class="s2">&quot;NTCP0(1)&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;NTCS&quot;</span><span class="p">,</span> <span class="s2">&quot;NTCS0(1)&quot;</span><span class="p">]]]</span>

<div class="viewcode-block" id="CONSTRAINT.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.CONSTRAINT.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">NTC</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NTCP</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NTCP0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NTCS</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NTCS0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            NTC:</span>
<span class="sd">            NTCP:</span>
<span class="sd">            NTCP0:</span>
<span class="sd">            NTCS:</span>
<span class="sd">            NTCS0:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTC</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTC</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTCP</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTCP</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTCP0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">NTCP0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTCS</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTCS</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTCS0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">NTCS0</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PAIRLIST"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.PAIRLIST">[docs]</a><span class="k">class</span> <span class="nc">PAIRLIST</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;PAIRLIST Block</span>

<span class="sd">            This block is controlling the pairlist control.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    ALGORITHM: int</span>
<span class="sd">        standard(0) (gromos96 like pairlist)</span>
<span class="sd">        grid(1) (md++ grid pairlist)</span>
<span class="sd">        grid_cell(2) (creates a mask)</span>
<span class="sd">    NSNB:   int</span>
<span class="sd">        frequency (number of steps) a pairlist is constructed</span>
<span class="sd">    RCUTPL: float</span>
<span class="sd">        short-range cut-off in twin-range</span>
<span class="sd">    RCUTL:  float</span>
<span class="sd">        intermediate-range cut-off in twin-range</span>
<span class="sd">    SIZE:   str, float</span>
<span class="sd">        grid cell size (or auto = 0.5 * RCUTP)</span>
<span class="sd">    TYPE:   str, bool</span>
<span class="sd">        chargegoup(0) (chargegroup based cutoff)</span>
<span class="sd">        atomic(1)     (atom based cutoff)</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;PAIRLIST&quot;</span>

    <span class="n">ALGORITHM</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NSNB</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">RCUTPL</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">RCUTL</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">SIZE</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
    <span class="n">TYPE</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;ALGORITHM&quot;</span><span class="p">,</span> <span class="s2">&quot;NSNB&quot;</span><span class="p">,</span> <span class="s2">&quot;RCUTP&quot;</span><span class="p">,</span> <span class="s2">&quot;RCUTL&quot;</span><span class="p">,</span> <span class="s2">&quot;SIZE&quot;</span><span class="p">,</span> <span class="s2">&quot;TYPE&quot;</span><span class="p">]]]</span>

<div class="viewcode-block" id="PAIRLIST.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.PAIRLIST.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ALGORITHM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NSNB</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">RCUTP</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">RCUTL</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">SIZE</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">TYPE</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            ALGORITHM:</span>
<span class="sd">            NSNB:</span>
<span class="sd">            RCUTP:</span>
<span class="sd">            RCUTL:</span>
<span class="sd">            SIZE:</span>
<span class="sd">            TYPE:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ALGORITHM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ALGORITHM</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NSNB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NSNB</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RCUTP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">RCUTP</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RCUTL</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">RCUTL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span> <span class="o">=</span> <span class="n">SIZE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TYPE</span> <span class="o">=</span> <span class="n">TYPE</span></div></div>


<div class="viewcode-block" id="NONBONDED"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.NONBONDED">[docs]</a><span class="k">class</span> <span class="nc">NONBONDED</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;NONBONDED block</span>

<span class="sd">        This block is controlling the Nonbonded term evaluation</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NLRELE: int</span>
<span class="sd">        1-3 method to handle electrostatic interactions</span>
<span class="sd">        -1 : reaction-field (LSERF compatibility mode)</span>
<span class="sd">        0 : no electrostatic interactions</span>
<span class="sd">        1 : reaction-field</span>
<span class="sd">        2 : Ewald method</span>
<span class="sd">        3 : P3M method</span>
<span class="sd">    APPAK: float</span>
<span class="sd">        &gt;= 0.0 reaction-field inverse Debye screening length</span>
<span class="sd">    RCRF: float</span>
<span class="sd">        &gt;= 0.0 reaction-field radius</span>
<span class="sd">    EPSRF: float</span>
<span class="sd">         = 0.0 || &gt; 1.0 reaction-field permittivity</span>
<span class="sd">    NSLFEXCL: bool</span>
<span class="sd">        contribution of excluded atoms to reaction field false=off/true=on</span>
<span class="sd">    NSHAPE: float</span>
<span class="sd">        -1..10 lattice sum charge-shaping function</span>
<span class="sd">        -1 : gaussian</span>
<span class="sd">        0..10 : polynomial</span>
<span class="sd">    ASHAPE: float</span>
<span class="sd">        &gt; 0.0 width of the lattice sum charge-shaping function</span>
<span class="sd">    NA2CLC: int</span>
<span class="sd">        0..4 controls evaluation of lattice sum A2 term</span>
<span class="sd">        0 : A2 = A2~ = 0</span>
<span class="sd">        1 : A2~ exact, A2 = A2~</span>
<span class="sd">        2 : A2 numerical, A2~ = A2</span>
<span class="sd">        3 : A2~ exact from Ewald or from mesh and atom coords, A2 numerical</span>
<span class="sd">        4 : A2~ averaged from mesh only, A2 numerical</span>
<span class="sd">    TOLA2: float</span>
<span class="sd">         &gt; 0.0 tolerance for numerical A2 evaluation</span>
<span class="sd">    EPSLS: float</span>
<span class="sd">        = 0.0 || &gt; 1.0 lattice sum permittivity (0.0 = tinfoil)</span>
<span class="sd">    NKX, NKY, NKZ: float</span>
<span class="sd">        &gt; 0 maximum absolute Ewald k-vector components</span>
<span class="sd">    KCUT: float</span>
<span class="sd">        &gt; 0.0 Ewald k-space cutoff</span>
<span class="sd">    NGX, NGY, NGZ: float</span>
<span class="sd">        &gt; 0 P3M number of grid points</span>
<span class="sd">    NASORD: int</span>
<span class="sd">        1..5 order of mesh charge assignment function</span>
<span class="sd">    NFDORD: int</span>
<span class="sd">        0..5 order of the mesh finite difference operator</span>
<span class="sd">        0 : ik - differentiation</span>
<span class="sd">        1..5 : finite differentiation</span>
<span class="sd">    NALIAS: float</span>
<span class="sd">        &gt; 0 number of mesh alias vectors considered</span>
<span class="sd">    NSPORD: float</span>
<span class="sd">        order of SPME B-spline functions (not available)</span>
<span class="sd">    NQEVAL: float</span>
<span class="sd">        &gt;= 0 controls accuracy reevaluation</span>
<span class="sd">        0 : do not reevaluate</span>
<span class="sd">        &gt; 0 : evaluate every NQEVAL steps</span>
<span class="sd">    FACCUR: float</span>
<span class="sd">        &gt; 0.0 rms force error threshold to recompute influence function</span>
<span class="sd">    NRDGRD: bool</span>
<span class="sd">        0,1 read influence function</span>
<span class="sd">        0 : calculate influence function at simulation start up</span>
<span class="sd">        1 : read influence function from file (not yet implemented)</span>
<span class="sd">    NWRGRD: bool</span>
<span class="sd">        0,1 write influence function</span>
<span class="sd">        0 : do not write</span>
<span class="sd">        1 : write at the end of the simulation (not yet implemented)</span>
<span class="sd">    NLRLJ: bool</span>
<span class="sd">        0,1 controls long-range Lennard-Jones corrections</span>
<span class="sd">        0 : no corrections</span>
<span class="sd">        1 : do corrections (not yet implemented)</span>
<span class="sd">    SLVDNS: float</span>
<span class="sd">        &gt; 0.0 average solvent density for long-range LJ correction (ignored)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;NONBONDED&quot;</span>

    <span class="n">NLRELE</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">APPAK</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">RCRF</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">EPSRF</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">NSLFEXCL</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">NSHAPE</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">ASHAPE</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">NA2CLC</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">TOLA2</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">EPSLS</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">NKX</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NKY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NKZ</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">KCUT</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">NGX</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NGY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NGZ</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NASORD</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NFDORD</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NALIAS</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NSPORD</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NQEVAL</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">FACCUR</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">NRDGRD</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">NWRGRD</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">NLRLJ</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">SLVDNS</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;NLRELE&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;APPAK&quot;</span><span class="p">,</span> <span class="s2">&quot;RCRF&quot;</span><span class="p">,</span> <span class="s2">&quot;EPSRF&quot;</span><span class="p">,</span> <span class="s2">&quot;NSLFEXCL&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NSHAPE&quot;</span><span class="p">,</span> <span class="s2">&quot;ASHAPE&quot;</span><span class="p">,</span> <span class="s2">&quot;NA2CLC&quot;</span><span class="p">,</span> <span class="s2">&quot;TOLA2&quot;</span><span class="p">,</span> <span class="s2">&quot;EPSLS&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NKX&quot;</span><span class="p">,</span> <span class="s2">&quot;NKY&quot;</span><span class="p">,</span> <span class="s2">&quot;NKZ&quot;</span><span class="p">,</span> <span class="s2">&quot;KCUT&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NGX&quot;</span><span class="p">,</span> <span class="s2">&quot;NGY&quot;</span><span class="p">,</span> <span class="s2">&quot;NGZ&quot;</span><span class="p">,</span> <span class="s2">&quot;NASORD&quot;</span><span class="p">,</span> <span class="s2">&quot;NFDORD&quot;</span><span class="p">,</span> <span class="s2">&quot;NALIAS&quot;</span><span class="p">,</span> <span class="s2">&quot;NSPORD&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NQEVAL&quot;</span><span class="p">,</span> <span class="s2">&quot;FACCUR&quot;</span><span class="p">,</span> <span class="s2">&quot;NRDGRD&quot;</span><span class="p">,</span> <span class="s2">&quot;NWRGRD&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NLRLJ&quot;</span><span class="p">,</span> <span class="s2">&quot;SLVDNS&quot;</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">NLRELE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">APPAK</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">RCRF</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">EPSRF</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NSLFEXCL</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">NSHAPE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">ASHAPE</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NA2CLC</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">TOLA2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">EPSLS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NKX</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NKY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NKZ</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">KCUT</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NGX</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NGY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NGZ</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NASORD</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NFDORD</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NALIAS</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NSPORD</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NQEVAL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">FACCUR</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NRDGRD</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">NWRGRD</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">NLRLJ</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">SLVDNS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NLRELE</span> <span class="o">=</span> <span class="n">NLRELE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">APPAK</span> <span class="o">=</span> <span class="n">APPAK</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RCRF</span> <span class="o">=</span> <span class="n">RCRF</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EPSRF</span> <span class="o">=</span> <span class="n">EPSRF</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NSLFEXCL</span> <span class="o">=</span> <span class="n">NSLFEXCL</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NSHAPE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NSHAPE</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ASHAPE</span> <span class="o">=</span> <span class="n">ASHAPE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NA2CLC</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NA2CLC</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TOLA2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">TOLA2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EPSLS</span> <span class="o">=</span> <span class="n">EPSLS</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NKX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NKX</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NKY</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NKY</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NKZ</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NKZ</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">KCUT</span> <span class="o">=</span> <span class="n">KCUT</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NGX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NGX</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NGY</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NGY</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NGZ</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NGZ</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NASORD</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NASORD</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NFDORD</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NFDORD</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NALIAS</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NALIAS</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NSPORD</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NSPORD</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NQEVAL</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NQEVAL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FACCUR</span> <span class="o">=</span> <span class="n">FACCUR</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRDGRD</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">NRDGRD</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NWRGRD</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">NWRGRD</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NLRLJ</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">NLRLJ</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SLVDNS</span> <span class="o">=</span> <span class="n">SLVDNS</span></div>


<div class="viewcode-block" id="INITIALISE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.INITIALISE">[docs]</a><span class="k">class</span> <span class="nc">INITIALISE</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;INITIALISE block</span>

<span class="sd">        This block controls the Initialisation of a simulation.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTIVEL: bool</span>
<span class="sd">        0,1 controls generation of initial velocities</span>
<span class="sd">        0: read from configuration (default)</span>
<span class="sd">        1: generate from Maxell distribution at temperature TEMPI</span>
<span class="sd">    NTISHK: int</span>
<span class="sd">        0..3 controls shaking of initial configuration</span>
<span class="sd">        0: no intial SHAKE (default)</span>
<span class="sd">        1: initial SHAKE on coordinates only</span>
<span class="sd">        2: initial SHAKE on velocities only</span>
<span class="sd">        3: initial SHAKE on coordinates and velocities</span>
<span class="sd">    NTINHT: bool</span>
<span class="sd">        0,1 controls generation of initial Nose-Hoover chain variables</span>
<span class="sd">        0: read from configuration (default)</span>
<span class="sd">        1: reset variables to zero.</span>
<span class="sd">    NTINHB: bool</span>
<span class="sd">        0,1 controls generation of initial Nose-Hoover (chain) barostat variables</span>
<span class="sd">        0: read from strartup file (if applicable) (default)</span>
<span class="sd">        1: reset variables to zero</span>
<span class="sd">    NTISHI: bool</span>
<span class="sd">        0,1 controls initial setting for lattice shift vectors</span>
<span class="sd">        0: read from configuration (default)</span>
<span class="sd">        1: reset shifts to zero.</span>
<span class="sd">    NTIRTC: bool</span>
<span class="sd">        0,1 controls initial setting of positions and orientations for roto-translational constraints</span>
<span class="sd">        0: read from configuration (default)</span>
<span class="sd">        1: reset based on initial configuraion of startup file</span>
<span class="sd">    NTICOM: int</span>
<span class="sd">        0,1,2 controls initial removal of COM motion</span>
<span class="sd">        0: no initial system COM motion removal (default)</span>
<span class="sd">        1: initial COM translation is removed</span>
<span class="sd">        2: initial COM rotation is removed</span>
<span class="sd">    NTISTI: bool</span>
<span class="sd">        0,1 controls generation of stochastic integrals</span>
<span class="sd">        0: read stochastic integrals and IG from configuration (default)</span>
<span class="sd">        1: set stochastic integrals to zero and use IG from here.</span>
<span class="sd">    IG: int</span>
<span class="sd">        random number generator seed</span>
<span class="sd">    TEMPI:  float</span>
<span class="sd">        initial temperature</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;INITIALISE&quot;</span>

    <span class="n">NTIVEL</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">NTISHK</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTINHT</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">NTINHB</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">NTISHI</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">NTIRTC</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">NTICOM</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTISTI</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">IG</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">TEMPI</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTIVEL&quot;</span><span class="p">,</span> <span class="s2">&quot;NTISHK&quot;</span><span class="p">,</span> <span class="s2">&quot;NTINHT&quot;</span><span class="p">,</span> <span class="s2">&quot;NTINHB&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;NTISHI&quot;</span><span class="p">,</span> <span class="s2">&quot;NTIRTC&quot;</span><span class="p">,</span> <span class="s2">&quot;NTICOM&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;NTISTI&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;IG&quot;</span><span class="p">,</span> <span class="s2">&quot;TEMPI&quot;</span><span class="p">]]]</span>

<div class="viewcode-block" id="INITIALISE.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.INITIALISE.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">NTIVEL</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">NTISHK</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTINHT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">NTINHB</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">NTISHI</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">NTIRTC</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">NTICOM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTISTI</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">IG</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">TEMPI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            NTIVEL:</span>
<span class="sd">            NTISHK:</span>
<span class="sd">            NTINHT:</span>
<span class="sd">            NTINHB:</span>
<span class="sd">            NTISHI:</span>
<span class="sd">            NTIRTC:</span>
<span class="sd">            NTICOM:</span>
<span class="sd">            NTISTI:</span>
<span class="sd">            IG:</span>
<span class="sd">            TEMPI:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTIVEL</span> <span class="o">=</span> <span class="n">NTIVEL</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTISHK</span> <span class="o">=</span> <span class="n">NTISHK</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTINHT</span> <span class="o">=</span> <span class="n">NTINHT</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTINHB</span> <span class="o">=</span> <span class="n">NTINHB</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTISHI</span> <span class="o">=</span> <span class="n">NTISHI</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTIRTC</span> <span class="o">=</span> <span class="n">NTIRTC</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTICOM</span> <span class="o">=</span> <span class="n">NTICOM</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTISTI</span> <span class="o">=</span> <span class="n">NTISTI</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IG</span> <span class="o">=</span> <span class="n">IG</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TEMPI</span> <span class="o">=</span> <span class="n">TEMPI</span></div></div>


<div class="viewcode-block" id="COMTRANSROT"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.COMTRANSROT">[docs]</a><span class="k">class</span> <span class="nc">COMTRANSROT</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;COMTRANSROT block</span>

<span class="sd">    This block controls the center of mass translation and rotation removal. (flying ice cube problem)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    NSCM : int</span>
<span class="sd">        controls system centre-of-mass (com) motion removal</span>
<span class="sd">        0: no com motion removal (default)</span>
<span class="sd">        &lt; 0: com translation and rotation are removed every abs(NSCM) steps.</span>
<span class="sd">        &gt; 0: com translation is removed every NSCM steps.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;COMTRANSROT&quot;</span>

    <span class="n">NSCM</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NSCM&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NSCM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NSCM</span> <span class="o">=</span> <span class="n">NSCM</span></div>


<div class="viewcode-block" id="QMMM"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.QMMM">[docs]</a><span class="k">class</span> <span class="nc">QMMM</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;QMMM Block</span>

<span class="sd">        The QMMM block describes how to treat an embedded QM zone</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTQMMM:    int</span>
<span class="sd">        Define if QM/MM is applied (1) or not (0, default)</span>
<span class="sd">    NTQMSW:    int</span>
<span class="sd">        QM software package to use. Available options are MNDO (0, default), Turbomole (1), DFTB (2), MOPAC (3), ORCA (4), and XTB (5)</span>
<span class="sd">    RCUTQ:     float</span>
<span class="sd">        Cutoff for inclusion of MM charge groups. If the value is 0, all particles are considered.</span>
<span class="sd">    NTWQMMM:   int</span>
<span class="sd">        Write QM/MM related data to special trajectory every NTWQMMM step. Switch off with 0.</span>
<span class="sd">    QMLJ:      int</span>
<span class="sd">        Define if LJ interaction is activated in the QM zone (1) or not (0).</span>
<span class="sd">    MMSCAL:    float</span>
<span class="sd">        Scale MM charges with (2/pi)*atan(x*(r_{mm}-r_{mm})). Values &gt; 0.0 describe the scaling factor, values &lt; 0.0 turn off scaling (default).</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;QMMM&quot;</span>

    <span class="c1"># fields</span>
    <span class="n">NTQMMM</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># Define if QM/MM is applied (1) or not (0, default)</span>
    <span class="n">NTQMSW</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># QM software package to use. Available options are MNDO (0, default), Turbomole (1), DFTB (2), MOPAC (3), ORCA (4), and XTB (5)</span>
    <span class="n">RCUTQ</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># Cutoff for inclusion of MM charge groups. If the value is 0, all particles are considered.</span>
    <span class="n">NTWQMMM</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># Write QM/MM related data to special trajectory every NTWQMMM step. Switch off with 0.</span>
    <span class="n">QMLJ</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># Define if LJ interaction is activated in the QM zone (1) or not (0).</span>
    <span class="n">MMSCAL</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># Scale MM charges with (2/pi)*atan(x*(r_{mm}-r_{mm})). Values &gt; 0.0 describe the scaling factor, values &lt; 0.0 turn off scaling (default).</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTQMMM&quot;</span><span class="p">,</span> <span class="s2">&quot;NTQMSW&quot;</span><span class="p">,</span> <span class="s2">&quot;RCUTQ&quot;</span><span class="p">,</span> <span class="s2">&quot;NTWQMMM&quot;</span><span class="p">,</span> <span class="s2">&quot;QMLJ&quot;</span><span class="p">,</span> <span class="s2">&quot;MMSCAL&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">NTQMMM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTQMSW</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">RCUTQ</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">NTWQMMM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">QMLJ</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">MMSCAL</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTQMMM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTQMMM</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTQMSW</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTQMSW</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RCUTQ</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">RCUTQ</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTWQMMM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTWQMMM</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">QMLJ</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">QMLJ</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MMSCAL</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">MMSCAL</span><span class="p">)</span></div>


<div class="viewcode-block" id="EDS"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.EDS">[docs]</a><span class="k">class</span> <span class="nc">EDS</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;EDS block</span>

<span class="sd">    This block is used in an EDS simulation.</span>

<span class="sd">    Attributes</span>
<span class="sd">    -----------</span>
<span class="sd">    NUMSTATES:  int</span>
<span class="sd">        EDS-States</span>
<span class="sd">    S:  float</span>
<span class="sd">        smoothness parameter</span>
<span class="sd">    EIR:    List[float]</span>
<span class="sd">        energy offsets</span>
<span class="sd">    EDS:    bool, optional</span>
<span class="sd">        turn on EDS_simulation</span>
<span class="sd">    ALPHLJ: float, optional</span>
<span class="sd">    ALPHC:  float, optional</span>
<span class="sd">    FUNCTIONAL: int, optional</span>
<span class="sd">        1: Single s Hamiltonian (default)</span>
<span class="sd">        2: Hamiltonian with NUMSTATES*(NUMSTATES-1)/2 (pairwise) S parameters ==&gt; changes type of S</span>
<span class="sd">        3: Hamiltonian with (NUMSTATES-1) S parameters ==&gt; changes type of S</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;EDS&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ALPHLJ&quot;</span><span class="p">,</span> <span class="s2">&quot;ALPHC&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;FUNCTIONAL FORM&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;NUMSTATES&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;EIR&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">NUMSTATES</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">S</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">EIR</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">EDS</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">ALPHLJ</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">ALPHC</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">FUNCTIONAL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;EDS&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EDS</span> <span class="o">=</span> <span class="n">EDS</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ALPHLJ</span> <span class="o">=</span> <span class="n">ALPHLJ</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ALPHC</span> <span class="o">=</span> <span class="n">ALPHC</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FUNCTIONAL</span> <span class="o">=</span> <span class="n">FUNCTIONAL</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NUMSTATES</span> <span class="o">=</span> <span class="n">NUMSTATES</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="n">S</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EIR</span> <span class="o">=</span> <span class="n">EIR</span>

<div class="viewcode-block" id="EDS.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.EDS.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;EDS&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ALPHLJ&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ALPHC&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;FUNCTIONAL&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;NUMSTATES&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">())))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;EIR&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">content</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">())))</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Could not parse block from str - &quot;</span> <span class="o">+</span> <span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">args</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="DISTANCERES"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.DISTANCERES">[docs]</a><span class="k">class</span> <span class="nc">DISTANCERES</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;DISTANCERES Block&quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;DISTANCERES&quot;</span>

    <span class="n">NTDIR</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTDIRA</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">CDIR</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">DIR0</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">TAUDIR</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">FORCESCALE</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">VDIR</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTWDIR</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTDIR&quot;</span><span class="p">,</span> <span class="s2">&quot;NTDIRA&quot;</span><span class="p">,</span> <span class="s2">&quot;CDIR&quot;</span><span class="p">,</span> <span class="s2">&quot;DIR0&quot;</span><span class="p">,</span> <span class="s2">&quot;TAUDIR&quot;</span><span class="p">,</span> <span class="s2">&quot;FORCESCALE&quot;</span><span class="p">,</span> <span class="s2">&quot;VDIR&quot;</span><span class="p">,</span> <span class="s2">&quot;NTWDIR&quot;</span><span class="p">]]]</span>

<div class="viewcode-block" id="DISTANCERES.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.DISTANCERES.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">NTDIR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTDIRA</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">CDIR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">DIR0</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">TAUDIR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">FORCESCALE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">VDIR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTWDIR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            NTDIR:</span>
<span class="sd">            NTDIRA:</span>
<span class="sd">            CDIR:</span>
<span class="sd">            DIR0:</span>
<span class="sd">            TAUDIR:</span>
<span class="sd">            FORCESCALE:</span>
<span class="sd">            VDIR:</span>
<span class="sd">            NTWDIR:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTDIR</span> <span class="o">=</span> <span class="n">NTDIR</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTDIRA</span> <span class="o">=</span> <span class="n">NTDIRA</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CDIR</span> <span class="o">=</span> <span class="n">CDIR</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DIR0</span> <span class="o">=</span> <span class="n">DIR0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TAUDIR</span> <span class="o">=</span> <span class="n">TAUDIR</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FORCESCALE</span> <span class="o">=</span> <span class="n">FORCESCALE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">VDIR</span> <span class="o">=</span> <span class="n">VDIR</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTWDIR</span> <span class="o">=</span> <span class="n">NTWDIR</span></div></div>


<div class="viewcode-block" id="POSITIONRES"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.POSITIONRES">[docs]</a><span class="k">class</span> <span class="nc">POSITIONRES</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;POSITIONRES block</span>

<span class="sd">        This block allows the managment of the Position Restraints during the Simulation.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTPOR:</span>
<span class="sd">        0..3 controls atom positions re(con)straining.</span>
<span class="sd">        0: no position re(con)straints (default)</span>
<span class="sd">        1: restraining with force constant CPOR</span>
<span class="sd">        2: restraining with force constant CPOR weighted by atomic B-factors</span>
<span class="sd">        3: constraining</span>
<span class="sd">    NTPORB:</span>
<span class="sd">        0,1 controls reading of reference positions and B-factors</span>
<span class="sd">        0: read reference positions from startup file.</span>
<span class="sd">        1: read reference positions and B-factors from special file</span>
<span class="sd">    NTPORS:</span>
<span class="sd">        0,1 controls scaling of reference positions upon pressure scaling</span>
<span class="sd">        0: do not scale reference positions</span>
<span class="sd">        1: scale reference positions</span>
<span class="sd">    CPOR:</span>
<span class="sd">        &gt;= 0 position restraining force constant</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;POSITIONRES&quot;</span>

    <span class="n">NTPOR</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTPORB</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTPORS</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">CPOR</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTPOR&quot;</span><span class="p">,</span> <span class="s2">&quot;NTPORB&quot;</span><span class="p">,</span> <span class="s2">&quot;NTPORS&quot;</span><span class="p">,</span> <span class="s2">&quot;CPOR&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NTPOR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NTPORB</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NTPORS</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">CPOR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTPOR</span> <span class="o">=</span> <span class="n">NTPOR</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTPORB</span> <span class="o">=</span> <span class="n">NTPORB</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTPORS</span> <span class="o">=</span> <span class="n">NTPORS</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CPOR</span> <span class="o">=</span> <span class="n">CPOR</span></div>


<div class="viewcode-block" id="PRINTOUT"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.PRINTOUT">[docs]</a><span class="k">class</span> <span class="nc">PRINTOUT</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;PRINTOUT block</span>

<span class="sd">        This Block manages the output frequency into the .omd/std-out file.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTPR: int</span>
<span class="sd">        print out energies, etc. every NTPR steps</span>
<span class="sd">    NTPP: int</span>
<span class="sd">        =1 perform dihedral angle transition monitoring</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;PRINTOUT&quot;</span>

    <span class="n">NTPR</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTPP</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTPR&quot;</span><span class="p">,</span> <span class="s2">&quot;NTPP&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NTPR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NTPP</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;PRINTOUT&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTPR</span> <span class="o">=</span> <span class="n">NTPR</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTPP</span> <span class="o">=</span> <span class="n">NTPP</span></div>


<div class="viewcode-block" id="ENERGYMIN"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.ENERGYMIN">[docs]</a><span class="k">class</span> <span class="nc">ENERGYMIN</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ENERGYMIN block</span>
<span class="sd">    This block takes care of managing the Energyminimization controls.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTEM:   int</span>
<span class="sd">        controls energy minimisation mode.</span>
<span class="sd">        0: do not do energy minimisation (default)</span>
<span class="sd">        1: steepest-descent minimisation</span>
<span class="sd">        2: Fletcher-Reeves conjugate-gradient minimisation</span>
<span class="sd">        3: Polak-Ribiere conjugate-gradient minimisation</span>
<span class="sd">    NCYC:   int</span>
<span class="sd">        &gt;0 number of steps before resetting the conjugate-gradient search direction</span>
<span class="sd">        =0 reset only if the energy grows in the search direction</span>
<span class="sd">    DELE:   float</span>
<span class="sd">        &gt;0.0 energy threshold for convergence</span>
<span class="sd">        &gt;0.0 (conjugate-gradient) RMS force threshold for convergence</span>
<span class="sd">    DX0:    float</span>
<span class="sd">        &gt;0.0 initial step size</span>
<span class="sd">    DXM:    float</span>
<span class="sd">        &gt;0.0 maximum step size</span>
<span class="sd">    NMIN:   float</span>
<span class="sd">        &gt;0 minimum number of minimisation steps</span>
<span class="sd">    FLIM:   float</span>
<span class="sd">        &gt;=0.0 limit force to maximum value (FLIM &gt; 0.0 is not recommended)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ENERGYMIN&quot;</span>

    <span class="n">NTEM</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NCYC</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">DELE</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">DX0</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">DXM</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">NMIN</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">FLIM</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;NTEM    NCYC    DELE    DX0     DXM   NMIN   FLIM&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">NTEM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NCYC</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">DELE</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">DX0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">DXM</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NMIN</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">FLIM</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTEM</span> <span class="o">=</span> <span class="n">NTEM</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NCYC</span> <span class="o">=</span> <span class="n">NCYC</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DELE</span> <span class="o">=</span> <span class="n">DELE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DX0</span> <span class="o">=</span> <span class="n">DX0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DXM</span> <span class="o">=</span> <span class="n">DXM</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NMIN</span> <span class="o">=</span> <span class="n">NMIN</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FLIM</span> <span class="o">=</span> <span class="n">FLIM</span></div>


<div class="viewcode-block" id="WRITETRAJ"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.WRITETRAJ">[docs]</a><span class="k">class</span> <span class="nc">WRITETRAJ</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;WRITETRAJ</span>

<span class="sd">        The WRITETRAJ Block manages the output frequency of GROMOS. Here you can determine how often a file should be written.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTWX:   int</span>
<span class="sd">        controls writing of coordinate trajectory</span>
<span class="sd">        0: no coordinate trajectory is written (default)</span>
<span class="sd">        &gt;0: write solute and solvent coordinates every NTWX steps</span>
<span class="sd">        &lt;0: write solute coordinates every |NTWX| steps</span>
<span class="sd">    NTWSE:   int</span>
<span class="sd">        &gt;= 0 selection criteria for coordinate trajectory writing</span>
<span class="sd">        0: write normal coordinate trajectory</span>
<span class="sd">        &gt;0: write minimum-energy coordinate and energy trajectory (based on the</span>
<span class="sd">        energy entry selected by NTWSE and as blocks of length NTWX)</span>
<span class="sd">        (see configuration/energy.cc or ene_ana library for indices)</span>
<span class="sd">    NTWV:   int</span>
<span class="sd">        controls writing of velocity trajectory</span>
<span class="sd">        0: no velocity trajectory is written (default)</span>
<span class="sd">        &gt;0: write solute and solvent velocities every NTWV steps</span>
<span class="sd">        &lt;0: write solute velocities every |NTWV| steps</span>
<span class="sd">    NTWF:   int</span>
<span class="sd">        controls writing of force trajectory</span>
<span class="sd">        0: no force trajectory is written (default)</span>
<span class="sd">        &gt;0: write solute and solvent forces every NTWF steps</span>
<span class="sd">        &lt;0: write solute forces every |NTWF| steps</span>
<span class="sd">    NTWE:   int</span>
<span class="sd">        &gt;= 0 controls writing of energy trajectory</span>
<span class="sd">        0: no energy trajectory is written (default)</span>
<span class="sd">        &gt;0: write energy trajectory every NTWE steps</span>
<span class="sd">    NTWG:   int</span>
<span class="sd">        &gt;= 0 controls writing of free energy trajectory</span>
<span class="sd">        0: no free energy trajectory is written (default)</span>
<span class="sd">        &gt;0: write free energy trajectory every NTWG steps</span>
<span class="sd">    NTWB:   int</span>
<span class="sd">        &gt;= 0 controls writing of block-averaged energy trajectory</span>
<span class="sd">        0: no block averaged energy trajectory is written (default)</span>
<span class="sd">        &gt;0: write block-averaged energy variables every |NTWB| steps</span>
<span class="sd">            (and free energies if NTWG &gt; 0) trajectory</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;WRITETRAJ&quot;</span>

    <span class="n">NTWX</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTWSE</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTWV</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTWF</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTWE</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTWG</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTWB</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTWX&quot;</span><span class="p">,</span> <span class="s2">&quot;NTWSE&quot;</span><span class="p">,</span> <span class="s2">&quot;NTWV&quot;</span><span class="p">,</span> <span class="s2">&quot;NTWF&quot;</span><span class="p">,</span> <span class="s2">&quot;NTWE&quot;</span><span class="p">,</span> <span class="s2">&quot;NTWG&quot;</span><span class="p">,</span> <span class="s2">&quot;NTWB&quot;</span><span class="p">]]]</span>

<div class="viewcode-block" id="WRITETRAJ.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.WRITETRAJ.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">NTWX</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTWSE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTWV</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTWF</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTWE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTWG</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTWB</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            NTWX:</span>
<span class="sd">            NTWSE:</span>
<span class="sd">            NTWV:</span>
<span class="sd">            NTWF:</span>
<span class="sd">            NTWE:</span>
<span class="sd">            NTWG:</span>
<span class="sd">            NTWB:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTWX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTWX</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTWSE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTWSE</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTWV</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTWV</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTWF</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTWF</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTWE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTWE</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTWG</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTWG</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTWB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTWB</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AMBER"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.AMBER">[docs]</a><span class="k">class</span> <span class="nc">AMBER</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;AMBER block</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    Amber:  bool</span>
<span class="sd">    AMBSCAL:    float</span>



<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;AMBER&quot;</span>

    <span class="n">Amber</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">AMBSCAL</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;AMBER&quot;</span><span class="p">,</span> <span class="s2">&quot;AMBSCAL&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">AMBER</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">AMBSCAL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;AMBER&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AMBER</span> <span class="o">=</span> <span class="n">AMBER</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AMBSCAL</span> <span class="o">=</span> <span class="n">AMBSCAL</span></div>


<div class="viewcode-block" id="COVALENTFORM"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.COVALENTFORM">[docs]</a><span class="k">class</span> <span class="nc">COVALENTFORM</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;COVALENTFORM Block</span>

<span class="sd">        The COVALENTFORM Block manages the functional form of the Bonded contributions to the force field.</span>
<span class="sd">        It is optional in an imd file to define the block.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTBBH:  int</span>
<span class="sd">        0,1 controls bond-stretching potential</span>
<span class="sd">        0: quartic form (default)</span>
<span class="sd">        1: harmonic form</span>
<span class="sd">    NTBAH:  int</span>
<span class="sd">        0,1 controls bond-angle bending potential</span>
<span class="sd">        0: cosine-harmonic (default)</span>
<span class="sd">        1: harmonic</span>
<span class="sd">    NTBDN:  int</span>
<span class="sd">        0,1 controls torsional dihedral potential</span>
<span class="sd">        0: arbitrary phase shifts (default)</span>
<span class="sd">        1: phase shifts limited to 0 and 180 degrees.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;COVALENTFORM&quot;</span>

    <span class="n">NTBBH</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTBAH</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTBDN</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTBBH&quot;</span><span class="p">,</span> <span class="s2">&quot;NTBAH&quot;</span><span class="p">,</span> <span class="s2">&quot;NTBDN&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NTBBH</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NTBAH</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NTBDN</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTBBH</span> <span class="o">=</span> <span class="n">NTBBH</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTBAH</span> <span class="o">=</span> <span class="n">NTBAH</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTBDN</span> <span class="o">=</span> <span class="n">NTBDN</span></div>


<div class="viewcode-block" id="INNERLOOP"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.INNERLOOP">[docs]</a><span class="k">class</span> <span class="nc">INNERLOOP</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;INNERLOOP block</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTILM: int</span>
<span class="sd">    NTILS: int</span>
<span class="sd">    NGPUS: int</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;INNERLOOP&quot;</span>

    <span class="n">NTILM</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTILS</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NGPUS</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTILM&quot;</span><span class="p">,</span> <span class="s2">&quot;NTILS&quot;</span><span class="p">,</span> <span class="s2">&quot;NGPUS&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NTILM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NTILS</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NGPUS</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTILM</span> <span class="o">=</span> <span class="n">NTILM</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTILS</span> <span class="o">=</span> <span class="n">NTILS</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NGPUS</span> <span class="o">=</span> <span class="n">NGPUS</span></div>


<div class="viewcode-block" id="LAMBDA"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.LAMBDA">[docs]</a><span class="k">class</span> <span class="nc">LAMBDA</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LAMBDA block</span>
<span class="sd">        This block is controlling the perturbation for free energy calculations.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    NTIL:   int</span>
<span class="sd">    NTLI(1):   int or List[int]</span>
<span class="sd">    NILG1(1):  int or List[int]</span>
<span class="sd">    NILG2(1):  int or List[int]</span>
<span class="sd">    ALI(1):    float or List[float]</span>
<span class="sd">    BLI(1):    float or List[float]</span>
<span class="sd">    CLI(1):    float or List[float]</span>
<span class="sd">    DLI(1):    float or List[float]</span>
<span class="sd">    ELI(1):    float or List[float]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;LAMBDA&quot;</span>

    <span class="n">NTIL</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTLI</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">NILG1</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">NILG2</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">ALI</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">BLI</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">CLI</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">DLI</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">ELI</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>

    <span class="n">_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;NTIL&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;NTLI(1..)&quot;</span><span class="p">,</span> <span class="s2">&quot;NILG1(1..)&quot;</span><span class="p">,</span> <span class="s2">&quot;NILG2(1..)&quot;</span><span class="p">,</span> <span class="s2">&quot;ALI(1..)&quot;</span><span class="p">,</span> <span class="s2">&quot;BLI(1;;)&quot;</span><span class="p">,</span> <span class="s2">&quot;CLI(1;;)&quot;</span><span class="p">,</span> <span class="s2">&quot;DLI(1;;)&quot;</span><span class="p">,</span> <span class="s2">&quot;ELI(1;;)&quot;</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">NTIL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NTLI</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">NILG1</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">NILG2</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">ALI</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">BLI</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">CLI</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">DLI</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">ELI</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTIL</span> <span class="o">=</span> <span class="n">NTIL</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTLI</span> <span class="o">=</span> <span class="n">NTLI</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NILG1</span> <span class="o">=</span> <span class="n">NILG1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NILG2</span> <span class="o">=</span> <span class="n">NILG2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ALI</span> <span class="o">=</span> <span class="n">ALI</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BLI</span> <span class="o">=</span> <span class="n">BLI</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CLI</span> <span class="o">=</span> <span class="n">CLI</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DLI</span> <span class="o">=</span> <span class="n">DLI</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ELI</span> <span class="o">=</span> <span class="n">ELI</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">NTLI</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">NILG1</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Warning in LAMBDA Block. There must be the same number of NTLI and NILG1 parameters.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">NTLI</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">NILG2</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Warning in LAMBDA Block. There must be the same number of NTLI and NILG2 parameters.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">NTLI</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ALI</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Warning in LAMBDA Block. There must be the same number of NTLI and ALI parameters.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">NTLI</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">BLI</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Warning in LAMBDA Block. There must be the same number of NTLI and BLI parameters.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">NTLI</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">CLI</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Warning in LAMBDA Block. There must be the same number of NTLI and CLI parameters.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">NTLI</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">DLI</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Warning in LAMBDA Block. There must be the same number of NTLI and DLI parameters.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">NTLI</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ELI</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Warning in LAMBDA Block. There must be the same number of NTLI and ELI parameters.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ROTTRANS"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.ROTTRANS">[docs]</a><span class="k">class</span> <span class="nc">ROTTRANS</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Roto-translational block</span>

<span class="sd">        This block is for roto-translational constraints.</span>
<span class="sd">        Note: use either centre of mass removal or roto-translational constraints but not both!</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    RTC: int</span>
<span class="sd">        turn roto-translational constraints on (1)</span>
<span class="sd">    RTCLAST: int</span>
<span class="sd">        last atom of subset to be roto-translationally constrained</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ROTTRANS&quot;</span>

    <span class="n">RTC</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">RTCLAST</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;RTC&quot;</span><span class="p">,</span> <span class="s2">&quot;RTCLAST&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">RTC</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">RTCLAST</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RTC</span> <span class="o">=</span> <span class="n">RTC</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RTCLAST</span> <span class="o">=</span> <span class="n">RTCLAST</span></div>


<div class="viewcode-block" id="RANDOMNUMBERS"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.imd_blocks.RANDOMNUMBERS">[docs]</a><span class="k">class</span> <span class="nc">RANDOMNUMBERS</span><span class="p">(</span><span class="n">_generic_imd_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Random Numbers Block</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;RANDOMNUMBERS&quot;</span>

    <span class="n">NTRNG</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTGSL</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">_order</span> <span class="o">=</span> <span class="p">[[[</span><span class="s2">&quot;NTRNG&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;NTGSL&quot;</span><span class="p">]]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NTRNG</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NTGSL</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTRNG</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTRNG</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTGSL</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NTGSL</span><span class="p">)</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Benjamin Ries, Marc Lehner, Salome Rieder. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.3.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>