

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>pygromos.files.blocks.topology_blocks &mdash; PyGromosTools  documentation</title>








  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>


      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>

    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>




  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
</head>

<body class="wy-body-for-nav">


  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



            <a href="../../../../index.html" class="icon icon-home"> PyGromosTools



          </a>







<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">






              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Welcome to PyGromosTools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html#define-file-paths">define file paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html#build-gromos-system">Build gromos System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html#run-emin">Run Emin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../_source/modules.html">Documentation</a></li>
</ul>



        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


      <nav class="wy-nav-top" aria-label="top navigation">

          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">PyGromosTools</a>

      </nav>


      <div class="wy-nav-content">

        <div class="rst-content">

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">

      <li><a href="../../../../index.html">Docs</a> &raquo;</li>

          <li><a href="../../../index.html">Module code</a> &raquo;</li>

          <li><a href="../blocks.html">pygromos.files.blocks</a> &raquo;</li>

      <li>pygromos.files.blocks.topology_blocks</li>


      <li class="wy-breadcrumbs-aside">

      </li>

  </ul>


  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <h1>Source code for pygromos.files.blocks.topology_blocks</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="kn">from</span> <span class="nn">pygromos.files.blocks._general_blocks</span> <span class="kn">import</span> <span class="n">TITLE</span> <span class="k">as</span> <span class="n">generic_TITLE</span>
<span class="kn">from</span> <span class="nn">pygromos.files.blocks._general_blocks</span> <span class="kn">import</span> <span class="n">_generic_gromos_block</span><span class="p">,</span> <span class="n">_iterable_gromos_block</span><span class="p">,</span> <span class="n">_generic_field</span>
<span class="kn">from</span> <span class="nn">pygromos.utils.typing</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Union</span><span class="p">,</span>
    <span class="n">Iterable</span><span class="p">,</span>
    <span class="n">List</span><span class="p">,</span>
    <span class="n">Tuple</span><span class="p">,</span>
    <span class="n">Dict</span><span class="p">,</span>
    <span class="n">Number</span><span class="p">,</span>
    <span class="n">_topology_table_block_Type</span><span class="p">,</span>
    <span class="n">_iterable_topology_block_Type</span><span class="p">,</span>
    <span class="n">PHYSICALCONSTANTS_Type</span><span class="p">,</span>
    <span class="n">TOPVERSION_Type</span><span class="p">,</span>
    <span class="n">ATOMTYPENAME_Type</span><span class="p">,</span>
    <span class="n">RESNAME_Type</span><span class="p">,</span>
<span class="p">)</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   ENUMS</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="distant_Restraint_Type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.distant_Restraint_Type">[docs]</a><span class="k">class</span> <span class="nc">distant_Restraint_Type</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">half_harmonic_repulsive</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">full_harmonic_distance_restraint</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">half_harmonic_attractive</span> <span class="o">=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="geometric_code"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.geometric_code">[docs]</a><span class="k">class</span> <span class="nc">geometric_code</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">real_atom</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">virtual_H_atom_aliphaticC</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">virtual_H_atom_aromaticC</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">virtual_H_atoms_goc_aliph</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">virtual_H_atom_aliphaticC_strange</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">pseudo_H_atom_goc_H_atoms_CH3</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">pseudo_H_atoms_goc_of_two_CH3</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">pseudo_H_atoms_goc_of_three_CH3</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">virtual_atoms_cog</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">virtual_atoms_com</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span></div>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   FIELDS</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="atom_pair_distanceRes"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.atom_pair_distanceRes">[docs]</a><span class="k">class</span> <span class="nc">atom_pair_distanceRes</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="atom_pair_distanceRes.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.atom_pair_distanceRes.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">i1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">j1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">k1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">l1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">type1</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">geometric_code</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">i2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">j2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">k2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">l2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">type2</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">geometric_code</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">r0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">w0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">rah</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">distant_Restraint_Type</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        i1 :    int</span>
<span class="sd">            id of atom i of first molecule</span>
<span class="sd">        j1 : int</span>
<span class="sd">            id of atom j of first molecule</span>
<span class="sd">        k1 : int</span>
<span class="sd">            id of atom k of first molecule</span>
<span class="sd">        l1 : int</span>
<span class="sd">             id of atom l of first molecule</span>
<span class="sd">        type1 : int</span>
<span class="sd">            geometric restraintype of first molecule</span>
<span class="sd">        i2 : int</span>
<span class="sd">            id of atom i of second molecule</span>
<span class="sd">        j2 : int</span>
<span class="sd">            id of atom j of second molecule</span>
<span class="sd">        k2 : int</span>
<span class="sd">            id of atom k of second molecule</span>
<span class="sd">        l2 : int</span>
<span class="sd">            id of atom l of second molecule</span>
<span class="sd">        type2 : int</span>
<span class="sd">            geometric restraintype of second molecule</span>
<span class="sd">        r0 :    float</span>
<span class="sd">            radius_0 of restraint</span>
<span class="sd">        w0 :    float</span>
<span class="sd">            weighting of restraint</span>
<span class="sd">        rah : int</span>
<span class="sd">            restraint_type</span>
<span class="sd">        comment :   str, optional</span>
<span class="sd">            comment for this restraint</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom1i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom1j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">j1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom1k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">k1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom1l</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">type1</span><span class="p">)</span> <span class="ow">is</span> <span class="n">geometric_code</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom1ic</span> <span class="o">=</span> <span class="n">type1</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">type1</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">type1</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">type1</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom1ic</span> <span class="o">=</span> <span class="n">geometric_code</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">type1</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;geometric index.rst atom1ic in atom_pair_distanceRes unknown</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">type1</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">atom2i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom2j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">j2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom2k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">k2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom2l</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">type2</span><span class="p">)</span> <span class="ow">is</span> <span class="n">geometric_code</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom2ic</span> <span class="o">=</span> <span class="n">type2</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">type2</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">type2</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">type2</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom2ic</span> <span class="o">=</span> <span class="n">geometric_code</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">type2</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;geometric index.rst atom2ic in atom_pair_distanceRes unknown</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">type2</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">radius_0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">r0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">rah</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rah</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">rah</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disResType</span> <span class="o">=</span> <span class="n">distant_Restraint_Type</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rah</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">rah</span><span class="p">)</span> <span class="ow">is</span> <span class="n">distant_Restraint_Type</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disResType</span> <span class="o">=</span> <span class="n">rah</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;DisresType in atom_pair_distanceRes unknown</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rah</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;COULD NOT convert a parameter for distancerestraint field into correct form!&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="atom_pair_distanceRes.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.atom_pair_distanceRes.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2">    </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2">  </span><span class="si">{:10.5f}</span><span class="s2"> </span><span class="si">{:10.5f}</span><span class="s2"> </span><span class="si">{:&gt;3}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom1i</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom1j</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom1k</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom1l</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom1ic</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom2i</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom2j</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom2k</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom2l</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom2ic</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">radius_0</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disResType</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span></div></div>


<div class="viewcode-block" id="atom_mass_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.atom_mass_type">[docs]</a><span class="k">class</span> <span class="nc">atom_mass_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ATMAS</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ATMASN</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ATMAS</span> <span class="o">=</span> <span class="n">ATMAS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ATMASN</span> <span class="o">=</span> <span class="n">ATMASN</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>

<div class="viewcode-block" id="atom_mass_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.atom_mass_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;3.4f}</span><span class="s2"> </span><span class="si">{:&lt;5}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ATMAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ATMASN</span><span class="p">)</span></div></div>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    BONDED TERM BLOCKS</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="bond_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.bond_type">[docs]</a><span class="k">class</span> <span class="nc">bond_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="bond_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.bond_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ICB</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">CB</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">HB</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">B0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">atomI</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">atomJ</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">specialNumber</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS bond-stretching parameters for one possible bond</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ICB: int</span>
<span class="sd">            Bond type code</span>
<span class="sd">        CB: float</span>
<span class="sd">            Quartic bond-stretch force constant</span>
<span class="sd">        HB: float</span>
<span class="sd">            Harmonic bond-stretch force constant</span>
<span class="sd">        B0: float</span>
<span class="sd">            Ideal bond length</span>
<span class="sd">        atomI: str, Iterable[str]</span>
<span class="sd">            possible atom I useages</span>
<span class="sd">        atomJ: str, Iterable[str]</span>
<span class="sd">            possible atom J useages</span>
<span class="sd">        specialNumber: int</span>
<span class="sd">            No Idea @Todo: refactor later!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICB</span> <span class="o">=</span> <span class="n">ICB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CB</span> <span class="o">=</span> <span class="n">CB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HB</span> <span class="o">=</span> <span class="n">HB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B0</span> <span class="o">=</span> <span class="n">B0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomI</span> <span class="o">=</span> <span class="n">atomI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomJ</span> <span class="o">=</span> <span class="n">atomJ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specialNumber</span> <span class="o">=</span> <span class="n">specialNumber</span></div>

<div class="viewcode-block" id="bond_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.bond_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{:&lt;3}</span><span class="s2"> </span><span class="si">{:&lt;1.7f}</span><span class="s2">   </span><span class="si">{:&lt;1.7f}</span><span class="s2">    </span><span class="si">{:&lt;1.7f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ICB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">HB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B0</span>
        <span class="p">)</span>

        <span class="n">atomI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomI</span>
        <span class="n">atomJ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomJ</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atomI</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">atomI</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atomI</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atomJ</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">atomJ</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atomJ</span><span class="p">)</span>

        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;#</span><span class="se">\t</span><span class="si">{:&lt;3}</span><span class="s2"> - </span><span class="si">{:&lt;3}</span><span class="s2">    </span><span class="si">{:&lt;5}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">atomI</span><span class="p">,</span> <span class="n">atomJ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">specialNumber</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="angle_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.angle_type">[docs]</a><span class="k">class</span> <span class="nc">angle_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="angle_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.angle_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ICT</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">CT</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">CHT</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">T0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">atomI</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">atomJ</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">atomK</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">specialNumber</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS bond-stretching parameters for one possible bond</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ICT: int</span>
<span class="sd">            Bond-angle type code</span>
<span class="sd">        CT: float</span>
<span class="sd">            Non-harmonic force constant</span>
<span class="sd">        CHT: float</span>
<span class="sd">            Harmonic force constant</span>
<span class="sd">        T0: float</span>
<span class="sd">            Ideal bond angle</span>
<span class="sd">        atomI: str, Iterable[str]</span>
<span class="sd">            possible atom I useages</span>
<span class="sd">        atomJ: str, Iterable[str]</span>
<span class="sd">            possible atom J useages</span>
<span class="sd">        atomK: str, Iterable[str]</span>
<span class="sd">            possible atom K useages</span>
<span class="sd">        specialNumber: int</span>
<span class="sd">            No Idea @Todo: refactor later!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICT</span> <span class="o">=</span> <span class="n">ICT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CT</span> <span class="o">=</span> <span class="n">CT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CHT</span> <span class="o">=</span> <span class="n">CHT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T0</span> <span class="o">=</span> <span class="n">T0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomI</span> <span class="o">=</span> <span class="n">atomI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomJ</span> <span class="o">=</span> <span class="n">atomJ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomK</span> <span class="o">=</span> <span class="n">atomK</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specialNumber</span> <span class="o">=</span> <span class="n">specialNumber</span></div>

<div class="viewcode-block" id="angle_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.angle_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{:&lt;3}</span><span class="s2"> </span><span class="si">{:&lt;1.7f}</span><span class="s2">   </span><span class="si">{:&lt;1.7f}</span><span class="s2">    </span><span class="si">{:&lt;1.7f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ICT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CHT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>
        <span class="p">)</span>

        <span class="n">atomI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomI</span>
        <span class="n">atomJ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomJ</span>
        <span class="n">atomK</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomK</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atomI</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">atomI</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atomI</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atomJ</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">atomJ</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atomJ</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atomK</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">atomK</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atomK</span><span class="p">)</span>

        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;#</span><span class="se">\t</span><span class="si">{:&lt;3}</span><span class="s2"> - </span><span class="si">{:&lt;3}</span><span class="s2"> - </span><span class="si">{:&lt;3}</span><span class="s2">     </span><span class="si">{:&lt;5}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">atomI</span><span class="p">,</span> <span class="n">atomJ</span><span class="p">,</span> <span class="n">atomK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">specialNumber</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="dihedral_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.dihedral_type">[docs]</a><span class="k">class</span> <span class="nc">dihedral_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="dihedral_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.dihedral_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ICP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">CP</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">PD</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">NP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">atomI</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">atomJ</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">atomK</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">atomL</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">special_number</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">concrete_example</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            GROMOS improper (harmonic) dihedral angle parameters</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ICQ: int</span>
<span class="sd">            Dihedral-angle type code</span>
<span class="sd">        CQ: float</span>
<span class="sd">            Force constant</span>
<span class="sd">        Q0: float</span>
<span class="sd">            Phase shift</span>
<span class="sd">        NP: float</span>
<span class="sd">            Multiplicity</span>
<span class="sd">        atomI: str</span>
<span class="sd">            Examples for atomI</span>
<span class="sd">        atomJ: str</span>
<span class="sd">            Examples for atomJ</span>
<span class="sd">        atomK: str</span>
<span class="sd">            Examples for atomK</span>
<span class="sd">        atomL: str</span>
<span class="sd">            Examples for atomL</span>
<span class="sd">        special_number: int</span>
<span class="sd">            No Idea @Todo: refactor later!</span>
<span class="sd">        concrete_example: str, optional</span>
<span class="sd">            giving a concrete example</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICP</span> <span class="o">=</span> <span class="n">ICP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CP</span> <span class="o">=</span> <span class="n">CP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PD</span> <span class="o">=</span> <span class="n">PD</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NP</span> <span class="o">=</span> <span class="n">NP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomI</span> <span class="o">=</span> <span class="n">atomI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomJ</span> <span class="o">=</span> <span class="n">atomJ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomK</span> <span class="o">=</span> <span class="n">atomK</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomL</span> <span class="o">=</span> <span class="n">atomL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concrete_example</span> <span class="o">=</span> <span class="n">concrete_example</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">special_number</span> <span class="o">=</span> <span class="n">special_number</span></div>

<div class="viewcode-block" id="dihedral_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.dihedral_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{:&lt;3}</span><span class="s2">   </span><span class="si">{:&lt;3.3f}</span><span class="s2">    </span><span class="si">{:&lt;3.3f}</span><span class="s2">   </span><span class="si">{:&lt;3}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ICP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">PD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NP</span><span class="p">)</span>

        <span class="n">atomI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomI</span>
        <span class="n">atomJ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomJ</span>
        <span class="n">atomK</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomK</span>
        <span class="n">atomL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomL</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atomI</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">atomI</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atomI</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atomJ</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">atomJ</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atomJ</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atomK</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">atomK</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atomK</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atomL</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">atomL</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atomL</span><span class="p">)</span>

        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;#</span><span class="se">\t</span><span class="si">{:&lt;3}</span><span class="s2"> - </span><span class="si">{:&lt;3}</span><span class="s2"> - </span><span class="si">{:&lt;3}</span><span class="s2"> - </span><span class="si">{:&lt;3}</span><span class="s2">    </span><span class="si">{:&lt;5}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">atomI</span><span class="p">,</span> <span class="n">atomJ</span><span class="p">,</span> <span class="n">atomK</span><span class="p">,</span> <span class="n">atomL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">special_number</span>
        <span class="p">)</span>
        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;#</span><span class="se">\t</span><span class="si">{:20}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">concrete_example</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="improper_dihedral_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.improper_dihedral_type">[docs]</a><span class="k">class</span> <span class="nc">improper_dihedral_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="improper_dihedral_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.improper_dihedral_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ICQ</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">CQ</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Q0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">group_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">special_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            GROMOS improper (harmonic) dihedral angle parameters</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ICQ: int</span>
<span class="sd">            Improper dihedral-angle type code</span>
<span class="sd">        CQ: float</span>
<span class="sd">            Force constant</span>
<span class="sd">        Q0: float</span>
<span class="sd">            Ideal improper dihedral angle</span>
<span class="sd">        group_type: str</span>
<span class="sd">            Example Useage</span>
<span class="sd">        special_number: int</span>
<span class="sd">            No Idea @Todo: refactor later!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICQ</span> <span class="o">=</span> <span class="n">ICQ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CQ</span> <span class="o">=</span> <span class="n">CQ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q0</span> <span class="o">=</span> <span class="n">Q0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_type</span> <span class="o">=</span> <span class="n">group_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">special_number</span> <span class="o">=</span> <span class="n">special_number</span></div>

<div class="viewcode-block" id="improper_dihedral_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.improper_dihedral_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{:&lt;3}</span><span class="s2"> </span><span class="si">{:&lt;1.7f}</span><span class="s2">    </span><span class="si">{:&lt;1.7f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ICQ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CQ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q0</span><span class="p">)</span>
        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;#</span><span class="se">\t</span><span class="si">{:&lt;3}</span><span class="s2">    </span><span class="si">{:&lt;5}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">special_number</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="single_atom_lj_pair_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.single_atom_lj_pair_type">[docs]</a><span class="k">class</span> <span class="nc">single_atom_lj_pair_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="single_atom_lj_pair_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.single_atom_lj_pair_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">IAC</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">TYPE</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">C6</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">C12_1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">C12_2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">C12_3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">CS6</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">CS12</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">LJ14PAIR</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        IAC: int</span>
<span class="sd">            vander wals type index.rst</span>
<span class="sd">        TYPE: str</span>
<span class="sd">            atom type</span>
<span class="sd">        C6: float</span>
<span class="sd">            square-root of C6</span>
<span class="sd">        C12_2: float</span>
<span class="sd">            square-root of C6</span>
<span class="sd">        C12_3: float</span>
<span class="sd">            square-root of C6</span>
<span class="sd">        CS6: float</span>
<span class="sd">            No Idea @Todo: refactor later!</span>
<span class="sd">        CS12: float</span>
<span class="sd">            No Idea @Todo: refactor later!</span>
<span class="sd">        LJ14PAIR: Iterable[float]</span>
<span class="sd">            No Idea @Todo: refactor later!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IAC</span> <span class="o">=</span> <span class="n">IAC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TYPE</span> <span class="o">=</span> <span class="n">TYPE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C6</span> <span class="o">=</span> <span class="n">C6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C12_1</span> <span class="o">=</span> <span class="n">C12_1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C12_2</span> <span class="o">=</span> <span class="n">C12_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C12_3</span> <span class="o">=</span> <span class="n">C12_3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CS6</span> <span class="o">=</span> <span class="n">CS6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CS12</span> <span class="o">=</span> <span class="n">CS12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LJ14PAIR</span> <span class="o">=</span> <span class="n">LJ14PAIR</span></div>

<div class="viewcode-block" id="single_atom_lj_pair_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.single_atom_lj_pair_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="s2">&quot;#</span><span class="se">\t</span><span class="s2">IAC TYPE C6 C12_1 C12_2 C12_3</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{:&lt;3}</span><span class="s2"> </span><span class="si">{:&lt;3}</span><span class="s2"> </span><span class="si">{:&lt;1.7f}</span><span class="s2">   </span><span class="si">{:&lt;1.7f}</span><span class="s2"> </span><span class="si">{:&lt;1.7f}</span><span class="s2">    </span><span class="si">{:&lt;1.7f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IAC</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TYPE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C12_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C12_2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C12_3</span>
        <span class="p">)</span>
        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;#</span><span class="se">\t</span><span class="s2"> CS6 CS12</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{:&lt;3f}</span><span class="s2"> </span><span class="si">{:&lt;3f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CS6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CS12</span><span class="p">)</span>
        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;#</span><span class="se">\t</span><span class="s2">LJPAIRS</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LJ14PAIR</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;#---</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="mixed_atom_lj_pair_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.mixed_atom_lj_pair_type">[docs]</a><span class="k">class</span> <span class="nc">mixed_atom_lj_pair_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IACI</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">IACJ</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">C6</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">C12_1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">C12_2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">C12_3</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IACI</span> <span class="o">=</span> <span class="n">IACI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IACJ</span> <span class="o">=</span> <span class="n">IACJ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C6</span> <span class="o">=</span> <span class="n">C6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C12_1</span> <span class="o">=</span> <span class="n">C12_1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C12_2</span> <span class="o">=</span> <span class="n">C12_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C12_3</span> <span class="o">=</span> <span class="n">C12_3</span>

<div class="viewcode-block" id="mixed_atom_lj_pair_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.mixed_atom_lj_pair_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{:&lt;3}</span><span class="s2"> </span><span class="si">{:&lt;3}</span><span class="s2"> </span><span class="si">{:&lt;1.7f}</span><span class="s2">   </span><span class="si">{:&lt;1.7f}</span><span class="s2"> </span><span class="si">{:&lt;1.7f}</span><span class="s2">    </span><span class="si">{:&lt;1.7f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IACI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">IACI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C12_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C12_2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C12_3</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="special_atom_lj_pair_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.special_atom_lj_pair_type">[docs]</a><span class="k">class</span> <span class="nc">special_atom_lj_pair_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="special_atom_lj_pair_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.special_atom_lj_pair_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        IAC: int</span>
<span class="sd">            vander wals type index.rst</span>
<span class="sd">        TYPE: str</span>
<span class="sd">            atom type</span>
<span class="sd">        C6: float</span>
<span class="sd">            square-root of C6</span>
<span class="sd">        C12_2: float</span>
<span class="sd">            square-root of C6</span>
<span class="sd">        C12_3: float</span>
<span class="sd">            square-root of C6</span>
<span class="sd">        CS6: float</span>
<span class="sd">            No Idea @Todo: refactor later!</span>
<span class="sd">        CS12: float</span>
<span class="sd">            No Idea @Todo: refactor later!</span>
<span class="sd">        LJ14PAIR: Iterable[float]</span>
<span class="sd">            No Idea @Todo: refactor later!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span></div>

<div class="viewcode-block" id="special_atom_lj_pair_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.special_atom_lj_pair_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{:&lt;3}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NON-BONDED TERM BLOCKS</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">BLOCKS</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># forward declarations</span>
<span class="n">TITLE</span><span class="p">:</span> <span class="n">generic_TITLE</span> <span class="o">=</span> <span class="n">generic_TITLE</span>


<span class="c1"># general Topo Blocks</span>


<div class="viewcode-block" id="FORCEFIELD"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.FORCEFIELD">[docs]</a><span class="k">class</span> <span class="nc">FORCEFIELD</span><span class="p">(</span><span class="n">_generic_gromos_block</span><span class="p">):</span>
    <span class="n">NAME</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NAME</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NAME</span> <span class="o">=</span> <span class="n">NAME</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NAME</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

<div class="viewcode-block" id="FORCEFIELD.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.FORCEFIELD.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;NAME&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NAME</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NAME</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="MAKETOPVERSION"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.MAKETOPVERSION">[docs]</a><span class="k">class</span> <span class="nc">MAKETOPVERSION</span><span class="p">(</span><span class="n">_generic_gromos_block</span><span class="p">):</span>
    <span class="n">VERSION</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">VERSION</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">=</span> <span class="n">VERSION</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

<div class="viewcode-block" id="MAKETOPVERSION.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.MAKETOPVERSION.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<span class="k">class</span> <span class="nc">_topology_block</span><span class="p">(</span><span class="n">_generic_gromos_block</span><span class="p">):</span>
    <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span>
    <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="n">FORCEFIELD</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="n">MAKETOPVERSION</span>


<span class="k">class</span> <span class="nc">_iterable_topology_block</span><span class="p">(</span><span class="n">_iterable_gromos_block</span><span class="p">):</span>
    <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span>
    <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="n">FORCEFIELD</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="n">MAKETOPVERSION</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
        <span class="c1"># return block as string, split by line and cut block title and END</span>
        <span class="n">newContent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">block</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">content</span><span class="o">=</span><span class="n">newContent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">block</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">TOPOLOGY BLOCKS</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Restraints Blocks</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="DISTANCERESSPEC"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.DISTANCERESSPEC">[docs]</a><span class="k">class</span> <span class="nc">DISTANCERESSPEC</span><span class="p">(</span><span class="n">_generic_gromos_block</span><span class="p">):</span>
<div class="viewcode-block" id="DISTANCERESSPEC.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.DISTANCERESSPEC.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">KDISH</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">KDISC</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">RESTRAINTHEADER</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">RESTRAINTS</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        KDISH :</span>
<span class="sd">        KDISC :</span>
<span class="sd">        RESTRAINTHEADER :</span>
<span class="sd">        RESTRAINTS :</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;# KDISH, KDISC</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">KDISH</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">KDISC</span><span class="p">),</span>
                <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">RESTRAINTHEADER</span><span class="p">),</span>
            <span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">RESTRAINTS</span><span class="p">))</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;DISTANCERESSPEC&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="DISTANCERESSPEC.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.DISTANCERESSPEC.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="c1"># readout KDISH or KDISC</span>
        <span class="c1"># keys = content[0].replace(&quot;#&quot;, &quot;&quot;).strip().split()</span>
        <span class="n">KDISH</span><span class="p">,</span> <span class="n">KDISC</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

        <span class="c1"># read list header:</span>
        <span class="n">line_header</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="c1"># unify keys:</span>
        <span class="n">key_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="n">renamed_header</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line_header</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">key_dict</span><span class="p">:</span>
                <span class="n">renamed_header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key_dict</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span>
                <span class="n">key_dict</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">renamed_header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">RESTRAINTHEADER</span> <span class="o">=</span> <span class="n">renamed_header</span>

        <span class="c1"># read restraints</span>
        <span class="n">RESTRAINTS</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">RESTRAINTHEADER</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">RESTRAINTS_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="n">RESTRAINTHEADER</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">RESTRAINTHEADER</span><span class="p">}</span>
                <span class="n">RESTRAINTS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_pair_distanceRes</span><span class="p">(</span><span class="o">**</span><span class="n">RESTRAINTS_dict</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING! could not Read in :&quot;</span> <span class="o">+</span> <span class="n">line</span><span class="p">)</span>
                <span class="k">continue</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">KDISH</span> <span class="o">=</span> <span class="n">KDISH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">KDISC</span> <span class="o">=</span> <span class="n">KDISC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RESTRAINTHEADER</span> <span class="o">=</span> <span class="n">RESTRAINTHEADER</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RESTRAINTS</span> <span class="o">=</span> <span class="n">RESTRAINTS</span></div>

<div class="viewcode-block" id="DISTANCERESSPEC.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.DISTANCERESSPEC.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# KDISH&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;KDISC&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KDISH</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KDISC</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#</span><span class="si">{:&gt;4}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2">    </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2">  </span><span class="si">{:&gt;10}</span><span class="s2"> </span><span class="si">{:&gt;10}</span><span class="s2"> </span><span class="si">{:&gt;3}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">RESTRAINTHEADER</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">RESTRAINTS</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">FORCEFIELD BLOCKS</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">IFP - TYPE Blocks</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="MASSATOMTYPECODE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.MASSATOMTYPECODE">[docs]</a><span class="k">class</span> <span class="nc">MASSATOMTYPECODE</span><span class="p">(</span><span class="n">_iterable_topology_block</span><span class="p">):</span>
    <span class="n">NRMATY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NMATY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;ATMAS&quot;</span><span class="p">,</span> <span class="s2">&quot;ATMASN&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">atom_mass_type</span><span class="p">],</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NRMATY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NMATY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_content</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">atom_mass_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of content: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">NRMATY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRMATY</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NRMATY</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NRMATY</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NRMATY</span> <span class="o">=</span> <span class="n">NRMATY</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN MASSATOMTYPECODE NRMATY is not equal to the ammount of MASSATOMTYPES.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NRMATY: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NRMATY</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">NMATY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NMATY</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">N</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NMATY</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NMATY</span> <span class="o">==</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">N</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">]):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NMATY</span> <span class="o">=</span> <span class="n">NMATY</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN MASSATOMTYPECODE NMATY is not the maximal Mass atom type code.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NMATY: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NMATY</span><span class="p">)))</span>

<div class="viewcode-block" id="MASSATOMTYPECODE.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.MASSATOMTYPECODE.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span>

        <span class="k">if</span> <span class="s2">&quot;NRMATY&quot;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="s2">&quot;NMATY&quot;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">NRMATY</span><span class="p">,</span> <span class="n">NMATY</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>

        <span class="n">table_start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">table_start</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">field</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">]):</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">table_start</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not find the TABLE start in &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">table_start</span><span class="p">:]:</span>
            <span class="n">mass_atom_type_code</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">mass_atom_name</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_mass_type</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">mass_atom_type_code</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">mass</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">mass_atom_name</span><span class="p">)))</span></div>

        <span class="c1"># print(self.content)</span>

<div class="viewcode-block" id="MASSATOMTYPECODE.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.MASSATOMTYPECODE.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NRMATY&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NMATY&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRMATY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NMATY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# TABLE CONTENT: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="BONDSTRETCHTYPECODE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDSTRETCHTYPECODE">[docs]</a><span class="k">class</span> <span class="nc">BONDSTRETCHTYPECODE</span><span class="p">(</span><span class="n">_iterable_topology_block</span><span class="p">):</span>
    <span class="n">NRBTY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NBTY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ICB(H)[N]&quot;</span><span class="p">,</span> <span class="s2">&quot;CB[N]&quot;</span><span class="p">,</span> <span class="s2">&quot;HB[N]&quot;</span><span class="p">,</span> <span class="s2">&quot;B0[N]&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="BONDSTRETCHTYPECODE.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDSTRETCHTYPECODE.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">bond_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NRBTY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NBTY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS bond-stretching parameters</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[atom_mass_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NRBTY : int, optional</span>
<span class="sd">            Number of bond types</span>
<span class="sd">        NBTY : int, optional</span>
<span class="sd">            Number of maximal bond index.rst</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">atom_mass_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of content: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">NRBTY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRBTY</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NRBTY</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NRBTY</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NRBTY</span> <span class="o">=</span> <span class="n">NRBTY</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN MASSATOMTYPECODE NRMATY is not equal to the ammount of MASSATOMTYPES.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NRMATY: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NRBTY</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">NBTY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NBTY</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">ICB</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NBTY</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NBTY</span> <span class="o">==</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">ICB</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">]):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NBTY</span> <span class="o">=</span> <span class="n">NBTY</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN MASSATOMTYPECODE NMATY is not the maximal Mass atom type code.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NMATY: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NBTY</span><span class="p">)))</span></div>

<div class="viewcode-block" id="BONDSTRETCHTYPECODE.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDSTRETCHTYPECODE.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span>

        <span class="n">table_start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">table_start</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">field</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">]):</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">table_start</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not find the TABLE start in &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">table_lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">table_start</span><span class="p">:]</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">table_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ICB</span><span class="p">,</span> <span class="n">CB</span><span class="p">,</span> <span class="n">HB</span><span class="p">,</span> <span class="n">B0</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

                <span class="c1"># nasty next line formatting of gromos</span>
                <span class="n">comment_index</span> <span class="o">=</span> <span class="n">table_lines</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">clean</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;\(.*?\)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">table_lines</span><span class="p">[</span><span class="n">comment_index</span><span class="p">])</span>  <span class="c1"># noqa # flake8: noqa</span>
                <span class="n">split_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">clean</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
                <span class="n">split_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">split_line</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">split_line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">atomI</span><span class="p">,</span> <span class="n">atomJ</span><span class="p">,</span> <span class="n">specialNumber</span> <span class="o">=</span> <span class="n">split_line</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">split_line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">atomI</span><span class="p">,</span> <span class="n">atomJ</span> <span class="o">=</span> <span class="n">split_line</span>
                    <span class="n">specialNumber</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="c1"># generate line</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">bond_type</span><span class="p">(</span>
                    <span class="n">ICB</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">ICB</span><span class="p">),</span>
                    <span class="n">CB</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">CB</span><span class="p">),</span>
                    <span class="n">HB</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">HB</span><span class="p">),</span>
                    <span class="n">B0</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">B0</span><span class="p">),</span>
                    <span class="n">atomI</span><span class="o">=</span><span class="n">atomI</span><span class="p">,</span>
                    <span class="n">atomJ</span><span class="o">=</span><span class="n">atomJ</span><span class="p">,</span>
                    <span class="n">specialNumber</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">specialNumber</span><span class="p">),</span>
                <span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="BONDSTRETCHTYPECODE.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDSTRETCHTYPECODE.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NRBTY&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NBTY&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# TABLE CONTENT: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRBTY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NBTY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="BONDANGLEBENDTYPECODE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLEBENDTYPECODE">[docs]</a><span class="k">class</span> <span class="nc">BONDANGLEBENDTYPECODE</span><span class="p">(</span><span class="n">_iterable_topology_block</span><span class="p">):</span>
    <span class="n">NRTTY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NTTY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ICT(H)[N]&quot;</span><span class="p">,</span> <span class="s2">&quot;CT[N]&quot;</span><span class="p">,</span> <span class="s2">&quot;CHT[N]&quot;</span><span class="p">,</span> <span class="s2">&quot;(T0[N])&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="BONDANGLEBENDTYPECODE.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLEBENDTYPECODE.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">angle_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NRTTY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NTTY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS bond-stretching parameters</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[atom_mass_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NRBTY : int, optional</span>
<span class="sd">            Number of bond types</span>
<span class="sd">        NBTY : int, optional</span>
<span class="sd">            Number of maximal bond index.rst</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">atom_mass_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of content: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">NRTTY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRTTY</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NRTTY</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NRTTY</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NRBTY</span> <span class="o">=</span> <span class="n">NRTTY</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN MASSATOMTYPECODE NRMATY is not equal to the ammount of MASSATOMTYPES.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NRMATY: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NRTTY</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">NTTY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NTTY</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">ICT</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NTTY</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NTTY</span> <span class="o">==</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">ICT</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">]):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NTTY</span> <span class="o">=</span> <span class="n">NTTY</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN MASSATOMTYPECODE NMATY is not the maximal Mass atom type code.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NMATY: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NTTY</span><span class="p">)))</span></div>

<div class="viewcode-block" id="BONDANGLEBENDTYPECODE.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLEBENDTYPECODE.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span>

        <span class="n">table_start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">table_start</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">field</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">]):</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">table_start</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not find the TABLE start in &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">table_lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">table_start</span><span class="p">:]</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">table_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ICT</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">CHT</span><span class="p">,</span> <span class="n">T0</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

                <span class="c1"># nasty next line formatting of gromos</span>
                <span class="n">comment_index</span> <span class="o">=</span> <span class="n">table_lines</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">clean</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;\(.*?\)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">table_lines</span><span class="p">[</span><span class="n">comment_index</span><span class="p">])</span>  <span class="c1"># noqa # flake8: noqa</span>
                <span class="n">split_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">clean</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
                <span class="n">split_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">split_line</span><span class="p">]</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">split_line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">atomI</span><span class="p">,</span> <span class="n">atomJ</span><span class="p">,</span> <span class="n">atomK</span><span class="p">,</span> <span class="n">specialNumber</span> <span class="o">=</span> <span class="n">split_line</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">split_line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">atomI</span><span class="p">,</span> <span class="n">atomJ</span><span class="p">,</span> <span class="n">atomK</span> <span class="o">=</span> <span class="n">split_line</span>
                    <span class="n">specialNumber</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="n">params</span> <span class="o">=</span> <span class="n">angle_type</span><span class="p">(</span>
                    <span class="n">ICT</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">ICT</span><span class="p">),</span>
                    <span class="n">CT</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">CT</span><span class="p">),</span>
                    <span class="n">CHT</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">CHT</span><span class="p">),</span>
                    <span class="n">T0</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">T0</span><span class="p">),</span>
                    <span class="n">atomI</span><span class="o">=</span><span class="n">atomI</span><span class="p">,</span>
                    <span class="n">atomJ</span><span class="o">=</span><span class="n">atomJ</span><span class="p">,</span>
                    <span class="n">atomK</span><span class="o">=</span><span class="n">atomK</span><span class="p">,</span>
                    <span class="n">specialNumber</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">specialNumber</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="BONDANGLEBENDTYPECODE.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLEBENDTYPECODE.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NRTTY&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NTTY&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRTTY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NTTY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# TABLE CONTENT: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="TORSDIHEDRALTYPECODE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.TORSDIHEDRALTYPECODE">[docs]</a><span class="k">class</span> <span class="nc">TORSDIHEDRALTYPECODE</span><span class="p">(</span><span class="n">_iterable_topology_block</span><span class="p">):</span>
    <span class="n">NRPTY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NPTY</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ICP(H)[N]&quot;</span><span class="p">,</span> <span class="s2">&quot;CP[N]&quot;</span><span class="p">,</span> <span class="s2">&quot;PD&quot;</span><span class="p">,</span> <span class="s2">&quot;NP&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="TORSDIHEDRALTYPECODE.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.TORSDIHEDRALTYPECODE.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">dihedral_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NRPTY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NPTY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS (trigonometric) dihedral torsional angle parameters</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[atom_mass_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NRPTY : int, optional</span>
<span class="sd">            Number of dihedral-angle types</span>
<span class="sd">        NPTY : int, optional</span>
<span class="sd">            Number of maximal dihedral-angle index.rst</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">atom_mass_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of content: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">NRPTY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRPTY</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NRPTY</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NRPTY</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NRPTY</span> <span class="o">=</span> <span class="n">NRPTY</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN MASSATOMTYPECODE NRMATY is not equal to the ammount of MASSATOMTYPES.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NRPTY: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NRPTY</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">NPTY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NPTY</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">ICP</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NPTY</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NPTY</span> <span class="o">==</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">ICP</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">]):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NPTY</span> <span class="o">=</span> <span class="n">NPTY</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN MASSATOMTYPECODE NPTY is not the maximal Mass atom type code.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NMATY: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NPTY</span><span class="p">)))</span></div>

<div class="viewcode-block" id="TORSDIHEDRALTYPECODE.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.TORSDIHEDRALTYPECODE.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span>

        <span class="n">table_start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">table_start</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">field</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">]):</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">table_start</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not find the TABLE start in &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">table_lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">table_start</span><span class="p">:]</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">table_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ICP</span><span class="p">,</span> <span class="n">CP</span><span class="p">,</span> <span class="n">PD</span><span class="p">,</span> <span class="n">NP</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

                <span class="c1"># nasty next line formatting of gromos</span>
                <span class="n">comment_index</span> <span class="o">=</span> <span class="n">table_lines</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">clean</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;\(.*?\)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">table_lines</span><span class="p">[</span><span class="n">comment_index</span><span class="p">])</span>  <span class="c1"># noqa # flake8: noqa</span>
                <span class="n">split_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">clean</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
                <span class="c1"># print(&quot;splits&quot;, split_line)</span>

                <span class="n">special_number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">split_line</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="p">(</span><span class="n">split_line</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">())</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="n">atom_dihedral_string</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">split_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)]</span>
                <span class="n">atom_dihedral_string</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">[</span><span class="s2">&quot;X&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span> <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">atom_dihedral_string</span>
                <span class="p">]</span>
                <span class="n">atom_dihedral_string</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">split_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">)]</span>

                <span class="c1"># print(&quot;Atoms-String: &quot;, atom_dihedral_string)</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom_dihedral_string</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">atomI</span><span class="p">,</span> <span class="n">atomJ</span><span class="p">,</span> <span class="n">atomK</span><span class="p">,</span> <span class="n">atomL</span> <span class="o">=</span> <span class="n">atom_dihedral_string</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom_dihedral_string</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">atomI</span><span class="p">,</span> <span class="n">atomJ</span><span class="p">,</span> <span class="n">atomK</span><span class="p">,</span> <span class="n">atomL</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">atom_dihedral_string</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom_dihedral_string</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">atomI</span><span class="p">,</span> <span class="n">atomJ</span><span class="p">,</span> <span class="n">atomK</span><span class="p">,</span> <span class="n">atomL</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">atom_dihedral_string</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># print(atom_dihedral_string)</span>
                    <span class="n">atomI</span><span class="p">,</span> <span class="n">atomJ</span><span class="p">,</span> <span class="n">atomK</span><span class="p">,</span> <span class="n">atomL</span> <span class="o">=</span> <span class="n">atom_dihedral_string</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span>

                <span class="n">concrete_example</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">table_lines</span><span class="p">[</span><span class="n">comment_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="n">table_lines</span><span class="p">[</span><span class="n">comment_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">))</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
                <span class="p">)</span>
                <span class="c1"># print(concrete_example)</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">dihedral_type</span><span class="p">(</span>
                    <span class="n">ICP</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">ICP</span><span class="p">),</span>
                    <span class="n">CP</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">CP</span><span class="p">),</span>
                    <span class="n">PD</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">PD</span><span class="p">),</span>
                    <span class="n">NP</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">NP</span><span class="p">),</span>
                    <span class="n">atomI</span><span class="o">=</span><span class="n">atomI</span><span class="p">,</span>
                    <span class="n">atomJ</span><span class="o">=</span><span class="n">atomJ</span><span class="p">,</span>
                    <span class="n">atomK</span><span class="o">=</span><span class="n">atomK</span><span class="p">,</span>
                    <span class="n">atomL</span><span class="o">=</span><span class="n">atomL</span><span class="p">,</span>
                    <span class="n">special_number</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">special_number</span><span class="p">),</span>
                    <span class="n">concrete_example</span><span class="o">=</span><span class="n">concrete_example</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TORSDIHEDRALTYPECODE.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.TORSDIHEDRALTYPECODE.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NRPTY&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NPTY&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRPTY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NPTY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# TABLE CONTENT: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="IMPDIHEDRALTYPECODE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRALTYPECODE">[docs]</a><span class="k">class</span> <span class="nc">IMPDIHEDRALTYPECODE</span><span class="p">(</span><span class="n">_iterable_topology_block</span><span class="p">):</span>
    <span class="n">NRQTY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NQTY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ICQ&quot;</span><span class="p">,</span> <span class="s2">&quot;CQ&quot;</span><span class="p">,</span> <span class="s2">&quot;Q0&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="IMPDIHEDRALTYPECODE.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRALTYPECODE.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">improper_dihedral_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NRQTY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NQTY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS improper dihedral type parameters</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[atom_mass_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NRQTY : int, optional</span>
<span class="sd">            Number of improperDihedrals types</span>
<span class="sd">        NQTY : int, optional</span>
<span class="sd">            Number of maximal improperDihedrals index.rst</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">atom_mass_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of content: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)))</span>

        <span class="c1"># print(self.content)</span>

        <span class="k">if</span> <span class="n">NRQTY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRQTY</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NRQTY</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NRQTY</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NRQTY</span> <span class="o">=</span> <span class="n">NRQTY</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN MASSATOMTYPECODE NRQTY is not equal to the ammount of MASSATOMTYPES.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NRQTY: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NRQTY</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">NQTY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NQTY</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">ICQ</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NQTY</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NQTY</span> <span class="o">==</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">ICQ</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">]):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NQTY</span> <span class="o">=</span> <span class="n">NQTY</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN MASSATOMTYPECODE NQTY is not the maximal Mass atom type code.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NQTY: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NQTY</span><span class="p">)))</span></div>

<div class="viewcode-block" id="IMPDIHEDRALTYPECODE.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRALTYPECODE.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span>

        <span class="n">table_start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">table_start</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">field</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">]):</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">table_start</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not find the TABLE start in &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">table_lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">table_start</span><span class="p">:]</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">table_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ICQ</span><span class="p">,</span> <span class="n">CQ</span><span class="p">,</span> <span class="n">Q0</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

                <span class="c1"># nasty next line formatting of gromos</span>
                <span class="n">comment_index</span> <span class="o">=</span> <span class="n">table_lines</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">clean</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;\(.*?\)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">table_lines</span><span class="p">[</span><span class="n">comment_index</span><span class="p">])</span>  <span class="c1"># noqa # flake8 ignore</span>
                <span class="n">split_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">clean</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
                <span class="n">split_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">split_line</span><span class="p">]</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">split_line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">groupType</span><span class="p">,</span> <span class="n">special_number</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">split_line</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="n">split_line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">split_line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">groupType</span> <span class="o">=</span> <span class="n">split_line</span>
                    <span class="n">special_number</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="n">params</span> <span class="o">=</span> <span class="n">improper_dihedral_type</span><span class="p">(</span>
                    <span class="n">ICQ</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">ICQ</span><span class="p">),</span> <span class="n">CQ</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">CQ</span><span class="p">),</span> <span class="n">Q0</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">Q0</span><span class="p">),</span> <span class="n">group_type</span><span class="o">=</span><span class="n">groupType</span><span class="p">,</span> <span class="n">special_number</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">special_number</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="IMPDIHEDRALTYPECODE.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRALTYPECODE.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NRQTY&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NQTY&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRQTY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NQTY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# TABLE CONTENT: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="SINGLEATOMLJPAIR"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SINGLEATOMLJPAIR">[docs]</a><span class="k">class</span> <span class="nc">SINGLEATOMLJPAIR</span><span class="p">(</span><span class="n">_iterable_topology_block</span><span class="p">):</span>
    <span class="n">NRATT</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;IAC&quot;</span><span class="p">,</span> <span class="s2">&quot;TYPE&quot;</span><span class="p">,</span> <span class="s2">&quot;C6&quot;</span><span class="p">,</span> <span class="s2">&quot;C12(1)&quot;</span><span class="p">,</span> <span class="s2">&quot;C12(2)&quot;</span><span class="p">,</span> <span class="s2">&quot;C12(3)&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="SINGLEATOMLJPAIR.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SINGLEATOMLJPAIR.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">NRATT</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content</span>
<span class="sd">        NRATT</span>
<span class="sd">        FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">atom_mass_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of content: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">NRATT</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRATT</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NRATT</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NRATT</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NRATT</span> <span class="o">=</span> <span class="n">NRATT</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN number of terms NRATT is not equal to the ammount of terms.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NRATT: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NRATT</span><span class="p">)))</span></div>

<div class="viewcode-block" id="SINGLEATOMLJPAIR.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SINGLEATOMLJPAIR.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span>

        <span class="n">table_start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">table_start</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">field</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">]):</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">table_start</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not find the TABLE start in &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">table_lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">table_start</span><span class="p">:]</span>
        <span class="n">subblock_end</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">end_string</span> <span class="o">=</span> <span class="s2">&quot;#--&quot;</span>
        <span class="k">for</span> <span class="n">subblock_start</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table_lines</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">subblock_start</span> <span class="o">&gt;=</span> <span class="n">subblock_end</span><span class="p">:</span>
                <span class="c1"># print(&quot;START: &quot;, field)</span>
                <span class="n">IAC</span><span class="p">,</span> <span class="n">TYPE</span><span class="p">,</span> <span class="n">C6</span><span class="p">,</span> <span class="n">C12_1</span><span class="p">,</span> <span class="n">C12_2</span><span class="p">,</span> <span class="n">C12_3</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">IAC</span><span class="p">,</span> <span class="n">TYPE</span><span class="p">,</span> <span class="n">C6</span><span class="p">,</span> <span class="n">C12_1</span><span class="p">,</span> <span class="n">C12_2</span><span class="p">,</span> <span class="n">C12_3</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">IAC</span><span class="p">),</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">C6</span><span class="p">),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">C12_1</span><span class="p">),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">C12_2</span><span class="p">),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">C12_3</span><span class="p">),</span>
                <span class="p">]</span>
                <span class="n">LJ14PAIR</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="n">subblock_lines</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">secondCS</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">subblock_line</span> <span class="ow">in</span> <span class="n">table_lines</span><span class="p">[</span><span class="n">subblock_start</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]:</span>
                    <span class="n">subblock_lines</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c1"># print(subblock_line)</span>
                    <span class="k">if</span> <span class="n">end_string</span> <span class="ow">in</span> <span class="n">subblock_line</span><span class="p">:</span>
                        <span class="n">subblock_end</span> <span class="o">=</span> <span class="n">subblock_start</span> <span class="o">+</span> <span class="n">subblock_lines</span>
                        <span class="k">break</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">subblock_line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">secondCS</span><span class="p">:</span>
                        <span class="n">CS6</span><span class="p">,</span> <span class="n">CS12</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">subblock_line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                        <span class="n">secondCS</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">subblock_line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">subblock_lines</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">LJ14PAIR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">subblock_line</span><span class="o">.</span><span class="n">split</span><span class="p">())))</span>

                <span class="n">params</span> <span class="o">=</span> <span class="n">single_atom_lj_pair_type</span><span class="p">(</span>
                    <span class="n">IAC</span><span class="o">=</span><span class="n">IAC</span><span class="p">,</span>
                    <span class="n">TYPE</span><span class="o">=</span><span class="n">TYPE</span><span class="p">,</span>
                    <span class="n">C6</span><span class="o">=</span><span class="n">C6</span><span class="p">,</span>
                    <span class="n">C12_1</span><span class="o">=</span><span class="n">C12_1</span><span class="p">,</span>
                    <span class="n">C12_2</span><span class="o">=</span><span class="n">C12_2</span><span class="p">,</span>
                    <span class="n">C12_3</span><span class="o">=</span><span class="n">C12_3</span><span class="p">,</span>
                    <span class="n">CS6</span><span class="o">=</span><span class="n">CS6</span><span class="p">,</span>
                    <span class="n">CS12</span><span class="o">=</span><span class="n">CS12</span><span class="p">,</span>
                    <span class="n">LJ14PAIR</span><span class="o">=</span><span class="n">LJ14PAIR</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="c1"># print(params)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="SINGLEATOMLJPAIR.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SINGLEATOMLJPAIR.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NRATT&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRATT</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# TABLE CONTENT: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="MIXEDATOMLJPAIR"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.MIXEDATOMLJPAIR">[docs]</a><span class="k">class</span> <span class="nc">MIXEDATOMLJPAIR</span><span class="p">(</span><span class="n">_iterable_topology_block</span><span class="p">):</span>
    <span class="n">NRMTT</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;IACI&quot;</span><span class="p">,</span> <span class="s2">&quot;IACJ&quot;</span><span class="p">,</span> <span class="s2">&quot;C6&quot;</span><span class="p">,</span> <span class="s2">&quot;C12_1&quot;</span><span class="p">,</span> <span class="s2">&quot;C12_2&quot;</span><span class="p">,</span> <span class="s2">&quot;C12_3&quot;</span><span class="p">]</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        GROMOS 43A1 normal van der Waals parameters for mixed atom type pairs (I,J)</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="MIXEDATOMLJPAIR.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.MIXEDATOMLJPAIR.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">NRMTT</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content</span>
<span class="sd">        NRATT</span>
<span class="sd">        FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">atom_mass_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of content: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">NRMTT</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRMTT</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NRMTT</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NRMTT</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NRMTT</span> <span class="o">=</span> <span class="n">NRMTT</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN number of terms NRMTT is not equal to the ammount of terms.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NRMTT: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NRMTT</span><span class="p">)))</span></div>

<div class="viewcode-block" id="MIXEDATOMLJPAIR.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.MIXEDATOMLJPAIR.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span>
        <span class="n">table_start</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">table_start</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">field</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">]):</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">table_start</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>  <span class="c1"># as there is no table header in the file</span>
            <span class="n">table_start</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">table_lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">table_start</span><span class="p">:]</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">table_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
                <span class="n">IACI</span><span class="p">,</span> <span class="n">IACJ</span><span class="p">,</span> <span class="n">C6</span><span class="p">,</span> <span class="n">C12_1</span><span class="p">,</span> <span class="n">C12_2</span><span class="p">,</span> <span class="n">C12_3</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">mixed_atom_lj_pair_type</span><span class="p">(</span>
                        <span class="n">IACI</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">IACI</span><span class="p">),</span>
                        <span class="n">IACJ</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">IACJ</span><span class="p">),</span>
                        <span class="n">C6</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">C6</span><span class="p">),</span>
                        <span class="n">C12_1</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">C12_1</span><span class="p">),</span>
                        <span class="n">C12_2</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">C12_2</span><span class="p">),</span>
                        <span class="n">C12_3</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">C12_3</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="MIXEDATOMLJPAIR.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.MIXEDATOMLJPAIR.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NRMTT&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRMTT</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# TABLE CONTENT: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="SPECATOMLJPAIR"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SPECATOMLJPAIR">[docs]</a><span class="k">class</span> <span class="nc">SPECATOMLJPAIR</span><span class="p">(</span><span class="n">_iterable_topology_block</span><span class="p">):</span>
    <span class="n">NRST</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;???&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="SPECATOMLJPAIR.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SPECATOMLJPAIR.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">NRST</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content</span>
<span class="sd">        NRATT</span>
<span class="sd">        FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">atom_mass_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of content: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">NRST</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRST</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NRST</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">NRST</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NRST</span> <span class="o">=</span> <span class="n">NRST</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IN number of terms NRST is not equal to the ammount of terms.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of NRST: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NRST</span><span class="p">)))</span></div>

<div class="viewcode-block" id="SPECATOMLJPAIR.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SPECATOMLJPAIR.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># TODO: implement</span>
        <span class="c1"># warnings.warn(&quot;SPECIAL LJ BLOCK IS NOT IMPLEMENTED!&quot;)</span>
        <span class="k">return</span> <span class="p">[]</span></div></div>


<span class="c1">###################################################################</span>
<span class="c1"># Top() class blocks</span>
<span class="c1">###################################################################</span>


<div class="viewcode-block" id="soluteatom_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.soluteatom_type">[docs]</a><span class="k">class</span> <span class="nc">soluteatom_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="soluteatom_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.soluteatom_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ATNM</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">MRES</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">PANM</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">IAC</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">MASS</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">CG</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">CGC</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">INE</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">INEvalues</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">INE14</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">INE14values</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;soluteatom_type</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ATNM : int</span>
<span class="sd">            [description]</span>
<span class="sd">        MRES : int</span>
<span class="sd">            [description]</span>
<span class="sd">        PANM : str</span>
<span class="sd">            [description]</span>
<span class="sd">        IAC : int</span>
<span class="sd">            [description]</span>
<span class="sd">        MASS : float</span>
<span class="sd">            [description]</span>
<span class="sd">        CG : float</span>
<span class="sd">            [description]</span>
<span class="sd">        CGC : int</span>
<span class="sd">            [description]</span>
<span class="sd">        INE : int</span>
<span class="sd">            [description]</span>
<span class="sd">        INEvalues : [type]</span>
<span class="sd">            [description]</span>
<span class="sd">        INE14 : int</span>
<span class="sd">            [description]</span>
<span class="sd">        INE14values : [type]</span>
<span class="sd">            [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ATNM</span> <span class="o">=</span> <span class="n">ATNM</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MRES</span> <span class="o">=</span> <span class="n">MRES</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PANM</span> <span class="o">=</span> <span class="n">PANM</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IAC</span> <span class="o">=</span> <span class="n">IAC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MASS</span> <span class="o">=</span> <span class="n">MASS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CG</span> <span class="o">=</span> <span class="n">CG</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CGC</span> <span class="o">=</span> <span class="n">CGC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">INE</span> <span class="o">=</span> <span class="n">INE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">INEvalues</span> <span class="o">=</span> <span class="n">INEvalues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">INE14</span> <span class="o">=</span> <span class="n">INE14</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">INE14values</span> <span class="o">=</span> <span class="n">INE14values</span></div>

<div class="viewcode-block" id="soluteatom_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.soluteatom_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ATNM</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MRES</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PANM</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IAC</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MASS</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CG</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CGC</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">INE</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">lcounter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">temp_INE</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">INEvalues</span><span class="p">)</span>
        <span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">INEvalues</span><span class="p">:</span>
            <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">iter</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">lcounter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">lcounter</span> <span class="o">%</span> <span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">temp_INE</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
                <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n\t\t\t\t\t\t\t\t\t\t</span><span class="s2">&quot;</span>
                <span class="n">temp_INE</span> <span class="o">-=</span> <span class="mi">6</span>
        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n\t\t\t\t\t\t\t\t\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">INE14</span><span class="p">)</span>
        <span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">INE14values</span><span class="p">:</span>
            <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">iter</span><span class="p">)</span>
        <span class="n">str_line</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="bondstretchtype_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.bondstretchtype_type">[docs]</a><span class="k">class</span> <span class="nc">bondstretchtype_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="bondstretchtype_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.bondstretchtype_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CB</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">CHB</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">B0</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS bondstretchtype for a single pair</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        CB: float</span>
<span class="sd">            quartic force constant</span>
<span class="sd">        CHB: float</span>
<span class="sd">            harmonic force constant</span>
<span class="sd">        B0: float</span>
<span class="sd">            bond length at minimum energy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CB</span> <span class="o">=</span> <span class="n">CB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CHB</span> <span class="o">=</span> <span class="n">CHB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B0</span> <span class="o">=</span> <span class="n">B0</span></div>

<div class="viewcode-block" id="bondstretchtype_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.bondstretchtype_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.5e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CB</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.5e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CHB</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.5e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">B0</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="bondanglebendtype_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.bondanglebendtype_type">[docs]</a><span class="k">class</span> <span class="nc">bondanglebendtype_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="bondanglebendtype_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.bondanglebendtype_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CT</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">CHT</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">T0</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS bondanglebendtype for a single angle</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        CT: float</span>
<span class="sd">            quartic force constant</span>
<span class="sd">        CHT: float</span>
<span class="sd">            harmonic force constant</span>
<span class="sd">        T0: float</span>
<span class="sd">            angle at minimum energy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CT</span> <span class="o">=</span> <span class="n">CT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CHT</span> <span class="o">=</span> <span class="n">CHT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T0</span> <span class="o">=</span> <span class="n">T0</span></div>

<div class="viewcode-block" id="bondanglebendtype_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.bondanglebendtype_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.5e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.5e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CHT</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.5e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="top_bond_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.top_bond_type">[docs]</a><span class="k">class</span> <span class="nc">top_bond_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="top_bond_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.top_bond_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IB</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">JB</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ICB</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS bond definition for a single pair</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        IB: int</span>
<span class="sd">            Atom number i</span>
<span class="sd">        JB: int</span>
<span class="sd">            Atom number j</span>
<span class="sd">        ICB: int</span>
<span class="sd">            Bond type code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IB</span> <span class="o">=</span> <span class="n">IB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">JB</span> <span class="o">=</span> <span class="n">JB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICB</span> <span class="o">=</span> <span class="n">ICB</span></div>

<div class="viewcode-block" id="top_bond_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.top_bond_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IB</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JB</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ICB</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="bondangle_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.bondangle_type">[docs]</a><span class="k">class</span> <span class="nc">bondangle_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="bondangle_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.bondangle_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IT</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">JT</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">KT</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ICT</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS bondangleype for a single pair</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        IT: int</span>
<span class="sd">            atom number in angle</span>
<span class="sd">        JT: int</span>
<span class="sd">            atom number in angle</span>
<span class="sd">        KT: int</span>
<span class="sd">            atom number in angle</span>
<span class="sd">        ICT: int</span>
<span class="sd">            bond angle type code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IT</span> <span class="o">=</span> <span class="n">IT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">JT</span> <span class="o">=</span> <span class="n">JT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">KT</span> <span class="o">=</span> <span class="n">KT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICT</span> <span class="o">=</span> <span class="n">ICT</span></div>

<div class="viewcode-block" id="bondangle_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.bondangle_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IT</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JT</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KT</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ICT</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="impdihedraltype_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.impdihedraltype_type">[docs]</a><span class="k">class</span> <span class="nc">impdihedraltype_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="impdihedraltype_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.impdihedraltype_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CQ</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Q0</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS impdihedraltype for a single pair</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        CQ: float</span>
<span class="sd">            force constant of improper dihedral per degrees square</span>
<span class="sd">        Q0: float</span>
<span class="sd">            improper dihedral angle at minimum energy in degrees</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CQ</span> <span class="o">=</span> <span class="n">CQ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q0</span> <span class="o">=</span> <span class="n">Q0</span></div>

<div class="viewcode-block" id="impdihedraltype_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.impdihedraltype_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.5e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CQ</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.5e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Q0</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="impdihedralh_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.impdihedralh_type">[docs]</a><span class="k">class</span> <span class="nc">impdihedralh_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="impdihedralh_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.impdihedralh_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IQH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">JQH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">KQH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">LQH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ICQH</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS impdihedralH for a single pair</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        IQH:int</span>
<span class="sd">        JQH:int</span>
<span class="sd">        KQH:int</span>
<span class="sd">        LQH:int</span>
<span class="sd">            IQH,JQH,KQH,LQH: atom sequence numbers of atoms forming an improper dihedral</span>
<span class="sd">        ICQH:int</span>
<span class="sd">            improper dihedral type code</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IQH</span> <span class="o">=</span> <span class="n">IQH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">JQH</span> <span class="o">=</span> <span class="n">JQH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">KQH</span> <span class="o">=</span> <span class="n">KQH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LQH</span> <span class="o">=</span> <span class="n">LQH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICQH</span> <span class="o">=</span> <span class="n">ICQH</span></div>

<div class="viewcode-block" id="impdihedralh_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.impdihedralh_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IQH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JQH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KQH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LQH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ICQH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="impdihedral_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.impdihedral_type">[docs]</a><span class="k">class</span> <span class="nc">impdihedral_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="impdihedral_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.impdihedral_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IQ</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">JQ</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">KQ</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">LQ</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ICQ</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS impdihedral for a single pair</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        IQ:int</span>
<span class="sd">        JQ:int</span>
<span class="sd">        KQ:int</span>
<span class="sd">        LQ:int</span>
<span class="sd">            IQ,JQ,KQ,LQ: atom sequence numbers of atoms forming an improper dihedral</span>
<span class="sd">        ICQ:int</span>
<span class="sd">            improper dihedral type code</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IQ</span> <span class="o">=</span> <span class="n">IQ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">JQ</span> <span class="o">=</span> <span class="n">JQ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">KQ</span> <span class="o">=</span> <span class="n">KQ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LQ</span> <span class="o">=</span> <span class="n">LQ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICQ</span> <span class="o">=</span> <span class="n">ICQ</span></div>

<div class="viewcode-block" id="impdihedral_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.impdihedral_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IQ</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JQ</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KQ</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LQ</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ICQ</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="torsdihedraltype_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.torsdihedraltype_type">[docs]</a><span class="k">class</span> <span class="nc">torsdihedraltype_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="torsdihedraltype_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.torsdihedraltype_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CP</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">PD</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">NP</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS dihedraltype for a single pair</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        CP:float</span>
<span class="sd">            force constant</span>
<span class="sd">        PD:float</span>
<span class="sd">            phase-shift angle</span>
<span class="sd">        NP:int</span>
<span class="sd">            multiplicity</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CP</span> <span class="o">=</span> <span class="n">CP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PD</span> <span class="o">=</span> <span class="n">PD</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NP</span> <span class="o">=</span> <span class="n">NP</span></div>

<div class="viewcode-block" id="torsdihedraltype_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.torsdihedraltype_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.5e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CP</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.5e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PD</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NP</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="dihedralh_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.dihedralh_type">[docs]</a><span class="k">class</span> <span class="nc">dihedralh_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="dihedralh_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.dihedralh_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IPH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">JPH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">KPH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">LPH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ICPH</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS dihedral for a single pair</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IPH</span> <span class="o">=</span> <span class="n">IPH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">JPH</span> <span class="o">=</span> <span class="n">JPH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">KPH</span> <span class="o">=</span> <span class="n">KPH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LPH</span> <span class="o">=</span> <span class="n">LPH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICPH</span> <span class="o">=</span> <span class="n">ICPH</span></div>

<div class="viewcode-block" id="dihedralh_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.dihedralh_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IPH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JPH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KPH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LPH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ICPH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="top_dihedral_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.top_dihedral_type">[docs]</a><span class="k">class</span> <span class="nc">top_dihedral_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="top_dihedral_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.top_dihedral_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">JP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">KP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">LP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ICP</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS dihedral for a single pair</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IP</span> <span class="o">=</span> <span class="n">IP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">JP</span> <span class="o">=</span> <span class="n">JP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">KP</span> <span class="o">=</span> <span class="n">KP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LP</span> <span class="o">=</span> <span class="n">LP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICP</span> <span class="o">=</span> <span class="n">ICP</span></div>

<div class="viewcode-block" id="top_dihedral_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.top_dihedral_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ICP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="crossgihedralh_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.crossgihedralh_type">[docs]</a><span class="k">class</span> <span class="nc">crossgihedralh_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="crossgihedralh_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.crossgihedralh_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">APH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">BPH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">CPH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">DPH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">EPH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">FPH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">GPH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">HPH</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ICCH</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        GROMOS Cross Dihedral type for H</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        APH : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        BPH : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        CPH : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        DPH : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        EPH : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        FPH : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        GPH : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        HPH : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        ICCH : int</span>
<span class="sd">            dihedral type code</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">APH</span> <span class="o">=</span> <span class="n">APH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BPH</span> <span class="o">=</span> <span class="n">BPH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CPH</span> <span class="o">=</span> <span class="n">CPH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DPH</span> <span class="o">=</span> <span class="n">DPH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EPH</span> <span class="o">=</span> <span class="n">EPH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FPH</span> <span class="o">=</span> <span class="n">FPH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GPH</span> <span class="o">=</span> <span class="n">GPH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HPH</span> <span class="o">=</span> <span class="n">HPH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICCH</span> <span class="o">=</span> <span class="n">ICCH</span></div>

<div class="viewcode-block" id="crossgihedralh_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.crossgihedralh_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">APH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BPH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CPH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DPH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EPH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FPH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GPH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HPH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ICCH</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="crossgihedral_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.crossgihedral_type">[docs]</a><span class="k">class</span> <span class="nc">crossgihedral_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="crossgihedral_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.crossgihedral_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">AP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">BP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">CP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">DP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">EP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">FP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">GP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">HP</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ICC</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        GROMOS Cross Dihedral type for NON H Atoms</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        AP : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        BP : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        CP : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        DP : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        EP : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        FP : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        GP : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        HP : int</span>
<span class="sd">            number of atoms forming a dihedral</span>
<span class="sd">        ICC : int</span>
<span class="sd">            dihedral type code</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">AP</span> <span class="o">=</span> <span class="n">AP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BP</span> <span class="o">=</span> <span class="n">BP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CP</span> <span class="o">=</span> <span class="n">CP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DP</span> <span class="o">=</span> <span class="n">DP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EP</span> <span class="o">=</span> <span class="n">EP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FP</span> <span class="o">=</span> <span class="n">FP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GP</span> <span class="o">=</span> <span class="n">GP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HP</span> <span class="o">=</span> <span class="n">HP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICC</span> <span class="o">=</span> <span class="n">ICC</span></div>

<div class="viewcode-block" id="crossgihedral_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.crossgihedral_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HP</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ICC</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="ljparameters_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.ljparameters_type">[docs]</a><span class="k">class</span> <span class="nc">ljparameters_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="ljparameters_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.ljparameters_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IAC</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">JAC</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">C12</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">C6</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">CS12</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">CS6</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS LJ parameter pair</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IAC</span> <span class="o">=</span> <span class="n">IAC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">JAC</span> <span class="o">=</span> <span class="n">JAC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C12</span> <span class="o">=</span> <span class="n">C12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C6</span> <span class="o">=</span> <span class="n">C6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CS12</span> <span class="o">=</span> <span class="n">CS12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CS6</span> <span class="o">=</span> <span class="n">CS6</span></div>

<div class="viewcode-block" id="ljparameters_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.ljparameters_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IAC</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JAC</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C12</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C6</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CS12</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CS6</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="ljexception_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.ljexception_type">[docs]</a><span class="k">class</span> <span class="nc">ljexception_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="ljexception_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.ljexception_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">AT1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">AT2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">C12</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">C6</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS LJ exception pair</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AT1</span> <span class="o">=</span> <span class="n">AT1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AT2</span> <span class="o">=</span> <span class="n">AT2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C12</span> <span class="o">=</span> <span class="n">C12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C6</span> <span class="o">=</span> <span class="n">C6</span></div>

<div class="viewcode-block" id="ljexception_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.ljexception_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AT1</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AT2</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C12</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C6</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="solventatom_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.solventatom_type">[docs]</a><span class="k">class</span> <span class="nc">solventatom_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="solventatom_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.solventatom_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">I</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ANMS</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">IACS</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">MASS</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">CGS</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>  <span class="c1"># noqa: E741</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS solventatom line</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="n">I</span>  <span class="c1"># noqa: E741</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ANMS</span> <span class="o">=</span> <span class="n">ANMS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IACS</span> <span class="o">=</span> <span class="n">IACS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MASS</span> <span class="o">=</span> <span class="n">MASS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CGS</span> <span class="o">=</span> <span class="n">CGS</span></div>

<div class="viewcode-block" id="solventatom_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.solventatom_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">I</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ANMS</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IACS</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.5e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MASS</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.5e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CGS</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="solventconstr_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.solventconstr_type">[docs]</a><span class="k">class</span> <span class="nc">solventconstr_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="solventconstr_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.solventconstr_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ICONS</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">JCONS</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">CONS</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               GROMOS SOLVENTCONSTR entry</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICONS</span> <span class="o">=</span> <span class="n">ICONS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">JCONS</span> <span class="o">=</span> <span class="n">JCONS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CONS</span> <span class="o">=</span> <span class="n">CONS</span></div>

<div class="viewcode-block" id="solventconstr_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.solventconstr_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ICONS</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JCONS</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CONS</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<div class="viewcode-block" id="constraint_type"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.constraint_type">[docs]</a><span class="k">class</span> <span class="nc">constraint_type</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
<div class="viewcode-block" id="constraint_type.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.constraint_type.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IC</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">JC</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ICC</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[summary]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        IC : int</span>
<span class="sd">            [description]</span>
<span class="sd">        JC : int</span>
<span class="sd">            [description]</span>
<span class="sd">        ICC : float</span>
<span class="sd">            [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IC</span> <span class="o">=</span> <span class="n">IC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">JC</span> <span class="o">=</span> <span class="n">JC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICC</span> <span class="o">=</span> <span class="n">ICC</span></div>

<div class="viewcode-block" id="constraint_type.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.constraint_type.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fieldseperator</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IC</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldseperator</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JC</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldseperator</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ICC</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineseperator</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">str_line</span></div></div>


<span class="k">class</span> <span class="nc">_topology_table_block</span><span class="p">(</span><span class="n">_iterable_topology_block</span><span class="p">):</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">_generic_field</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">_topology_table_block_Type</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parent class for all table like GROMOS topolgy blocks.</span>
<span class="sd">        Offers a standard implementation of read and write functions</span>

<span class="sd">        Requirements for child classes:</span>
<span class="sd">            table_header and table_line_type need to be defined</span>
<span class="sd">            additional attributes can be passed via kwargs</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content : str or dict or None</span>
<span class="sd">            content of the table like GROMOS block</span>
<span class="sd">        FORCEFIELD : FORCEFIELD, optional</span>
<span class="sd">            [description], by default None</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION, optional</span>
<span class="sd">            [description], by default None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># set attributes</span>
        <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">attribute</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>  <span class="c1"># is_allcapital()):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">attribute</span><span class="p">])</span>

        <span class="c1"># init _iterable_topology_block</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>  <span class="c1"># CHECK FOR POSSIBLE ERROR</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;In &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; is &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; not equal to the ammount.&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_check_import_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_line_type</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of content: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;table_header&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not find table_header of &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;table_line_type&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not find table_line_type of &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span>
            <span class="c1"># Table Reading:</span>
            <span class="n">table_start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="n">table_start</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">field</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">]):</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="n">table_start</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not find the TABLE start in &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_read_table</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">table_start</span><span class="p">:])</span>

    <span class="k">def</span> <span class="nf">_read_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># get information of the needed structure of the sub class</span>
        <span class="n">signature</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_line_type</span><span class="o">.</span><span class="fm">__init__</span><span class="p">)</span>
        <span class="n">parameter_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">signature</span><span class="o">.</span><span class="n">parameters</span> <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;self&quot;</span><span class="p">)]</span>
        <span class="n">parameter_type</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">signature</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">annotation</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">parameter_name</span><span class="p">}</span>
        <span class="c1"># loop over the table (=content) to create the sub classes (=table_line_type)</span>
        <span class="k">for</span> <span class="n">table_line</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">table_line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">table_line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="c1"># pre parse all non-empty non-comment lines into a list of strings</span>
                <span class="n">fields</span> <span class="o">=</span> <span class="n">table_line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                        <span class="s2">&quot;Fields are not matching the ammount of needed arguments!</span><span class="se">\n</span><span class="s2"> &quot;</span>
                        <span class="s2">&quot;#fileds: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">#args: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2"> &quot;</span>
                        <span class="s2">&quot;require: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> got: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="c1"># generate arguments dict for line parsing (= table_line_type class construction)</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">parameter_type</span><span class="p">[</span><span class="n">key</span><span class="p">](</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">,</span> <span class="n">fields</span><span class="p">)}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_line_type</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_header</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span>


<div class="viewcode-block" id="PHYSICALCONSTANTS"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.PHYSICALCONSTANTS">[docs]</a><span class="k">class</span> <span class="nc">PHYSICALCONSTANTS</span><span class="p">(</span><span class="n">_topology_block</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">PHYSICALCONSTANTS_Type</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># Default definition of physical constants</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FPEPSI</span> <span class="o">=</span> <span class="mf">138.9354</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HBAR</span> <span class="o">=</span> <span class="mf">0.0635078</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SPDL</span> <span class="o">=</span> <span class="mf">299792.458</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BOLTZ</span> <span class="o">=</span> <span class="mf">0.00831441</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_import_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="c1"># elif (type(content) == __class__):</span>
        <span class="c1">#    self.content = content</span>
        <span class="k">if</span> <span class="n">content</span> <span class="o">==</span> <span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">]]</span> <span class="ow">or</span> <span class="n">content</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">FPEPSI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">HBAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SPDL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BOLTZ</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FPEPSI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">HBAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SPDL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BOLTZ</span> <span class="o">=</span> <span class="n">content</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">FPEPSI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">HBAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SPDL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BOLTZ</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;I don&#39;t understand the type of content: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)))</span>

<div class="viewcode-block" id="PHYSICALCONSTANTS.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.PHYSICALCONSTANTS.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span>

        <span class="n">stash</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">stash</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stash</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FPEPSI</span> <span class="o">=</span> <span class="n">stash</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HBAR</span> <span class="o">=</span> <span class="n">stash</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SPDL</span> <span class="o">=</span> <span class="n">stash</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BOLTZ</span> <span class="o">=</span> <span class="n">stash</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FPEPSI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">HBAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SPDL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BOLTZ</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">stash</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FPEPSI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">HBAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SPDL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BOLTZ</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Not enough arguments provided in PHYSICALCONSTANTS&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PHYSICALCONSTANTS.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.PHYSICALCONSTANTS.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# FPEPSI: 1.0/(4.0*PI*EPS0) (EPS0 is the permittivity of vacuum)&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FPEPSI</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# HBAR: Planck&#39;s constant HBAR = H/(2* PI)&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HBAR</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# SPDL: Speed of light (nm/ps)&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SPDL</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# BOLTZ: Boltzmann&#39;s constant kB&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BOLTZ</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="TOPVERSION"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.TOPVERSION">[docs]</a><span class="k">class</span> <span class="nc">TOPVERSION</span><span class="p">(</span><span class="n">_topology_block</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">TOPVERSION_Type</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span></div>


<div class="viewcode-block" id="ATOMTYPENAME"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.ATOMTYPENAME">[docs]</a><span class="k">class</span> <span class="nc">ATOMTYPENAME</span><span class="p">(</span><span class="n">_topology_block</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">ATOMTYPENAME_Type</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span></div>


<div class="viewcode-block" id="RESNAME"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.RESNAME">[docs]</a><span class="k">class</span> <span class="nc">RESNAME</span><span class="p">(</span><span class="n">_topology_block</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">RESNAME_Type</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span></div>


<div class="viewcode-block" id="SOLUTEATOM"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SOLUTEATOM">[docs]</a><span class="k">class</span> <span class="nc">SOLUTEATOM</span><span class="p">(</span><span class="n">_iterable_topology_block</span><span class="p">):</span>
    <span class="n">NRP</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;IB&quot;</span><span class="p">,</span> <span class="s2">&quot;JB&quot;</span><span class="p">,</span> <span class="s2">&quot;ICB&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">_iterable_topology_block_Type</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_import_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">content</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="o">==</span> <span class="vm">__class__</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">elif</span> <span class="n">content</span> <span class="ow">is</span> <span class="vm">__class__</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>

<div class="viewcode-block" id="SOLUTEATOM.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SOLUTEATOM.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">contentLines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">content</span>

        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">contentLines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

        <span class="c1"># set NRP and check for sanity</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRP</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contentLines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NRP</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NRP</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;NPR in SOLUTEATOM Block is &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRP</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">NRP</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRP</span><span class="p">):</span>  <span class="c1"># main import loop</span>
                <span class="n">dump1</span> <span class="o">=</span> <span class="n">contentLines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dump1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Not enough arguments provided in SOLUTEATOM Block&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ATNM</span><span class="p">,</span> <span class="n">MRES</span><span class="p">,</span> <span class="n">PANM</span><span class="p">,</span> <span class="n">IAC</span><span class="p">,</span> <span class="n">MASS</span><span class="p">,</span> <span class="n">CG</span><span class="p">,</span> <span class="n">CGC</span><span class="p">,</span> <span class="n">INE</span> <span class="o">=</span> <span class="n">dump1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
                    <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">INE</span><span class="p">):</span>
                        <span class="n">INEvalues</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dump1</span><span class="p">[</span><span class="mi">8</span><span class="p">:]]</span>
                        <span class="c1"># keep reading in lines until we have all the data needed.</span>
                        <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">INE</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">INEvalues</span><span class="p">):</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contentLines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
                                        <span class="s2">&quot;Not enough lines provided for multi line INE in SOLUTEATOM Block</span><span class="se">\n</span><span class="s2">ATNM=&quot;</span>
                                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ATNM</span><span class="p">)</span>
                                        <span class="o">+</span> <span class="s2">&quot; MRES=&quot;</span>
                                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">MRES</span><span class="p">)</span>
                                    <span class="p">)</span>
                                <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="n">contentLines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;</span><span class="se">\t\t\t\t\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;                   &quot;</span><span class="p">]):</span>
                                    <span class="n">INEvalues</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">contentLines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
                                        <span class="s2">&quot;no intendation detected for mult line INE in SOLUTEATOM Block or too large number for INE</span><span class="se">\n</span><span class="s2">ATNM=&quot;</span>
                                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ATNM</span><span class="p">)</span>
                                        <span class="o">+</span> <span class="s2">&quot; MRES=&quot;</span>
                                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">MRES</span><span class="p">)</span>
                                    <span class="p">)</span>
                            <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Problem reading INE for ATNM=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ATNM</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; MRES=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">MRES</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">INEvalues</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="n">dump2</span> <span class="o">=</span> <span class="n">contentLines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dump2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
                        <span class="s2">&quot;Not enough arguments provided in SOLUTEATOM Block</span><span class="se">\n</span><span class="s2">ATNM=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ATNM</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; MRES=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">MRES</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">INE14</span> <span class="o">=</span> <span class="n">dump2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">INE14</span><span class="p">):</span>
                        <span class="n">INE14values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dump2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
                        <span class="c1"># keep reading in lines until we have all the data needed.</span>
                        <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">INE14</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">INE14values</span><span class="p">):</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contentLines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
                                        <span class="s2">&quot;Not enough lines provided for multi line INE14 in SOLUTEATOM Block</span><span class="se">\n</span><span class="s2">ATNM=&quot;</span>
                                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ATNM</span><span class="p">)</span>
                                        <span class="o">+</span> <span class="s2">&quot; MRES=&quot;</span>
                                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">MRES</span><span class="p">)</span>
                                    <span class="p">)</span>
                                <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="n">contentLines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;</span><span class="se">\t\t\t\t\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;                   &quot;</span><span class="p">]):</span>
                                    <span class="n">INE14values</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">contentLines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
                                        <span class="s2">&quot;no intendation detected for mult line INE14 in SOLUTEATOM Block or too large number for INE14</span><span class="se">\n</span><span class="s2">ATNM=&quot;</span>
                                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ATNM</span><span class="p">)</span>
                                        <span class="o">+</span> <span class="s2">&quot; MRES=&quot;</span>
                                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">MRES</span><span class="p">)</span>
                                    <span class="p">)</span>
                            <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Problem reading INE14 for ATNM=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ATNM</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; MRES=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">MRES</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">INE14values</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="c1"># pass everything to the subclass maker</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">soluteatom_type</span><span class="p">(</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">ATNM</span><span class="p">),</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">MRES</span><span class="p">),</span>
                    <span class="n">PANM</span><span class="p">,</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">IAC</span><span class="p">),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">MASS</span><span class="p">),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">CG</span><span class="p">),</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">CGC</span><span class="p">),</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">INE</span><span class="p">),</span>
                    <span class="n">INEvalues</span><span class="p">,</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">INE14</span><span class="p">),</span>
                    <span class="n">INE14values</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="SOLUTEATOM.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SOLUTEATOM.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#   NRP: number of solute atoms&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRP</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#  ATNM: atom number</span><span class="se">\n</span><span class="s2">#  MRES: residue number</span><span class="se">\n</span><span class="s2">#  PANM: atom name of solute atom</span><span class="se">\n</span><span class="s2">#   IAC: integer (van der Waals) atom type code</span><span class="se">\n</span><span class="s2">#  MASS: mass of solute atom</span><span class="se">\n</span><span class="s2">#    CG: charge of solute atom</span><span class="se">\n</span><span class="s2">#   CGC: charge group code (0 or 1)</span><span class="se">\n</span><span class="s2">#   INE: number of excluded atoms</span><span class="se">\n</span><span class="s2"># INE14: number of 1-4 interactions</span><span class="se">\n</span><span class="s2"># ATNM MRES PANM IAC     MASS       CG  CGC INE</span><span class="se">\n</span><span class="s2">#                                           INE14</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="nb">iter</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="BONDSTRETCHTYPE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDSTRETCHTYPE">[docs]</a><span class="k">class</span> <span class="nc">BONDSTRETCHTYPE</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NBTY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CB&quot;</span><span class="p">,</span> <span class="s2">&quot;CHB&quot;</span><span class="p">,</span> <span class="s2">&quot;B0&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">bondstretchtype_type</span>

<div class="viewcode-block" id="BONDSTRETCHTYPE.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDSTRETCHTYPE.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">bondstretchtype_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NBTY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS BONDSTRETCHTYPE block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[bondstretchtype_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NBTY : int, optional</span>
<span class="sd">            Number of bondstretchtypes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NBTY&quot;</span><span class="p">:</span> <span class="n">NBTY</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="BONDSTRETCHTYPE.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDSTRETCHTYPE.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="BONDSTRETCHTYPE.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDSTRETCHTYPE.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NBTY: number of covalent bond types&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NBTY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="BOND"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BOND">[docs]</a><span class="k">class</span> <span class="nc">BOND</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NBON</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;IB&quot;</span><span class="p">,</span> <span class="s2">&quot;JB&quot;</span><span class="p">,</span> <span class="s2">&quot;ICB&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">top_bond_type</span>

<div class="viewcode-block" id="BOND.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BOND.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">top_bond_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NBON</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS BOND block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[top_bond_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NBON : int, optional</span>
<span class="sd">            Number of bonds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NBON&quot;</span><span class="p">:</span> <span class="n">NBON</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="BOND.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BOND.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="BOND.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BOND.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NBON: number of bonds NOT involving H atoms in solute&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NBON</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="BONDH"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDH">[docs]</a><span class="k">class</span> <span class="nc">BONDH</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NBONH</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;IBH&quot;</span><span class="p">,</span> <span class="s2">&quot;JBH&quot;</span><span class="p">,</span> <span class="s2">&quot;ICBH&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">top_bond_type</span>  <span class="c1"># reused data type for simplicity</span>

<div class="viewcode-block" id="BONDH.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDH.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">top_bond_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NBONH</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS BONDH block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[top_bond_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NBONH : int, optional</span>
<span class="sd">            Number of bonds with H</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NBONH&quot;</span><span class="p">:</span> <span class="n">NBONH</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="BONDH.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDH.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="BONDH.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDH.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NBONH: number of bonds involving H atoms in solute&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NBONH</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="BONDANGLEBENDTYPE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLEBENDTYPE">[docs]</a><span class="k">class</span> <span class="nc">BONDANGLEBENDTYPE</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NBTY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CT&quot;</span><span class="p">,</span> <span class="s2">&quot;CHT&quot;</span><span class="p">,</span> <span class="s2">&quot;T0&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">bondanglebendtype_type</span>

<div class="viewcode-block" id="BONDANGLEBENDTYPE.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLEBENDTYPE.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">bondanglebendtype_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NBTY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS BONDSTRETCHTYPE block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[bondanglebendtype_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NBTY : int, optional</span>
<span class="sd">            Number of bondstretchtypes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NBTY&quot;</span><span class="p">:</span> <span class="n">NBTY</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="BONDANGLEBENDTYPE.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLEBENDTYPE.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="BONDANGLEBENDTYPE.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLEBENDTYPE.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NBTY: number of angle types&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NBTY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="BONDANGLE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLE">[docs]</a><span class="k">class</span> <span class="nc">BONDANGLE</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NTHE</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;IT&quot;</span><span class="p">,</span> <span class="s2">&quot;JT&quot;</span><span class="p">,</span> <span class="s2">&quot;KT&quot;</span><span class="p">,</span> <span class="s2">&quot;ICT&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">bondangle_type</span>

<div class="viewcode-block" id="BONDANGLE.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLE.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">bondangle_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NTHE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS BONDSTRETCHTYPE block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[bondangle_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NTHE : int, optional</span>
<span class="sd">            Number of bondangles</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NTHE&quot;</span><span class="p">:</span> <span class="n">NTHE</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="BONDANGLE.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLE.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="BONDANGLE.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLE.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NTHE: number of angles&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NTHE</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="BONDANGLEH"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLEH">[docs]</a><span class="k">class</span> <span class="nc">BONDANGLEH</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NTHEH</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ITH&quot;</span><span class="p">,</span> <span class="s2">&quot;JTH&quot;</span><span class="p">,</span> <span class="s2">&quot;KTH&quot;</span><span class="p">,</span> <span class="s2">&quot;ICTH&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">bondangle_type</span>

<div class="viewcode-block" id="BONDANGLEH.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLEH.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">bondangle_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NTHEH</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS BONDANGLEH block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[bondangle_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NTHEH : int, optional</span>
<span class="sd">            Number of bondangles</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NTHEH&quot;</span><span class="p">:</span> <span class="n">NTHEH</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="BONDANGLEH.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLEH.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="BONDANGLEH.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.BONDANGLEH.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NTHEH: number of bondangles involving a H&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NTHEH</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="IMPDIHEDRALTYPE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRALTYPE">[docs]</a><span class="k">class</span> <span class="nc">IMPDIHEDRALTYPE</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NQTY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CQ&quot;</span><span class="p">,</span> <span class="s2">&quot;Q0&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">impdihedraltype_type</span>

<div class="viewcode-block" id="IMPDIHEDRALTYPE.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRALTYPE.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">impdihedraltype_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NQTY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS IMPDIHEDRALTYPE block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[impdihedraltype_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NQTY : int, optional</span>
<span class="sd">            Number of impdihedraltype</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NQTY&quot;</span><span class="p">:</span> <span class="n">NQTY</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="IMPDIHEDRALTYPE.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRALTYPE.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="IMPDIHEDRALTYPE.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRALTYPE.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NQTY: number of improper dihedrals&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NQTY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="IMPDIHEDRALH"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRALH">[docs]</a><span class="k">class</span> <span class="nc">IMPDIHEDRALH</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NQHIH</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;IQH&quot;</span><span class="p">,</span> <span class="s2">&quot;JQH&quot;</span><span class="p">,</span> <span class="s2">&quot;KQH&quot;</span><span class="p">,</span> <span class="s2">&quot;LQH&quot;</span><span class="p">,</span> <span class="s2">&quot;ICQH&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">impdihedralh_type</span>

<div class="viewcode-block" id="IMPDIHEDRALH.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRALH.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">impdihedralh_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NQHIH</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS IMPDIHEDRALH block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[impdihedralh_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NQHIH : int, optional</span>
<span class="sd">            Number of impdihedralH</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NQHIH&quot;</span><span class="p">:</span> <span class="n">NQHIH</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="IMPDIHEDRALH.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRALH.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="IMPDIHEDRALH.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRALH.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NQHIH: number of improper dihedrals involving H atoms&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NQHIH</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="IMPDIHEDRAL"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRAL">[docs]</a><span class="k">class</span> <span class="nc">IMPDIHEDRAL</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NQHI</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;IQ&quot;</span><span class="p">,</span> <span class="s2">&quot;JQ&quot;</span><span class="p">,</span> <span class="s2">&quot;KQ&quot;</span><span class="p">,</span> <span class="s2">&quot;LQ&quot;</span><span class="p">,</span> <span class="s2">&quot;ICQ&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">impdihedral_type</span>

<div class="viewcode-block" id="IMPDIHEDRAL.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRAL.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">impdihedral_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NQHI</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS IMPDIHEDRAL block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[impdihedral_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NQHI : int, optional</span>
<span class="sd">            Number of impdihedral</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NQHI&quot;</span><span class="p">:</span> <span class="n">NQHI</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="IMPDIHEDRAL.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRAL.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="IMPDIHEDRAL.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.IMPDIHEDRAL.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;#&quot;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
            <span class="o">+</span> <span class="s2">&quot;NQHI: number of improper dihedrals NOT involving H atoms&quot;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NQHI</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

    <span class="c1"># def block_to_string(self) -&gt; str:</span>
    <span class="c1">#     result = self.name + &quot;\n&quot;</span>
    <span class="c1">#     result += &quot;#&quot; + self.field_seperator + &quot;#  NQHI: number of improper dihedrals&quot; + self.line_seperator</span>
    <span class="c1">#     result += self.field_seperator + str(self.NQHI) + self.line_seperator</span>
    <span class="c1">#     result += &quot;#&quot; + self.field_seperator + self.field_seperator.join(self.table_header) + self.line_seperator</span>
    <span class="c1">#     for x in self.content:</span>
    <span class="c1">#         result += x.to_string()</span>
    <span class="c1">#     result += &quot;END\n&quot;</span>
    <span class="c1">#     return result</span>


<div class="viewcode-block" id="TORSDIHEDRALTYPE"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.TORSDIHEDRALTYPE">[docs]</a><span class="k">class</span> <span class="nc">TORSDIHEDRALTYPE</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NPTY</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CP&quot;</span><span class="p">,</span> <span class="s2">&quot;PD&quot;</span><span class="p">,</span> <span class="s2">&quot;NP&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">torsdihedraltype_type</span>

<div class="viewcode-block" id="TORSDIHEDRALTYPE.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.TORSDIHEDRALTYPE.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">torsdihedraltype_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NPTY</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS IMPDIHEDRAL block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[torsdihedraltype_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NQTY : int, optional</span>
<span class="sd">            Number of torsion dihedrals</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NPTY&quot;</span><span class="p">:</span> <span class="n">NPTY</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="TORSDIHEDRALTYPE.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.TORSDIHEDRALTYPE.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="TORSDIHEDRALTYPE.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.TORSDIHEDRALTYPE.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NPTY: number of torsion dihedrals&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NPTY</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="DIHEDRALH"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.DIHEDRALH">[docs]</a><span class="k">class</span> <span class="nc">DIHEDRALH</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NPHIH</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;IPH&quot;</span><span class="p">,</span> <span class="s2">&quot;JPH&quot;</span><span class="p">,</span> <span class="s2">&quot;KPH&quot;</span><span class="p">,</span> <span class="s2">&quot;LPH&quot;</span><span class="p">,</span> <span class="s2">&quot;ICPH&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">dihedralh_type</span>

<div class="viewcode-block" id="DIHEDRALH.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.DIHEDRALH.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">dihedralh_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NPHIH</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS DIHEDRAL block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[dihedralh_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NPHIH : int, optional</span>
<span class="sd">            Number of dihedralH</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NPHIH&quot;</span><span class="p">:</span> <span class="n">NPHIH</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="DIHEDRALH.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.DIHEDRALH.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="DIHEDRALH.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.DIHEDRALH.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NPHIH: number of torsion dihedrals involving H atoms&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NPHIH</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="DIHEDRAL"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.DIHEDRAL">[docs]</a><span class="k">class</span> <span class="nc">DIHEDRAL</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NPHI</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;IP&quot;</span><span class="p">,</span> <span class="s2">&quot;JP&quot;</span><span class="p">,</span> <span class="s2">&quot;KP&quot;</span><span class="p">,</span> <span class="s2">&quot;LP&quot;</span><span class="p">,</span> <span class="s2">&quot;ICP&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">top_dihedral_type</span>

<div class="viewcode-block" id="DIHEDRAL.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.DIHEDRAL.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">top_dihedral_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NPHI</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS DIHEDRAL block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[top_dihedral_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NPHI : int, optional</span>
<span class="sd">            Number of tors dihedral</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NPHI&quot;</span><span class="p">:</span> <span class="n">NPHI</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="DIHEDRAL.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.DIHEDRAL.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="DIHEDRAL.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.DIHEDRAL.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NPHI: number of dihedrals NOT involving H atoms&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NPHI</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="CROSSDIHEDRALH"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.CROSSDIHEDRALH">[docs]</a><span class="k">class</span> <span class="nc">CROSSDIHEDRALH</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NPHIH</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;APH&quot;</span><span class="p">,</span> <span class="s2">&quot;BPH&quot;</span><span class="p">,</span> <span class="s2">&quot;CPH&quot;</span><span class="p">,</span> <span class="s2">&quot;DPH&quot;</span><span class="p">,</span> <span class="s2">&quot;EPH&quot;</span><span class="p">,</span> <span class="s2">&quot;FPH&quot;</span><span class="p">,</span> <span class="s2">&quot;GPH&quot;</span><span class="p">,</span> <span class="s2">&quot;HPH&quot;</span><span class="p">,</span> <span class="s2">&quot;ICCH&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">crossgihedralh_type</span>

<div class="viewcode-block" id="CROSSDIHEDRALH.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.CROSSDIHEDRALH.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">crossgihedralh_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NPHIH</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[summary]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content : Union[Iterable[crossgihedralh_type], str]</span>
<span class="sd">            [description]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD, optional</span>
<span class="sd">            [description], by default None</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION, optional</span>
<span class="sd">            [description], by default None</span>
<span class="sd">        NPHIH : [type], optional</span>
<span class="sd">            number of cross dihedrals involving H atoms in solute, by default None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NPHIH&quot;</span><span class="p">:</span> <span class="n">NPHIH</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="CROSSDIHEDRALH.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.CROSSDIHEDRALH.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="CROSSDIHEDRALH.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.CROSSDIHEDRALH.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NPHIH: number of dihedrals involving H atoms&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NPHIH</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="CROSSDIHEDRAL"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.CROSSDIHEDRAL">[docs]</a><span class="k">class</span> <span class="nc">CROSSDIHEDRAL</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NPHI</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AP&quot;</span><span class="p">,</span> <span class="s2">&quot;BP&quot;</span><span class="p">,</span> <span class="s2">&quot;CP&quot;</span><span class="p">,</span> <span class="s2">&quot;DP&quot;</span><span class="p">,</span> <span class="s2">&quot;EP&quot;</span><span class="p">,</span> <span class="s2">&quot;FP&quot;</span><span class="p">,</span> <span class="s2">&quot;GP&quot;</span><span class="p">,</span> <span class="s2">&quot;HP&quot;</span><span class="p">,</span> <span class="s2">&quot;ICC&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">crossgihedralh_type</span>

<div class="viewcode-block" id="CROSSDIHEDRAL.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.CROSSDIHEDRAL.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">crossgihedral_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NPHI</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[summary]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content : Union[Iterable[crossgihedral_type], str]</span>
<span class="sd">            [description]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD, optional</span>
<span class="sd">            [description], by default None</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION, optional</span>
<span class="sd">            [description], by default None</span>
<span class="sd">        NPHI : [type], optional</span>
<span class="sd">            number of cross dihedrals NOT involving H atoms in solute, by default None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NPHI&quot;</span><span class="p">:</span> <span class="n">NPHI</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="CROSSDIHEDRAL.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.CROSSDIHEDRAL.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="CROSSDIHEDRAL.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.CROSSDIHEDRAL.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NPHI: number of cross dihedrals NOT involving H atoms&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NPHI</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="LJPARAMETERS"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.LJPARAMETERS">[docs]</a><span class="k">class</span> <span class="nc">LJPARAMETERS</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NRATT2</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;IAC&quot;</span><span class="p">,</span> <span class="s2">&quot;JAC&quot;</span><span class="p">,</span> <span class="s2">&quot;C12&quot;</span><span class="p">,</span> <span class="s2">&quot;C6&quot;</span><span class="p">,</span> <span class="s2">&quot;CS12&quot;</span><span class="p">,</span> <span class="s2">&quot;CS6&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">ljparameters_type</span>

<div class="viewcode-block" id="LJPARAMETERS.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.LJPARAMETERS.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ljparameters_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NRATT2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS LJPARAMETERS block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[ljparameters_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NRATT2 : int, optional</span>
<span class="sd">            Number of LJPARAMETERS</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NRATT2&quot;</span><span class="p">:</span> <span class="n">NRATT2</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="LJPARAMETERS.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.LJPARAMETERS.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="LJPARAMETERS.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.LJPARAMETERS.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;#&quot;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
            <span class="o">+</span> <span class="s2">&quot;NRATT2: number of LJ interaction types = NRATT*(NRATT+1)/2&quot;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRATT2</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<span class="k">class</span> <span class="nc">_generic_topology_groups</span><span class="p">(</span><span class="n">_topology_block</span><span class="p">):</span>
    <span class="n">NSM</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">NSP</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NSM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NSP</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">NSP</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NSM</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">NSP</span><span class="p">)</span> <span class="o">==</span> <span class="n">NSM</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NSM</span> <span class="o">=</span> <span class="n">NSM</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;FUn&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NSM</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">NSP</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NSP</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">NSP</span><span class="p">))</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
                <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">NSM</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">NSP</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NSM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NSP</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NSM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NSP</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NSP</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">t</span><span class="p">)))</span> <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">NSP</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;SOLUTEMOLECULES has not the correct number of fields.&quot;</span><span class="p">)</span>

        <span class="c1"># Clean COntent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">NSM</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NSP</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># Clean COntent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">NSM</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NSP</span><span class="p">])</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>


<div class="viewcode-block" id="SOLUTEMOLECULES"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SOLUTEMOLECULES">[docs]</a><span class="k">class</span> <span class="nc">SOLUTEMOLECULES</span><span class="p">(</span><span class="n">_generic_topology_groups</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="TEMPERATUREGROUPS"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.TEMPERATUREGROUPS">[docs]</a><span class="k">class</span> <span class="nc">TEMPERATUREGROUPS</span><span class="p">(</span><span class="n">_generic_topology_groups</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="PRESSUREGROUPS"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.PRESSUREGROUPS">[docs]</a><span class="k">class</span> <span class="nc">PRESSUREGROUPS</span><span class="p">(</span><span class="n">_generic_topology_groups</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="LJEXCEPTIONS"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.LJEXCEPTIONS">[docs]</a><span class="k">class</span> <span class="nc">LJEXCEPTIONS</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NEX</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AT1&quot;</span><span class="p">,</span> <span class="s2">&quot;AT2&quot;</span><span class="p">,</span> <span class="s2">&quot;C12&quot;</span><span class="p">,</span> <span class="s2">&quot;C6&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">ljexception_type</span>

<div class="viewcode-block" id="LJEXCEPTIONS.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.LJEXCEPTIONS.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ljexception_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NEX</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS LJEXCEPTIONS block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[ljexception_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NEX : int, optional</span>
<span class="sd">            Number of LJEXCEPTIONS</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NEX&quot;</span><span class="p">:</span> <span class="n">NEX</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="LJEXCEPTIONS.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.LJEXCEPTIONS.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="LJEXCEPTIONS.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.LJEXCEPTIONS.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# This block defines special LJ-interactions based on atom numbers </span><span class="se">\n</span><span class="s2"># This overrules the normal LJ-parameters (including 1-4 interactions)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NEX: number of exceptions&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NEX</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="SOLVENTATOM"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SOLVENTATOM">[docs]</a><span class="k">class</span> <span class="nc">SOLVENTATOM</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NRAM</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;ANMS&quot;</span><span class="p">,</span> <span class="s2">&quot;IACS&quot;</span><span class="p">,</span> <span class="s2">&quot;MASS&quot;</span><span class="p">,</span> <span class="s2">&quot;CGS&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">solventatom_type</span>

<div class="viewcode-block" id="SOLVENTATOM.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SOLVENTATOM.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">solventatom_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NRAM</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS solventatom block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[solventatom_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NRAM : int, optional</span>
<span class="sd">            Number of solventatom</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NRAM&quot;</span><span class="p">:</span> <span class="n">NRAM</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="SOLVENTATOM.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SOLVENTATOM.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="SOLVENTATOM.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SOLVENTATOM.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NRAM: number of atoms per solvent molecule&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRAM</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="SOLVENTCONSTR"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SOLVENTCONSTR">[docs]</a><span class="k">class</span> <span class="nc">SOLVENTCONSTR</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NCONS</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ICONS&quot;</span><span class="p">,</span> <span class="s2">&quot;JCONS&quot;</span><span class="p">,</span> <span class="s2">&quot;CONS&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">solventconstr_type</span>

<div class="viewcode-block" id="SOLVENTCONSTR.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SOLVENTCONSTR.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">solventconstr_type</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NCONS</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                       GROMOS SOLVENTCONSTR block</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content: Union[Iterable[solventconstr_type], str]</span>
<span class="sd">        FORCEFIELD : FORCEFIELD</span>
<span class="sd">        MAKETOPVERSION : MAKETOPVERSION</span>
<span class="sd">        NCONS : int, optional</span>
<span class="sd">            Number of SOLVENTCONSTR</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NCONS&quot;</span><span class="p">:</span> <span class="n">NCONS</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="SOLVENTCONSTR.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SOLVENTCONSTR.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="SOLVENTCONSTR.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SOLVENTCONSTR.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NCONS: number of constraints&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NCONS</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="CONSTRAINT"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.CONSTRAINT">[docs]</a><span class="k">class</span> <span class="nc">CONSTRAINT</span><span class="p">(</span><span class="n">_topology_table_block</span><span class="p">):</span>
    <span class="n">NCON</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">table_header</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;IC&quot;</span><span class="p">,</span> <span class="s2">&quot;JC&quot;</span><span class="p">,</span> <span class="s2">&quot;ICC&quot;</span><span class="p">]</span>
    <span class="n">table_line_type</span> <span class="o">=</span> <span class="n">constraint_type</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="nb">str</span> <span class="ow">or</span> <span class="nb">dict</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">FORCEFIELD</span><span class="p">:</span> <span class="n">FORCEFIELD</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">MAKETOPVERSION</span><span class="p">:</span> <span class="n">MAKETOPVERSION</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NCON</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NCON&quot;</span><span class="p">:</span> <span class="n">NCON</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">FORCEFIELD</span><span class="o">=</span><span class="n">FORCEFIELD</span><span class="p">,</span> <span class="n">MAKETOPVERSION</span><span class="o">=</span><span class="n">MAKETOPVERSION</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="CONSTRAINT.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.CONSTRAINT.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read_content_from_str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="CONSTRAINT.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.CONSTRAINT.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="s2">&quot;NCON: number of constraints&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NCON</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">block_to_string</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<span class="n">pertubation_lam_state</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;pertubationLamState&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;IAC&quot;</span><span class="p">,</span> <span class="s2">&quot;MASS&quot;</span><span class="p">,</span> <span class="s2">&quot;CHARGE&quot;</span><span class="p">])</span>


<div class="viewcode-block" id="atom_lam_pertubation_state"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.atom_lam_pertubation_state">[docs]</a><span class="k">class</span> <span class="nc">atom_lam_pertubation_state</span><span class="p">(</span><span class="n">_generic_field</span><span class="p">):</span>
    <span class="n">state_format_pattern</span> <span class="o">=</span> <span class="s2">&quot; </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;10.5f}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">NR</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">RES</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">NAME</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">STATES</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">pertubation_lam_state</span><span class="p">],</span>
        <span class="n">ALPHLJ</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">ALPHCRF</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NR</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RES</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">RES</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NAME</span> <span class="o">=</span> <span class="n">NAME</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">STATES</span> <span class="o">=</span> <span class="n">STATES</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ALPHLJ</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ALPHLJ</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ALPHCRF</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ALPHCRF</span><span class="p">)</span>

<div class="viewcode-block" id="atom_lam_pertubation_state.to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.atom_lam_pertubation_state.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">state_format_pattern</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATES</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">IAC</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATES</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">MASS</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATES</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">CHARGE</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">format_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">state_str</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="si">{:10.5f}</span><span class="s2"> </span><span class="si">{:10.5f}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">format_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RES</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NAME</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ALPHLJ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ALPHCRF</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PERTATOMPARAM"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.PERTATOMPARAM">[docs]</a><span class="k">class</span> <span class="nc">PERTATOMPARAM</span><span class="p">(</span><span class="n">_generic_gromos_block</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">STATEATOMS</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">atom_lam_pertubation_state</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">STATEATOMHEADER</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">NJLA</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">STATEIDENTIFIERS</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">dummy_IAC</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
        <span class="n">dummy_CHARGE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">NPTB</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dummy_IAC</span> <span class="o">=</span> <span class="n">dummy_IAC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dummy_CHARGE</span> <span class="o">=</span> <span class="n">dummy_CHARGE</span>

        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">STATEATOMHEADER</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;NR&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;RES&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;NAME&quot;</span><span class="p">,</span>
                <span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;ALPHLJ&quot;</span><span class="p">,</span> <span class="s2">&quot;ALPHCRF&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span> <span class="o">=</span> <span class="n">STATEATOMHEADER</span>

            <span class="k">if</span> <span class="n">STATEATOMS</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMS</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMS</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NJLA</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">add_state_atoms</span><span class="p">(</span><span class="n">STATEATOMS</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>

        <span class="c1"># You can check yourself :)</span>
        <span class="k">if</span> <span class="n">NJLA</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">STATEATOMS</span><span class="p">)</span> <span class="o">==</span> <span class="n">NJLA</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;NJLA must be equal to the length of STATEATOMS! NJLA=&quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">NJLA</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> stateatoms&quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">STATEATOMS</span><span class="p">))</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="p">)</span>

<div class="viewcode-block" id="PERTATOMPARAM.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.PERTATOMPARAM.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="n">field</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">NJLA</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">STATEIDENTIFIERS</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">STATEATOMHEADER</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">STATEATOMS</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">stdid</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;#&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># comment = line</span>
                <span class="k">if</span> <span class="s2">&quot;state_identifiers&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">stdid</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">stdid</span><span class="p">:</span>
                    <span class="n">STATEIDENTIFIERS</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="n">stdid</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">field</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">first</span><span class="p">:</span>
                        <span class="n">STATEATOMHEADER</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="s2">&quot;NR&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;RES&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;NAME&quot;</span><span class="p">,</span>
                        <span class="p">]</span>
                        <span class="p">[</span>
                            <span class="n">STATEATOMHEADER</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;IAC&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;MASS&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;CHARGE&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span>
                            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
                        <span class="p">]</span>
                        <span class="n">STATEATOMHEADER</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;ALPHLJ&quot;</span><span class="p">,</span> <span class="s2">&quot;ALPHCRF&quot;</span><span class="p">]</span>
                        <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>

                    <span class="n">state_line</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">STATEATOMHEADER</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())}</span>
                    <span class="n">final_state_line</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="n">key</span><span class="p">:</span> <span class="n">state_line</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">state_line</span>
                        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;IAC&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key</span> <span class="ow">and</span> <span class="s2">&quot;CHARGE&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key</span> <span class="ow">and</span> <span class="s2">&quot;MASS&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key</span><span class="p">)</span>
                    <span class="p">}</span>
                    <span class="n">states</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="n">x</span><span class="p">:</span> <span class="n">pertubation_lam_state</span><span class="p">(</span>
                            <span class="n">IAC</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">state_line</span><span class="p">[</span><span class="s2">&quot;IAC&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)]))),</span>
                            <span class="n">MASS</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">state_line</span><span class="p">[</span><span class="s2">&quot;MASS&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)]),</span>
                            <span class="n">CHARGE</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">state_line</span><span class="p">[</span><span class="s2">&quot;CHARGE&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)]),</span>
                        <span class="p">)</span>
                        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
                    <span class="p">}</span>

                    <span class="n">final_state_line</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;STATES&quot;</span><span class="p">:</span> <span class="n">states</span><span class="p">})</span>
                    <span class="n">STATEATOMS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_lam_pertubation_state</span><span class="p">(</span><span class="o">**</span><span class="n">final_state_line</span><span class="p">))</span>

                <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">NJLA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="n">field</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">NJLA</span> <span class="o">=</span> <span class="n">NJLA</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">STATEIDENTIFIERS</span> <span class="o">=</span> <span class="n">STATEIDENTIFIERS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span> <span class="o">=</span> <span class="n">STATEATOMHEADER</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMS</span> <span class="o">=</span> <span class="n">STATEATOMS</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nStates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">NPTB</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nTotalStateAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">NJLA</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">states</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">STATEIDENTIFIERS</span><span class="p">[</span><span class="n">state</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span> <span class="p">{</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">NR</span><span class="p">:</span> <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMS</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">NR</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NPTB</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ADD FUNCTIONS</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PERTATOMPARAM.add_state_atoms"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.PERTATOMPARAM.add_state_atoms">[docs]</a>    <span class="k">def</span> <span class="nf">add_state_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_atoms</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">atom_lam_pertubation_state</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function can add states and atoms, but also overwrite state values of existing atoms.</span>
<span class="sd">        If a new state is defined only for a subset of atoms, all other atoms are set to the default dummy.</span>
<span class="sd">        If a new atom misses a state definition, this state will be set to dummy.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        state_atoms: List[atom_eds_pertubation_state]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># some preperations:</span>
        <span class="n">pre_dummy_state</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">atomMass</span><span class="p">:</span> <span class="n">pertubation_lam_state</span><span class="p">(</span>  <span class="c1"># noqa: E731</span>
            <span class="n">IAC</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dummy_IAC</span><span class="p">,</span> <span class="n">MASS</span><span class="o">=</span><span class="n">atomMass</span><span class="p">,</span> <span class="n">CHARGE</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dummy_CHARGE</span>
        <span class="p">)</span>
        <span class="n">insert_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;ALPHLJ&quot;</span><span class="p">)</span>

        <span class="c1"># find all new states</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">natom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">natom</span> <span class="ow">in</span> <span class="n">state_atoms</span><span class="p">],</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">unique_stateIDs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">keys</span><span class="p">))</span>
        <span class="c1"># Todo: not urgent; state number adaptation ( present states 1,2,3,4 new state 8 - id should be 5 not 8)</span>
        <span class="n">unique_states</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;state&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unique_stateIDs</span><span class="p">]))</span>

        <span class="c1"># insert new state IDs</span>
        <span class="n">off</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">unique_state</span> <span class="ow">in</span> <span class="n">unique_stateIDs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">insert_id</span> <span class="o">+</span> <span class="n">off</span><span class="p">,</span> <span class="s2">&quot;IAC&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_state</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">insert_id</span> <span class="o">+</span> <span class="n">off</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;mass&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_state</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">insert_id</span> <span class="o">+</span> <span class="n">off</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;CHARGE&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_state</span><span class="p">))</span>
            <span class="n">off</span> <span class="o">+=</span> <span class="mi">3</span>

        <span class="c1"># add new state names</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;STATEIDENTIFIERS&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">STATEIDENTIFIERS</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">unique_states</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NPTB</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_states</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">STATEIDENTIFIERS</span> <span class="o">=</span> <span class="n">unique_states</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NPTB</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_states</span><span class="p">)</span>
        <span class="c1"># increase the number of new states</span>

        <span class="c1"># 1. Update already present atoms:</span>
        <span class="n">atomIDs</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">NR</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">state_atoms</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMS</span><span class="p">:</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">val</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
            <span class="n">possible_masses</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">MASS</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">MASS</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
            <span class="n">dummy_state</span> <span class="o">=</span> <span class="n">pre_dummy_state</span><span class="p">(</span><span class="n">atomMass</span><span class="o">=</span><span class="n">possible_masses</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">NR</span> <span class="ow">in</span> <span class="n">atomIDs</span><span class="p">:</span>
                <span class="n">new_atom</span> <span class="o">=</span> <span class="n">state_atoms</span><span class="p">[</span><span class="n">atomIDs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">NR</span><span class="p">)]</span>

                <span class="n">atom</span><span class="o">.</span><span class="n">NAME</span> <span class="o">=</span> <span class="n">new_atom</span><span class="o">.</span><span class="n">NAME</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">val</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">new_atom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
                <span class="n">possible_masses</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">MASS</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">new_atom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">MASS</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
                <span class="c1"># add missing dummies</span>
                <span class="c1"># print(unique_stateIDs)</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">dummy_state</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">unique_stateIDs</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="p">})</span>

                <span class="c1"># remove present atom</span>
                <span class="k">del</span> <span class="n">atomIDs</span><span class="p">[</span><span class="n">atomIDs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">NR</span><span class="p">)]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># add missing dummies</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">dummy_state</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">unique_stateIDs</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="p">})</span>

        <span class="c1"># 2. add new atoms</span>
        <span class="n">new_atoms</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">state_atoms</span> <span class="k">if</span> <span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">NR</span> <span class="ow">in</span> <span class="n">atomIDs</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">new_atoms</span><span class="p">:</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">val</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
            <span class="n">possible_masses</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">MASS</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">MASS</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
            <span class="n">dummy_state</span> <span class="o">=</span> <span class="n">pre_dummy_state</span><span class="p">(</span><span class="n">atomMass</span><span class="o">=</span><span class="n">possible_masses</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">dummy_state</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NPTB</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="p">)})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NJLA</span> <span class="o">+=</span> <span class="mi">1</span></div>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DELETING FUNCTIONS</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PERTATOMPARAM.delete_state"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.PERTATOMPARAM.delete_state">[docs]</a>    <span class="k">def</span> <span class="nf">delete_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateIDs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stateNames</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function deletes an state column.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stateIDs: int</span>
<span class="sd">            number of the state</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">stateIDs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stateIDs</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">stateIDs</span> <span class="o">=</span> <span class="p">[</span><span class="n">stateIDs</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">stateIDs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMS</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATEIDENTIFIERS</span><span class="p">[</span><span class="n">state</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;IAC&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s2">&quot;CHARGE&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span>
                <span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">NPTB</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">stateIDs</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">stateNames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stateNames</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">stateNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">stateNames</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">stateN</span> <span class="ow">in</span> <span class="n">stateNames</span><span class="p">:</span>
                <span class="c1"># print(stateN)</span>
                <span class="n">stateID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATEIDENTIFIERS</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">stateN</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMS</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">stateID</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">atom</span><span class="o">.</span><span class="n">STATES</span><span class="p">[</span><span class="n">stateID</span><span class="p">]</span>

                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATEIDENTIFIERS</span><span class="p">[</span><span class="n">stateID</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">x</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span>
                    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;IAC&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stateID</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s2">&quot;CHARGE&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stateID</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NPTB</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">stateNames</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Please give either stateNames or stateIDs&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PERTATOMPARAM.delete_atom"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.PERTATOMPARAM.delete_atom">[docs]</a>    <span class="k">def</span> <span class="nf">delete_atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atomNR</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function removes atom lines from the ptp file.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        atomNR: int</span>
<span class="sd">            atom to be removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atomNR</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">atomNR</span> <span class="o">=</span> <span class="p">[</span><span class="n">atomNR</span><span class="p">]</span>

        <span class="c1"># ind_offset = 0</span>
        <span class="n">new_STATEATOMS</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMS</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">NR</span> <span class="ow">in</span> <span class="n">atomNR</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_STATEATOMS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMS</span> <span class="o">=</span> <span class="n">new_STATEATOMS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NJLA</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">atomNR</span><span class="p">)</span></div>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    STR FUNCTIONS</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_state_STATEATOMHEADER_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state_format_pattern</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2"> </span><span class="si">{:&gt;5}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot; </span><span class="si">{:&gt;5}{:&gt;5}{:&gt;10}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NPTB</span><span class="p">)])</span> <span class="o">+</span> <span class="s2">&quot;    </span><span class="si">{:10}</span><span class="s2"> </span><span class="si">{:10}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">state_format_pattern</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMHEADER</span><span class="p">)</span>

<div class="viewcode-block" id="PERTATOMPARAM.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.PERTATOMPARAM.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;# NJLA &quot;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
            <span class="o">+</span> <span class="s2">&quot;NPTB = &quot;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NPTB</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NJLA</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# state_identifiers&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;# &quot;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATEIDENTIFIERS</span><span class="p">))</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;# &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_STATEATOMHEADER_str</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATEATOMS</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">NR</span><span class="p">)))</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;END&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="SCALEDINTERACTIONS"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SCALEDINTERACTIONS">[docs]</a><span class="k">class</span> <span class="nc">SCALEDINTERACTIONS</span><span class="p">(</span><span class="n">_generic_gromos_block</span><span class="p">):</span>
<div class="viewcode-block" id="SCALEDINTERACTIONS.__init__"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SCALEDINTERACTIONS.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Not exactly sure what these parameters do</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">used</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SCALEDINTERACTIONS&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span></div>

<div class="viewcode-block" id="SCALEDINTERACTIONS.block_to_string"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SCALEDINTERACTIONS.block_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">block_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_seperator</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_seperator</span> <span class="o">+</span> <span class="s2">&quot;END</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="SCALEDINTERACTIONS.read_content_from_str"><a class="viewcode-back" href="../../../../_source/pygromos.files.blocks.html#pygromos.files.blocks.topology_blocks.SCALEDINTERACTIONS.read_content_from_str">[docs]</a>    <span class="k">def</span> <span class="nf">read_content_from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
        <span class="c1"># values</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span></div></div>
</pre></div>

           </div>

          </div>
          <footer>


  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Benjamin Ries, Marc Lehner, Salome Rieder. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.3

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>






</body>
</html>
